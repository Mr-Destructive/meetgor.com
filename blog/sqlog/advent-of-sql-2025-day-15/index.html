<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <title>Advent of SQL 2025 Day 15: Confirmation Phrase Dispatches | Meet Gor</title>
    <meta name="title" content="Advent of SQL 2025 Day 15: Confirmation Phrase Dispatches | Meet Gor">
    <meta name="description" content="">
    <meta name="author" content="Meet Gor">
    <meta name="keywords" content="sqlite, sql, advent-of-sql">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://meetgor.com/sqlog/advent-of-sql-2025-day-15">
    
    
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://meetgor.com/sqlog/advent-of-sql-2025-day-15">
    <meta property="og:title" content="Advent of SQL 2025 Day 15: Confirmation Phrase Dispatches">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://meetgor.com/tbicon.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Advent of SQL 2025 Day 15: Confirmation Phrase Dispatches">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Meet Gor">
    <meta property="article:published_time" content="2025-12-28 20:30 &#43;0530">
    <meta property="article:modified_time" content="2025-12-28 20:30 &#43;0530">
    <meta property="article:author" content="Meet Gor">
    
    <meta property="article:tag" content="sqlite">
    
    <meta property="article:tag" content="sql">
    
    <meta property="article:tag" content="advent-of-sql">
    
    
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@meetgor711">
    <meta name="twitter:creator" content="@meetgor711">
    <meta name="twitter:url" content="https://meetgor.com/sqlog/advent-of-sql-2025-day-15">
    <meta name="twitter:title" content="Advent of SQL 2025 Day 15: Confirmation Phrase Dispatches">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="https://meetgor.com/tbicon.png">
    <meta name="twitter:image:alt" content="Advent of SQL 2025 Day 15: Confirmation Phrase Dispatches">
    
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/meetgor.com/sqlog\/advent-of-sql-2025-day-15"
        },
        "headline": "Advent of SQL 2025 Day 15: Confirmation Phrase Dispatches",
        "description": "",
        "datePublished": "2025-12-28 20:30 \u002b0530",
        "dateModified": "2025-12-28 20:30 \u002b0530",
        "author": {
            "@type": "Person",
            "name": "Meet Gor"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Meet Gor",
            "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/meetgor.com/tbicon.png"
            }
        },
        
        "keywords": "sqlite, sql, advent-of-sql",
        "articleBody": "\u0026lt;h2 id=\u0026#34;advent-of-sql-day-15---confirmation-phrase-dispatches\u0026#34;\u0026gt;Advent of SQL, Day 15 - Confirmation Phrase Dispatches\u0026lt;\/h2\u0026gt;\n\u0026lt;p\u0026gt;We are on the final day of Advent of SQL!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;I can\u0026#39;t believe it, I completed it! (with some help of course, I ~~don\u0026#39;t~~ didn\u0026#39;t know SQL very well. But this 15 days flipped it around.). I feel good and fresh to start the year to go deep in SQLite and databases!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s solve the last day first, if it has somethings reamining to teach us!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We need to make a few changes.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;SQLite doesn\u0026#39;t have \u0026lt;code\u0026gt;-\u0026amp;gt;\u0026amp;gt;\u0026lt;\/code\u0026gt; operator for extracting JSON values from the columns, so we need to use \u0026lt;code\u0026gt;json_extract\u0026lt;\/code\u0026gt; instead.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;So, replace this 9th line from and with:\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;diff\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-diff\u0026#34;\u0026gt;-    marker_letter TEXT GENERATED ALWAYS AS (payload -\u0026gt;\u0026gt; \u0026#39;marker\u0026#39;) STORED,\n\u002b    marker_letter TEXT GENERATED ALWAYS AS (json_extract(payload, \u0026#39;$.marker\u0026#39;)) STORED,\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Once we have it, we also need to remove the marker \u0026lt;code\u0026gt;::jsonb\u0026lt;\/code\u0026gt; from the each insert row, we can do that with \u0026lt;code\u0026gt;sed\u0026lt;\/code\u0026gt; or any other utility you like.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sed \u0026#34;s\/\u0026#39;\\(.*\\)\u0026#39;::jsonb\/\u0026#39;\\1\u0026#39;\/g\u0026#34; day15-inserts.sql \u0026gt; day15-inserts-sqlite.sql\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;DROP TABLE IF EXISTS incoming_dispatches;\nDROP TABLE IF EXISTS system_dispatches;\n\nCREATE TABLE system_dispatches (\n    id SERIAL PRIMARY KEY,\n    system_id TEXT NOT NULL,\n    dispatched_at TIMESTAMP NOT NULL,\n    payload JSONB NOT NULL,\n    marker_letter TEXT GENERATED ALWAYS AS (json_extract(payload, \u0026#39;$.marker\u0026#39;)) STORED,\n    UNIQUE (system_id, dispatched_at, payload)\n);\n\nCREATE TABLE incoming_dispatches (\n    system_id TEXT,\n    dispatched_at TIMESTAMP,\n    payload JSONB\n);\n\nINSERT INTO system_dispatches (system_id, dispatched_at, payload) VALUES\n(\u0026#39;SYS-0081\u0026#39;, \u0026#39;2025-12-21T06:02:26\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0137\u0026#39;, \u0026#39;2025-12-19T06:03:21\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0237\u0026#39;, \u0026#39;2025-12-19T06:23:37\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0006\u0026#39;, \u0026#39;2025-12-24T18:10:16\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0170\u0026#39;, \u0026#39;2025-12-19T06:17:24\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0224\u0026#39;, \u0026#39;2025-12-19T06:23:24\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0007\u0026#39;, \u0026#39;2025-12-24T18:10:06\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0035\u0026#39;, \u0026#39;2025-12-23T15:55:34\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0010\u0026#39;, \u0026#39;2025-12-23T15:55:09\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0037\u0026#39;, \u0026#39;2025-12-23T15:55:36\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0001\u0026#39;, \u0026#39;2025-12-24T08:02:00\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;X\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0225\u0026#39;, \u0026#39;2025-12-19T06:23:25\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0095\u0026#39;, \u0026#39;2025-12-21T06:02:40\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0021\u0026#39;, \u0026#39;2025-12-23T15:55:20\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0001\u0026#39;, \u0026#39;2025-12-24T08:10:00\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0009\u0026#39;, \u0026#39;2025-12-24T08:02:08\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0119\u0026#39;, \u0026#39;2025-12-19T06:03:03\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;E\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0142\u0026#39;, \u0026#39;2025-12-19T06:03:26\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0048\u0026#39;, \u0026#39;2025-12-23T15:55:30\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0228\u0026#39;, \u0026#39;2025-12-19T06:23:28\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;G\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0092\u0026#39;, \u0026#39;2025-12-21T06:02:37\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0008\u0026#39;, \u0026#39;2025-12-24T08:02:07\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;B\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0111\u0026#39;, \u0026#39;2025-12-19T06:02:55\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0106\u0026#39;, \u0026#39;2025-12-19T06:02:50\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0082\u0026#39;, \u0026#39;2025-12-21T06:02:27\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0180\u0026#39;, \u0026#39;2025-12-19T06:17:31\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;N\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0103\u0026#39;, \u0026#39;2025-12-19T06:02:47\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0096\u0026#39;, \u0026#39;2025-12-21T06:02:41\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0003\u0026#39;, \u0026#39;2025-12-23T06:02:02\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Z\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0157\u0026#39;, \u0026#39;2025-12-19T06:17:11\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0010\u0026#39;, \u0026#39;2025-12-23T06:02:09\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0102\u0026#39;, \u0026#39;2025-12-19T06:02:46\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0072\u0026#39;, \u0026#39;2025-12-23T06:02:18\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0175\u0026#39;, \u0026#39;2025-12-19T06:17:29\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0214\u0026#39;, \u0026#39;2025-12-19T06:23:14\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0005\u0026#39;, \u0026#39;2025-12-24T08:02:04\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;P\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0216\u0026#39;, \u0026#39;2025-12-19T06:23:16\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0047\u0026#39;, \u0026#39;2025-12-23T15:55:46\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0019\u0026#39;, \u0026#39;2025-12-23T15:55:18\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0043\u0026#39;, \u0026#39;2025-12-23T15:55:42\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0039\u0026#39;, \u0026#39;2025-12-23T15:55:38\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0212\u0026#39;, \u0026#39;2025-12-19T06:23:12\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0133\u0026#39;, \u0026#39;2025-12-19T06:03:17\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0005\u0026#39;, \u0026#39;2025-12-24T08:10:04\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;N\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0011\u0026#39;, \u0026#39;2025-12-24T08:02:10\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;J\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0080\u0026#39;, \u0026#39;2025-12-21T06:02:25\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;N\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0230\u0026#39;, \u0026#39;2025-12-19T06:23:30\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0100\u0026#39;, \u0026#39;2025-12-21T06:02:45\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;N\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0061\u0026#39;, \u0026#39;2025-12-23T06:02:07\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0022\u0026#39;, \u0026#39;2025-12-23T15:55:21\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0149\u0026#39;, \u0026#39;2025-12-19T06:17:03\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0009\u0026#39;, \u0026#39;2025-12-23T15:55:08\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0002\u0026#39;, \u0026#39;2025-12-24T08:02:01\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Y\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0132\u0026#39;, \u0026#39;2025-12-19T06:03:16\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0033\u0026#39;, \u0026#39;2025-12-23T15:55:32\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0193\u0026#39;, \u0026#39;2025-12-19T06:17:44\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0167\u0026#39;, \u0026#39;2025-12-19T06:17:21\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0008\u0026#39;, \u0026#39;2025-12-24T08:10:07\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0186\u0026#39;, \u0026#39;2025-12-19T06:17:37\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0078\u0026#39;, \u0026#39;2025-12-21T06:02:23\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;V\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0085\u0026#39;, \u0026#39;2025-12-21T06:02:30\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0046\u0026#39;, \u0026#39;2025-12-23T15:55:45\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;G\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0054\u0026#39;, \u0026#39;2025-12-23T15:55:36\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0235\u0026#39;, \u0026#39;2025-12-19T06:23:35\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0089\u0026#39;, \u0026#39;2025-12-21T06:02:34\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0011\u0026#39;, \u0026#39;2025-12-23T06:02:10\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;J\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0034\u0026#39;, \u0026#39;2025-12-23T15:55:33\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0129\u0026#39;, \u0026#39;2025-12-19T06:03:13\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0211\u0026#39;, \u0026#39;2025-12-19T06:23:11\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0151\u0026#39;, \u0026#39;2025-12-19T06:17:05\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0204\u0026#39;, \u0026#39;2025-12-19T06:23:04\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0213\u0026#39;, \u0026#39;2025-12-19T06:23:13\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0147\u0026#39;, \u0026#39;2025-12-19T06:03:31\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0140\u0026#39;, \u0026#39;2025-12-19T06:03:24\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;N\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0123\u0026#39;, \u0026#39;2025-12-19T06:03:07\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0052\u0026#39;, \u0026#39;2025-12-23T15:55:34\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0148\u0026#39;, \u0026#39;2025-12-19T06:17:02\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;G\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0059\u0026#39;, \u0026#39;2025-12-23T06:02:05\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;E\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0027\u0026#39;, \u0026#39;2025-12-23T15:55:26\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0055\u0026#39;, \u0026#39;2025-12-23T15:55:37\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0155\u0026#39;, \u0026#39;2025-12-19T06:17:09\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0107\u0026#39;, \u0026#39;2025-12-19T06:02:51\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0173\u0026#39;, \u0026#39;2025-12-19T06:17:27\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0007\u0026#39;, \u0026#39;2025-12-23T06:02:06\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0016\u0026#39;, \u0026#39;2025-12-23T15:55:15\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0168\u0026#39;, \u0026#39;2025-12-19T06:17:22\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;G\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0196\u0026#39;, \u0026#39;2025-12-19T06:17:47\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0234\u0026#39;, \u0026#39;2025-12-19T06:23:34\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0210\u0026#39;, \u0026#39;2025-12-19T06:23:10\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0135\u0026#39;, \u0026#39;2025-12-19T06:03:19\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0150\u0026#39;, \u0026#39;2025-12-19T06:17:04\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0091\u0026#39;, \u0026#39;2025-12-21T06:02:36\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0154\u0026#39;, \u0026#39;2025-12-19T06:17:08\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0223\u0026#39;, \u0026#39;2025-12-19T06:23:23\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0020\u0026#39;, \u0026#39;2025-12-23T15:55:19\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0160\u0026#39;, \u0026#39;2025-12-19T06:17:14\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;N\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0128\u0026#39;, \u0026#39;2025-12-19T06:03:12\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;G\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0194\u0026#39;, \u0026#39;2025-12-19T06:17:45\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0231\u0026#39;, \u0026#39;2025-12-19T06:23:31\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0045\u0026#39;, \u0026#39;2025-12-23T15:55:44\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0190\u0026#39;, \u0026#39;2025-12-19T06:17:41\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0197\u0026#39;, \u0026#39;2025-12-19T06:17:48\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0002\u0026#39;, \u0026#39;2025-12-23T06:02:01\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Y\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0008\u0026#39;, \u0026#39;2025-12-24T18:10:07\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0158\u0026#39;, \u0026#39;2025-12-19T06:17:12\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;V\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0003\u0026#39;, \u0026#39;2025-12-24T08:10:02\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;V\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0171\u0026#39;, \u0026#39;2025-12-19T06:17:25\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0229\u0026#39;, \u0026#39;2025-12-19T06:23:29\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0079\u0026#39;, \u0026#39;2025-12-21T06:02:24\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;E\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0215\u0026#39;, \u0026#39;2025-12-19T06:23:15\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0233\u0026#39;, \u0026#39;2025-12-19T06:23:33\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0060\u0026#39;, \u0026#39;2025-12-23T06:02:06\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;N\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0026\u0026#39;, \u0026#39;2025-12-23T15:55:25\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0125\u0026#39;, \u0026#39;2025-12-19T06:03:09\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0001\u0026#39;, \u0026#39;2025-12-24T18:10:00\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0136\u0026#39;, \u0026#39;2025-12-19T06:03:20\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0010\u0026#39;, \u0026#39;2025-12-24T08:02:09\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0010\u0026#39;, \u0026#39;2025-12-24T08:10:09\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0044\u0026#39;, \u0026#39;2025-12-23T15:55:43\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0115\u0026#39;, \u0026#39;2025-12-19T06:02:59\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0005\u0026#39;, \u0026#39;2025-12-24T18:10:15\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0094\u0026#39;, \u0026#39;2025-12-21T06:02:39\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0191\u0026#39;, \u0026#39;2025-12-19T06:17:42\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0182\u0026#39;, \u0026#39;2025-12-19T06:17:33\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0195\u0026#39;, \u0026#39;2025-12-19T06:17:46\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0227\u0026#39;, \u0026#39;2025-12-19T06:23:27\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0032\u0026#39;, \u0026#39;2025-12-23T15:55:31\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0177\u0026#39;, \u0026#39;2025-12-19T06:17:31\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0068\u0026#39;, \u0026#39;2025-12-23T06:02:14\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;G\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0069\u0026#39;, \u0026#39;2025-12-23T06:02:15\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0009\u0026#39;, \u0026#39;2025-12-23T06:02:08\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0176\u0026#39;, \u0026#39;2025-12-19T06:17:30\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0008\u0026#39;, \u0026#39;2025-12-23T06:02:07\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;B\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0099\u0026#39;, \u0026#39;2025-12-21T06:02:44\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;E\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0014\u0026#39;, \u0026#39;2025-12-23T15:55:13\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0042\u0026#39;, \u0026#39;2025-12-23T15:55:41\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0006\u0026#39;, \u0026#39;2025-12-24T08:02:05\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;R\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0187\u0026#39;, \u0026#39;2025-12-19T06:17:38\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0174\u0026#39;, \u0026#39;2025-12-19T06:17:28\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0056\u0026#39;, \u0026#39;2025-12-23T15:55:55\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0199\u0026#39;, \u0026#39;2025-12-19T06:17:50\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;E\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0120\u0026#39;, \u0026#39;2025-12-19T06:03:04\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;N\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0003\u0026#39;, \u0026#39;2025-12-24T08:02:02\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Z\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0116\u0026#39;, \u0026#39;2025-12-19T06:02:59\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0008\u0026#39;, \u0026#39;2025-12-24T18:10:18\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0205\u0026#39;, \u0026#39;2025-12-19T06:23:05\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0006\u0026#39;, \u0026#39;2025-12-24T08:10:05\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0145\u0026#39;, \u0026#39;2025-12-19T06:03:29\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0004\u0026#39;, \u0026#39;2025-12-24T08:10:03\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;E\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0065\u0026#39;, \u0026#39;2025-12-23T06:02:11\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0086\u0026#39;, \u0026#39;2025-12-21T06:02:31\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0188\u0026#39;, \u0026#39;2025-12-19T06:17:39\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;G\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0183\u0026#39;, \u0026#39;2025-12-19T06:17:34\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0062\u0026#39;, \u0026#39;2025-12-23T06:02:08\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0058\u0026#39;, \u0026#39;2025-12-23T15:55:57\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;V\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0169\u0026#39;, \u0026#39;2025-12-19T06:17:23\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0105\u0026#39;, \u0026#39;2025-12-19T06:02:49\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0001\u0026#39;, \u0026#39;2025-12-24T18:10:11\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0005\u0026#39;, \u0026#39;2025-12-23T06:02:04\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;P\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0131\u0026#39;, \u0026#39;2025-12-19T06:03:15\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0232\u0026#39;, \u0026#39;2025-12-19T06:23:32\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0028\u0026#39;, \u0026#39;2025-12-23T15:55:27\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0070\u0026#39;, \u0026#39;2025-12-23T06:02:16\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0029\u0026#39;, \u0026#39;2025-12-23T15:55:28\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0127\u0026#39;, \u0026#39;2025-12-19T06:03:11\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0010\u0026#39;, \u0026#39;2025-12-24T18:10:09\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0025\u0026#39;, \u0026#39;2025-12-23T15:55:24\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0164\u0026#39;, \u0026#39;2025-12-19T06:17:18\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0114\u0026#39;, \u0026#39;2025-12-19T06:02:58\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0009\u0026#39;, \u0026#39;2025-12-24T18:10:08\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0184\u0026#39;, \u0026#39;2025-12-19T06:17:35\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0003\u0026#39;, \u0026#39;2025-12-24T18:10:02\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;V\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0053\u0026#39;, \u0026#39;2025-12-23T15:55:35\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0117\u0026#39;, \u0026#39;2025-12-19T06:03:01\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0074\u0026#39;, \u0026#39;2025-12-23T06:02:20\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0198\u0026#39;, \u0026#39;2025-12-19T06:17:49\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;V\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0036\u0026#39;, \u0026#39;2025-12-23T15:55:35\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0112\u0026#39;, \u0026#39;2025-12-19T06:02:56\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0023\u0026#39;, \u0026#39;2025-12-23T15:55:22\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0121\u0026#39;, \u0026#39;2025-12-19T06:03:05\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0181\u0026#39;, \u0026#39;2025-12-19T06:17:32\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0003\u0026#39;, \u0026#39;2025-12-24T18:10:13\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0130\u0026#39;, \u0026#39;2025-12-19T06:03:14\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0066\u0026#39;, \u0026#39;2025-12-23T06:02:12\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0203\u0026#39;, \u0026#39;2025-12-19T06:17:54\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0002\u0026#39;, \u0026#39;2025-12-24T18:10:01\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0104\u0026#39;, \u0026#39;2025-12-19T06:02:48\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0017\u0026#39;, \u0026#39;2025-12-23T15:55:16\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0004\u0026#39;, \u0026#39;2025-12-24T18:10:03\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;E\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0238\u0026#39;, \u0026#39;2025-12-19T06:23:38\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0110\u0026#39;, \u0026#39;2025-12-19T06:02:54\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0071\u0026#39;, \u0026#39;2025-12-23T06:02:17\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0004\u0026#39;, \u0026#39;2025-12-24T18:10:14\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0031\u0026#39;, \u0026#39;2025-12-23T15:55:30\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0004\u0026#39;, \u0026#39;2025-12-23T06:02:03\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;M\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0141\u0026#39;, \u0026#39;2025-12-19T06:03:25\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0207\u0026#39;, \u0026#39;2025-12-19T06:23:07\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0122\u0026#39;, \u0026#39;2025-12-19T06:03:06\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0006\u0026#39;, \u0026#39;2025-12-24T18:10:05\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0030\u0026#39;, \u0026#39;2025-12-23T15:55:29\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;G\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0192\u0026#39;, \u0026#39;2025-12-19T06:17:43\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0144\u0026#39;, \u0026#39;2025-12-19T06:03:28\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0098\u0026#39;, \u0026#39;2025-12-21T06:02:43\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;V\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0200\u0026#39;, \u0026#39;2025-12-19T06:17:51\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;N\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0007\u0026#39;, \u0026#39;2025-12-24T08:02:06\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0220\u0026#39;, \u0026#39;2025-12-19T06:23:20\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;N\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0063\u0026#39;, \u0026#39;2025-12-23T06:02:09\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0109\u0026#39;, \u0026#39;2025-12-19T06:02:53\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0179\u0026#39;, \u0026#39;2025-12-19T06:17:30\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;E\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0163\u0026#39;, \u0026#39;2025-12-19T06:17:17\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0162\u0026#39;, \u0026#39;2025-12-19T06:17:16\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0222\u0026#39;, \u0026#39;2025-12-19T06:23:22\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0134\u0026#39;, \u0026#39;2025-12-19T06:03:18\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0004\u0026#39;, \u0026#39;2025-12-24T08:02:03\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;M\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0139\u0026#39;, \u0026#39;2025-12-19T06:03:23\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;E\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0097\u0026#39;, \u0026#39;2025-12-21T06:02:42\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0146\u0026#39;, \u0026#39;2025-12-19T06:03:30\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0101\u0026#39;, \u0026#39;2025-12-19T06:02:45\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0201\u0026#39;, \u0026#39;2025-12-19T06:17:52\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0051\u0026#39;, \u0026#39;2025-12-23T15:55:33\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0172\u0026#39;, \u0026#39;2025-12-19T06:17:26\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0083\u0026#39;, \u0026#39;2025-12-21T06:02:28\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0009\u0026#39;, \u0026#39;2025-12-24T08:10:08\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0124\u0026#39;, \u0026#39;2025-12-19T06:03:08\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0041\u0026#39;, \u0026#39;2025-12-23T15:55:40\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0049\u0026#39;, \u0026#39;2025-12-23T15:55:31\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0202\u0026#39;, \u0026#39;2025-12-19T06:17:53\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0178\u0026#39;, \u0026#39;2025-12-19T06:17:29\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;V\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0090\u0026#39;, \u0026#39;2025-12-21T06:02:35\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0006\u0026#39;, \u0026#39;2025-12-23T06:02:05\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;R\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0073\u0026#39;, \u0026#39;2025-12-23T06:02:19\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0076\u0026#39;, \u0026#39;2025-12-23T06:02:22\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0217\u0026#39;, \u0026#39;2025-12-19T06:23:17\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0159\u0026#39;, \u0026#39;2025-12-19T06:17:13\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;E\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0161\u0026#39;, \u0026#39;2025-12-19T06:17:15\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0221\u0026#39;, \u0026#39;2025-12-19T06:23:21\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0236\u0026#39;, \u0026#39;2025-12-19T06:23:36\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0064\u0026#39;, \u0026#39;2025-12-23T06:02:10\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0126\u0026#39;, \u0026#39;2025-12-19T06:03:10\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0024\u0026#39;, \u0026#39;2025-12-23T15:55:23\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0113\u0026#39;, \u0026#39;2025-12-19T06:02:57\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0038\u0026#39;, \u0026#39;2025-12-23T15:55:37\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0075\u0026#39;, \u0026#39;2025-12-23T06:02:21\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0088\u0026#39;, \u0026#39;2025-12-21T06:02:33\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;G\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0007\u0026#39;, \u0026#39;2025-12-24T08:10:06\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0067\u0026#39;, \u0026#39;2025-12-23T06:02:13\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0156\u0026#39;, \u0026#39;2025-12-19T06:17:10\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0040\u0026#39;, \u0026#39;2025-12-23T15:55:39\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0219\u0026#39;, \u0026#39;2025-12-19T06:23:19\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;E\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0166\u0026#39;, \u0026#39;2025-12-19T06:17:20\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0007\u0026#39;, \u0026#39;2025-12-24T18:10:17\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0153\u0026#39;, \u0026#39;2025-12-19T06:17:07\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0077\u0026#39;, \u0026#39;2025-12-23T06:02:23\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0084\u0026#39;, \u0026#39;2025-12-21T06:02:29\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;);\n\nINSERT INTO incoming_dispatches (system_id, dispatched_at, payload) VALUES\n(\u0026#39;SYS-0013\u0026#39;, \u0026#39;2025-12-23T15:55:12\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0002\u0026#39;, \u0026#39;2025-12-24T08:10:01\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0012\u0026#39;, \u0026#39;2025-12-23T15:55:11\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0108\u0026#39;, \u0026#39;2025-12-19T06:02:52\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;G\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0165\u0026#39;, \u0026#39;2025-12-19T06:17:19\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0189\u0026#39;, \u0026#39;2025-12-19T06:17:40\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0050\u0026#39;, \u0026#39;2025-12-23T15:55:32\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0138\u0026#39;, \u0026#39;2025-12-19T06:03:22\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;V\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0087\u0026#39;, \u0026#39;2025-12-21T06:02:32\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0208\u0026#39;, \u0026#39;2025-12-19T06:23:08\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;G\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0057\u0026#39;, \u0026#39;2025-12-23T15:55:56\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0002\u0026#39;, \u0026#39;2025-12-24T18:10:12\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;G\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0011\u0026#39;, \u0026#39;2025-12-24T08:10:10\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0226\u0026#39;, \u0026#39;2025-12-19T06:23:26\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0206\u0026#39;, \u0026#39;2025-12-19T06:23:06\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0118\u0026#39;, \u0026#39;2025-12-19T06:03:02\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;V\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0185\u0026#39;, \u0026#39;2025-12-19T06:17:36\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0218\u0026#39;, \u0026#39;2025-12-19T06:23:18\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;V\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0018\u0026#39;, \u0026#39;2025-12-23T15:55:17\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;G\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0005\u0026#39;, \u0026#39;2025-12-24T18:10:04\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;N\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0093\u0026#39;, \u0026#39;2025-12-21T06:02:38\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0011\u0026#39;, \u0026#39;2025-12-24T18:10:10\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0011\u0026#39;, \u0026#39;2025-12-23T15:55:10\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0143\u0026#39;, \u0026#39;2025-12-19T06:03:27\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0152\u0026#39;, \u0026#39;2025-12-19T06:17:06\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0015\u0026#39;, \u0026#39;2025-12-23T15:55:14\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0001\u0026#39;, \u0026#39;2025-12-23T06:02:00\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;X\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0209\u0026#39;, \u0026#39;2025-12-19T06:23:09\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0133\u0026#39;, \u0026#39;2025-12-19T06:03:17\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0158\u0026#39;, \u0026#39;2025-12-19T06:17:12\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;V\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0195\u0026#39;, \u0026#39;2025-12-19T06:17:46\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0182\u0026#39;, \u0026#39;2025-12-19T06:17:33\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0033\u0026#39;, \u0026#39;2025-12-23T15:55:32\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;W\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0083\u0026#39;, \u0026#39;2025-12-21T06:02:28\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0002\u0026#39;, \u0026#39;2025-12-23T06:02:01\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;Y\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0076\u0026#39;, \u0026#39;2025-12-23T06:02:22\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0009\u0026#39;, \u0026#39;2025-12-24T08:02:08\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}\u0026#39;),\n(\u0026#39;SYS-0194\u0026#39;, \u0026#39;2025-12-19T06:17:45\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;U\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;);\n\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;$ sqlite3\nSQLite version 3.50.4 2025-07-30 19:33:53\nEnter \u0026#34;.help\u0026#34; for usage hints.\nConnected to a transient in-memory database.\nUse \u0026#34;.open FILENAME\u0026#34; to reopen on a persistent database.\nsqlite\u0026gt; .read day15-inserts.sql\nParse error near line 19: unrecognized token: \u0026#34;:\u0026#34;\n  6:02:26\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;::jsonb), (\u0026#39;SYS-0137\u0026#39;, \u0026#39;2025\n                                      error here ---^\nParse error near line 275: unrecognized token: \u0026#34;:\u0026#34;\n  5:55:12\u0026#39;, \u0026#39;{\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;}\u0026#39;::jsonb), (\u0026#39;SYS-0002\u0026#39;, \u0026#39;2025\n                                      error here ---^\nsqlite\u0026gt; .read day15-inserts-sqlite.sql\nsqlite\u0026gt; .schema\nCREATE TABLE system_dispatches (\n    id SERIAL PRIMARY KEY,\n    system_id TEXT NOT NULL,\n    dispatched_at TIMESTAMP NOT NULL,\n    payload JSONB NOT NULL,\n    marker_letter TEXT GENERATED ALWAYS AS (json_extract(payload, \u0026#39;$.marker\u0026#39;)) STORED,\n    UNIQUE (system_id, dispatched_at, payload)\n);\nCREATE TABLE incoming_dispatches (\n    system_id TEXT,\n    dispatched_at TIMESTAMP,\n    payload JSONB\n);\nsqlite\u0026gt; .mode table\nsqlite\u0026gt; SELECT * FROM system_dispatches LIMIT 10;\n\u002b----\u002b-----------\u002b---------------------\u002b----------------------------------------\u002b---------------\u002b\n| id | system_id |    dispatched_at    |                payload                 | marker_letter |\n\u002b----\u002b-----------\u002b---------------------\u002b----------------------------------------\u002b---------------\u002b\n|    | SYS-0081  | 2025-12-21T06:02:26 | {\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | T             |\n|    | SYS-0137  | 2025-12-19T06:03:21 | {\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | D             |\n|    | SYS-0237  | 2025-12-19T06:23:37 | {\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | D             |\n|    | SYS-0006  | 2025-12-24T18:10:16 | {\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | K             |\n|    | SYS-0170  | 2025-12-19T06:17:24 | {\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | I             |\n|    | SYS-0224  | 2025-12-19T06:23:24 | {\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | S             |\n|    | SYS-0007  | 2025-12-24T18:10:06 | {\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | O             |\n|    | SYS-0035  | 2025-12-23T15:55:34 | {\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | C             |\n|    | SYS-0010  | 2025-12-23T15:55:09 | {\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | L             |\n|    | SYS-0037  | 2025-12-23T15:55:36 | {\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | D             |\n\u002b----\u002b-----------\u002b---------------------\u002b----------------------------------------\u002b---------------\u002b\nsqlite\u0026gt; SELECT * FROM incoming_dispatches LIMIT 10;\n\u002b-----------\u002b---------------------\u002b----------------------------------------\u002b\n| system_id |    dispatched_at    |                payload                 |\n\u002b-----------\u002b---------------------\u002b----------------------------------------\u002b\n| SYS-0013  | 2025-12-23T15:55:12 | {\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} |\n| SYS-0002  | 2025-12-24T08:10:01 | {\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;}   |\n| SYS-0012  | 2025-12-23T15:55:11 | {\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} |\n| SYS-0108  | 2025-12-19T06:02:52 | {\u0026#34;marker\u0026#34;: \u0026#34;G\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} |\n| SYS-0165  | 2025-12-19T06:17:19 | {\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} |\n| SYS-0189  | 2025-12-19T06:17:40 | {\u0026#34;marker\u0026#34;: \u0026#34;H\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} |\n| SYS-0050  | 2025-12-23T15:55:32 | {\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} |\n| SYS-0138  | 2025-12-19T06:03:22 | {\u0026#34;marker\u0026#34;: \u0026#34;V\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} |\n| SYS-0087  | 2025-12-21T06:02:32 | {\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} |\n| SYS-0208  | 2025-12-19T06:23:08 | {\u0026#34;marker\u0026#34;: \u0026#34;G\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} |\n\u002b-----------\u002b---------------------\u002b----------------------------------------\u002b\nsqlite\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Good to go!\u0026lt;\/p\u0026gt;\n\u0026lt;h2 id=\u0026#34;problem\u0026#34;\u0026gt;Problem\u0026lt;\/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Reconstruct the final confirmation phrase to text Santa based on the elves hazy recollection of how they solved this problem before.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Your final result should include the marker_letter for each system, using only the most recent dispatch from a primary source. Once the correct dispatch has been identified for every system, combine the results and order them by dispatched_at in ascending order to reveal the confirmation phrase.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;The sleigh wont launch without it.\u0026lt;\/p\u0026gt;\n\u0026lt;\/blockquote\u0026gt;\n\u0026lt;p\u0026gt;So, we need to first make sure we have the right \u0026lt;code\u0026gt;dispatches\u0026lt;\/code\u0026gt;.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We have two tables.\u0026lt;\/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;system_dispatches\u0026lt;\/code\u0026gt;\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;incoming_dispatches\u0026lt;\/code\u0026gt;\u0026lt;\/li\u0026gt;\n\u0026lt;\/ol\u0026gt;\n\u0026lt;p\u0026gt;The problem statement also states:\u0026lt;\/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;The system kept throwing errors until we figured out how to handle duplicates. Whatever you do the records already in system_dispatches must take precedence.\u0026lt;\/p\u0026gt;\n\u0026lt;\/blockquote\u0026gt;\n\u0026lt;p\u0026gt;So, we need to take the \u0026lt;code\u0026gt;system_dispatches\u0026lt;\/code\u0026gt; as the ground truth. However we need to include something or the other from the \u0026lt;code\u0026gt;incoming_dispatches\u0026lt;\/code\u0026gt; as there are new entries being created.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;So, we will first try to insert into the system dispatches everything in the \u0026lt;code\u0026gt;incoming_dispatches\u0026lt;\/code\u0026gt;\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;INSERT INTO system_dispatches (system_id, dispatched_at, payload)\nSELECT system_id, dispatched_at, payload\nFROM incoming_dispatches;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; INSERT INTO system_dispatches (system_id, dispatched_at, payload)\nSELECT system_id, dispatched_at, payload\nFROM incoming_dispatches;\nRuntime error: UNIQUE constraint failed: system_dispatches.system_id, system_dispatches.dispatched_at, system_dispatches.payload (19)\nsqlite\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Ops!\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT COUNT(*) as system_dispatches_count FROM system_dispatches ;\nSELECT COUNT(*) as incoming_dispatches_count FROM incoming_dispatches;\nSELECT COUNT(*) as common_dispatches_count FROM (SELECT system_id, dispatched_at, payload FROM system_dispatches INTERSECT SELECT * FROM incoming_dispatches);\n\n\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; SELECT COUNT(*) FROM system_dispatches ;\n\u002b----------\u002b\n| COUNT(*) |\n\u002b----------\u002b\n| 254      |\n\u002b----------\u002b\nsqlite\u0026gt; SELECT COUNT(*) FROM incoming_dispatches;\n\u002b----------\u002b\n| COUNT(*) |\n\u002b----------\u002b\n| 38       |\n\u002b----------\u002b\n\nsqlite\u0026gt; SELECT COUNT(*) FROM (SELECT system_id, dispatched_at, payload FROM system_dispatches UNION SELECT * FROM incoming_dispatches);\n\u002b----------\u002b\n| COUNT(*) |\n\u002b----------\u002b\n| 282      |\n\u002b----------\u002b\n\nsqlite\u0026gt; SELECT DISTINCT COUNT(*) FROM (SELECT system_id, dispatched_at, payload FROM system_dispatches UNION SELECT * FROM incoming_dispatches);\n\u002b----------\u002b\n| COUNT(*) |\n\u002b----------\u002b\n| 282      |\n\u002b----------\u002b\n\nsqlite\u0026gt; SELECT COUNT(*) FROM (SELECT system_id, dispatched_at, payload FROM system_dispatches INTERSECT SELECT * FROM incoming_dispatches);\n\u002b----------\u002b\n| COUNT(*) |\n\u002b----------\u002b\n| 10       |\n\u002b----------\u002b\nsqlite\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;We need to be careful about what we insert into the \u0026lt;code\u0026gt;system_dispatches\u0026lt;\/code\u0026gt;.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;I think the duplicates causes this conflict in constraints, we can ignore on the constraint failures and don\u0026#39;t insert that row.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;INSERT OR IGNORE INTO system_dispatches (system_id, dispatched_at, payload)\nSELECT system_id, dispatched_at, payload\nFROM incoming_dispatches;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Ok, now if we see the count, we get \u0026lt;code\u0026gt;282\u0026lt;\/code\u0026gt; which is making sense.\u0026lt;\/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;The original \u0026lt;code\u0026gt;system_dispatches\u0026lt;\/code\u0026gt; had a count of \u0026lt;code\u0026gt;254\u0026lt;\/code\u0026gt; before merge.\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;The original \u0026lt;code\u0026gt;incoming_dispatches\u0026lt;\/code\u0026gt; had a count of \u0026lt;code\u0026gt;38\u0026lt;\/code\u0026gt;.\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;After merging \u0026lt;code\u0026gt;incoming_dispatches\u0026lt;\/code\u0026gt; into \u0026lt;code\u0026gt;system_dispatches\u0026lt;\/code\u0026gt; table, we have a \u0026lt;code\u0026gt;282\u0026lt;\/code\u0026gt; records in \u0026lt;code\u0026gt;system_dispatches\u0026lt;\/code\u0026gt; but \u0026lt;code\u0026gt;254\u002b38=292\u0026lt;\/code\u0026gt;, what about the \u0026lt;code\u0026gt;10\u0026lt;\/code\u0026gt;? Those were already there in the \u0026lt;code\u0026gt;system_dispatches\u0026lt;\/code\u0026gt;. As we saw in the earlier query, there were \u0026lt;code\u0026gt;10\u0026lt;\/code\u0026gt; rows in common from the \u0026lt;code\u0026gt;incoming_dispatches\u0026lt;\/code\u0026gt; table before merge.\u0026lt;\/li\u0026gt;\n\u0026lt;\/ul\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; SELECT COUNT(*) FROM system_dispatches ;\n\u002b----------\u002b\n| COUNT(*) |\n\u002b----------\u002b\n| 254      |\n\u002b----------\u002b\nsqlite\u0026gt; SELECT COUNT(*) FROM incoming_dispatches;\n\u002b----------\u002b\n| COUNT(*) |\n\u002b----------\u002b\n| 38       |\n\u002b----------\u002b\nsqlite\u0026gt; INSERT INTO system_dispatches (system_id, dispatched_at, payload)\nSELECT system_id, dispatched_at, payload\nFROM incoming_dispatches;\nRuntime error: UNIQUE constraint failed: system_dispatches.system_id, system_dispatches.dispatched_at, system_dispatches.payload (19)\nsqlite\u0026gt; INSERT OR IGNORE INTO system_dispatches (system_id, dispatched_at, payload)\nSELECT system_id, dispatched_at, payload\nFROM incoming_dispatches;\nsqlite\u0026gt; SELECT COUNT(*) FROM system_dispatches ;\n\u002b----------\u002b\n| COUNT(*) |\n\u002b----------\u002b\n| 282      |\n\u002b----------\u002b\nsqlite\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Now, to the actual problem.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;What we need to do now?\u0026lt;\/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Using only the most recent dispatch from a primary source.\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;Once the correct dispatch has been identified for every system, combine the results and order them by dispatched_at in ascending order\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;Reveal the confirmation phrase\u0026lt;\/li\u0026gt;\n\u0026lt;\/ul\u0026gt;\n\u0026lt;p\u0026gt;We have the single source now!\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT * FROM system_dispatches LIMIT 10;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;SELECT * FROM system_dispatches LIMIT 10;\n\u002b----\u002b-----------\u002b---------------------\u002b----------------------------------------\u002b---------------\u002b\n| id | system_id |    dispatched_at    |                payload                 | marker_letter |\n\u002b----\u002b-----------\u002b---------------------\u002b----------------------------------------\u002b---------------\u002b\n|    | SYS-0081  | 2025-12-21T06:02:26 | {\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | T             |\n|    | SYS-0137  | 2025-12-19T06:03:21 | {\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | D             |\n|    | SYS-0237  | 2025-12-19T06:23:37 | {\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | D             |\n|    | SYS-0006  | 2025-12-24T18:10:16 | {\u0026#34;marker\u0026#34;: \u0026#34;K\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | K             |\n|    | SYS-0170  | 2025-12-19T06:17:24 | {\u0026#34;marker\u0026#34;: \u0026#34;I\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | I             |\n|    | SYS-0224  | 2025-12-19T06:23:24 | {\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | S             |\n|    | SYS-0007  | 2025-12-24T18:10:06 | {\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | O             |\n|    | SYS-0035  | 2025-12-23T15:55:34 | {\u0026#34;marker\u0026#34;: \u0026#34;C\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | C             |\n|    | SYS-0010  | 2025-12-23T15:55:09 | {\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | L             |\n|    | SYS-0037  | 2025-12-23T15:55:36 | {\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;secondary\u0026#34;} | D             |\n\u002b----\u002b-----------\u002b---------------------\u002b----------------------------------------\u002b---------------\u002b\nsqlite\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;We have 4 columns.\u0026lt;\/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;system_id\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;dispatched_at\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;payload (json string)\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;marker (its a generated table from the payload[\u0026amp;quot;marker\u0026amp;quot;] string)\u0026lt;\/li\u0026gt;\n\u0026lt;\/ul\u0026gt;\n\u0026lt;p\u0026gt;So, we need to group by system, that\u0026#39;s where the \u0026lt;code\u0026gt;system_id\u0026lt;\/code\u0026gt; is for.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Then we need to order by \u0026lt;code\u0026gt;dispatched_at\u0026lt;\/code\u0026gt; with the latest ones.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Finally we also need to filter the records that has \u0026lt;code\u0026gt;payload[\u0026amp;quot;source\u0026amp;quot;]\u0026lt;\/code\u0026gt; as \u0026lt;code\u0026gt;primary\u0026lt;\/code\u0026gt;.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;But wait, if we group by \u0026lt;code\u0026gt;system_id\u0026lt;\/code\u0026gt; then how can we get the latest dispatched ordered correctly? We can\u0026#39;t use it in the \u0026lt;code\u0026gt;ORDER BY\u0026lt;\/code\u0026gt; as the group would have already been created right?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Oh! We might need window functions, but just a moment, can we do it without them?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s try.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT \n    system_id,\n    MAX(dispatched_at),\n    payload, \n    marker_letter\nFROM system_dispatches\nWHERE json_extract(payload, \u0026#39;$.source\u0026#39;) = \u0026#39;primary\u0026#39;\nGROUP BY system_id\nORDER BY dispatched_at ASC;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Oh boy, that was simple!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We just grouped by \u0026lt;code\u0026gt;system_id\u0026lt;\/code\u0026gt;, filtered the source as \u0026lt;code\u0026gt;primary\u0026lt;\/code\u0026gt; and selected the row with \u0026lt;code\u0026gt;MAX(dispatched_at)\u0026lt;\/code\u0026gt; which will give us the latest dispatch record for a system. Boom!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;The confirmation phrase is \u0026lt;code\u0026gt;ADVENTOFSQL\u0026lt;\/code\u0026gt;\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We can just select the \u0026lt;code\u0026gt;marker_letter\u0026lt;\/code\u0026gt;\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT\n    marker_letter\nFROM system_dispatches\nWHERE json_extract(payload, \u0026#39;$.source\u0026#39;) = \u0026#39;primary\u0026#39;\nGROUP BY system_id\nORDER BY dispatched_at ASC;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; SELECT\n    marker_letter\nFROM system_dispatches\nWHERE json_extract(payload, \u0026#39;$.source\u0026#39;) = \u0026#39;primary\u0026#39;\nGROUP BY system_id\nORDER BY dispatched_at ASC;\n\u002b---------------\u002b\n| marker_letter |\n\u002b---------------\u002b\n| X             |\n| Y             |\n| Z             |\n| M             |\n| P             |\n| R             |\n| K             |\n| B             |\n| U             |\n| C             |\n| J             |\n\u002b---------------\u002b\nsqlite\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Whops! What happened, the marker letter changed?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Yep, because we have ordered by \u0026lt;code\u0026gt;dispatched_at DESC\u0026lt;\/code\u0026gt; but never told how to return the rows, by using \u0026lt;code\u0026gt;MAX(dispatched_at)\u0026lt;\/code\u0026gt; we were selecting the latest date record. Without it, we are selecting the first record in the group that could be the first or the oldest dispatched_at time.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;So, we need \u0026lt;code\u0026gt;MAX(dispatched_at)\u0026lt;\/code\u0026gt; included in the selected result set.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT\n    marker_letter, MAX(dispatched_at)\nFROM system_dispatches\nWHERE json_extract(payload, \u0026#39;$.source\u0026#39;) = \u0026#39;primary\u0026#39;\nGROUP BY system_id\nORDER BY dispatched_at ASC;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt; SELECT\n    marker_letter, MAX(dispatched_at)\nFROM system_dispatches\nWHERE json_extract(payload, \u0026#39;$.source\u0026#39;) = \u0026#39;primary\u0026#39;\nGROUP BY system_id\nORDER BY dispatched_at ASC;\n\u002b---------------\u002b---------------------\u002b\n| marker_letter | MAX(dispatched_at)  |\n\u002b---------------\u002b---------------------\u002b\n| A             | 2025-12-24T08:10:00 |\n| D             | 2025-12-24T08:10:01 |\n| V             | 2025-12-24T08:10:02 |\n| E             | 2025-12-24T08:10:03 |\n| N             | 2025-12-24T08:10:04 |\n| T             | 2025-12-24T08:10:05 |\n| O             | 2025-12-24T08:10:06 |\n| F             | 2025-12-24T08:10:07 |\n| S             | 2025-12-24T08:10:08 |\n| Q             | 2025-12-24T08:10:09 |\n| L             | 2025-12-24T08:10:10 |\n\u002b---------------\u002b---------------------\u002b\nsqlite\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;There, we go! It scared me for a moment.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We order by, only keep the \u0026lt;code\u0026gt;source\u0026lt;\/code\u0026gt; as \u0026lt;code\u0026gt;primary\u0026lt;\/code\u0026gt; and then select the latest \u0026lt;code\u0026gt;dispatched_at\u0026lt;\/code\u0026gt; for a given system_id.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;If you don\u0026#39;t want to do this way! I found a few more hacks\u0026lt;\/p\u0026gt;\n\u0026lt;h3 id=\u0026#34;with-subquery\u0026#34;\u0026gt;With Subquery\u0026lt;\/h3\u0026gt;\n\u0026lt;p\u0026gt;We can SELECT the \u0026lt;code\u0026gt;MAX(dispatched_at)\u0026lt;\/code\u0026gt; in a subquery for that system_id and filter based on the \u0026lt;code\u0026gt;primary\u0026lt;\/code\u0026gt; source as usual.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT \n    *\nFROM system_dispatches\nWHERE \n    json_extract(system_dispatches.payload, \u0026#39;$.source\u0026#39;) = \u0026#39;primary\u0026#39;\n    AND system_dispatches.dispatched_at = (\n        SELECT \n            MAX(latest_dispatches.dispatched_at)\n        FROM system_dispatches latest_dispatches\n        WHERE \n            latest_dispatches.system_id = system_dispatches.system_id\n            AND json_extract(latest_dispatches.payload, \u0026#39;$.source\u0026#39;) = \u0026#39;primary\u0026#39;\n   )\nORDER BY system_dispatches.dispatched_at ASC;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; SELECT \n    *\nFROM system_dispatches\nWHERE \n    json_extract(system_dispatches.payload, \u0026#39;$.source\u0026#39;) = \u0026#39;primary\u0026#39;\n    AND system_dispatches.dispatched_at = (\n        SELECT \n            MAX(latest_dispatches.dispatched_at)\n        FROM system_dispatches latest_dispatches\n        WHERE \n            latest_dispatches.system_id = system_dispatches.system_id\n            AND json_extract(latest_dispatches.payload, \u0026#39;$.source\u0026#39;) = \u0026#39;primary\u0026#39;\n   )\nORDER BY system_dispatches.dispatched_at ASC;\n\n\u002b----\u002b-----------\u002b---------------------\u002b--------------------------------------\u002b---------------\u002b\n| id | system_id |    dispatched_at    |               payload                | marker_letter |\n\u002b----\u002b-----------\u002b---------------------\u002b--------------------------------------\u002b---------------\u002b\n|    | SYS-0001  | 2025-12-24T08:10:00 | {\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | A             |\n|    | SYS-0002  | 2025-12-24T08:10:01 | {\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | D             |\n|    | SYS-0003  | 2025-12-24T08:10:02 | {\u0026#34;marker\u0026#34;: \u0026#34;V\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | V             |\n|    | SYS-0004  | 2025-12-24T08:10:03 | {\u0026#34;marker\u0026#34;: \u0026#34;E\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | E             |\n|    | SYS-0005  | 2025-12-24T08:10:04 | {\u0026#34;marker\u0026#34;: \u0026#34;N\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | N             |\n|    | SYS-0006  | 2025-12-24T08:10:05 | {\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | T             |\n|    | SYS-0007  | 2025-12-24T08:10:06 | {\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | O             |\n|    | SYS-0008  | 2025-12-24T08:10:07 | {\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | F             |\n|    | SYS-0009  | 2025-12-24T08:10:08 | {\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | S             |\n|    | SYS-0010  | 2025-12-24T08:10:09 | {\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | Q             |\n|    | SYS-0011  | 2025-12-24T08:10:10 | {\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | L             |\n\u002b----\u002b-----------\u002b---------------------\u002b--------------------------------------\u002b---------------\u002b\nsqlite\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;h3 id=\u0026#34;window-funciton\u0026#34;\u0026gt;Window Funciton\u0026lt;\/h3\u0026gt;\n\u0026lt;p\u0026gt;We can even use the window function to partition by the \u0026lt;code\u0026gt;system_id\u0026lt;\/code\u0026gt; and there itself order by the \u0026lt;code\u0026gt;dispatched_at\u0026lt;\/code\u0026gt; latest time. And then select it as a CTE table.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We can use a \u0026lt;code\u0026gt;ROW_NUMBER\u0026lt;\/code\u0026gt; function to assign a rank to each row per system_id and ordered by the latest \u0026lt;code\u0026gt;dispatched_at\u0026lt;\/code\u0026gt;\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;WITH latest_dispatches AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY system_id\n            ORDER BY dispatched_at DESC\n        ) as rank\n    FROM system_dispatches\n    WHERE json_extract(payload, \u0026#39;$.source\u0026#39;) = \u0026#39;primary\u0026#39;\n) SELECT * FROM latest_dispatches WHERE rank = 1 ORDER BY dispatched_at ASC;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;The rest is the same as the above query. We order by dispatched latest but then order by ascending (oldest first) in the final result set.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; WITH latest_dispatches AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY system_id\n            ORDER BY dispatched_at DESC\n        ) as rank\n    FROM system_dispatches\n    WHERE json_extract(payload, \u0026#39;$.source\u0026#39;) = \u0026#39;primary\u0026#39;\n) SELECT * FROM latest_dispatches WHERE rank = 1 ORDER BY dispatched_at ASC;\n\u002b----\u002b-----------\u002b---------------------\u002b--------------------------------------\u002b---------------\u002b------\u002b\n| id | system_id |    dispatched_at    |               payload                | marker_letter | rank |\n\u002b----\u002b-----------\u002b---------------------\u002b--------------------------------------\u002b---------------\u002b------\u002b\n|    | SYS-0001  | 2025-12-24T08:10:00 | {\u0026#34;marker\u0026#34;: \u0026#34;A\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | A             | 1    |\n|    | SYS-0002  | 2025-12-24T08:10:01 | {\u0026#34;marker\u0026#34;: \u0026#34;D\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | D             | 1    |\n|    | SYS-0003  | 2025-12-24T08:10:02 | {\u0026#34;marker\u0026#34;: \u0026#34;V\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | V             | 1    |\n|    | SYS-0004  | 2025-12-24T08:10:03 | {\u0026#34;marker\u0026#34;: \u0026#34;E\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | E             | 1    |\n|    | SYS-0005  | 2025-12-24T08:10:04 | {\u0026#34;marker\u0026#34;: \u0026#34;N\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | N             | 1    |\n|    | SYS-0006  | 2025-12-24T08:10:05 | {\u0026#34;marker\u0026#34;: \u0026#34;T\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | T             | 1    |\n|    | SYS-0007  | 2025-12-24T08:10:06 | {\u0026#34;marker\u0026#34;: \u0026#34;O\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | O             | 1    |\n|    | SYS-0008  | 2025-12-24T08:10:07 | {\u0026#34;marker\u0026#34;: \u0026#34;F\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | F             | 1    |\n|    | SYS-0009  | 2025-12-24T08:10:08 | {\u0026#34;marker\u0026#34;: \u0026#34;S\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | S             | 1    |\n|    | SYS-0010  | 2025-12-24T08:10:09 | {\u0026#34;marker\u0026#34;: \u0026#34;Q\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | Q             | 1    |\n|    | SYS-0011  | 2025-12-24T08:10:10 | {\u0026#34;marker\u0026#34;: \u0026#34;L\u0026#34;, \u0026#34;source\u0026#34;: \u0026#34;primary\u0026#34;} | L             | 1    |\n\u002b----\u002b-----------\u002b---------------------\u002b--------------------------------------\u002b---------------\u002b------\u002b\nsqlite\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Phew!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;That was a good one to end the advent of SQL!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;I enjoyed it!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;I learnt a ton\u0026lt;\/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;CTEs\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;JOINs (some wired stuff can be done)\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;Window Functions (LAG, LEAD, ROW_NUMBER)\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;FTS (in SQLite)\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;Json parsing\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;date shenanigans\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;CTEs don\u0026#39;t support insert and delete in SQLite (it ruined my day 10 solution)\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;Recursive CTEs\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;String manipulation (thanks to xml parsing)\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;I need to write a post about explaining what I learned.\u0026lt;\/li\u0026gt;\n\u0026lt;\/ul\u0026gt;\n\u0026lt;p\u0026gt;Thanks \u0026lt;a href=\u0026#34;https:\/\/aaronfrancis.com\/\u0026#34;\u0026gt;Aaron francis\u0026lt;\/a\u0026gt; from \u0026lt;a href=\u0026#34;https:\/\/databaseschool.com\/\u0026#34;\u0026gt;databaseschool\u0026lt;\/a\u0026gt; for this challenge and explaining in depth on each day(i didn\u0026#39;t watch all) and \u0026lt;a href=\u0026#34;https:\/\/x.com\/krpetrich\u0026#34;\u0026gt;Kelsey Petrich\u0026lt;\/a\u0026gt; for the lore of each problem, those were really lovely to read!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Happy Coding :)\nMerry Christmas\nHappy New year\nWhatever you celebrate!\u0026lt;\/p\u0026gt;\n"
    }
    </script>
    
    
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/code-block.css">
    <link rel="stylesheet" href="/post-navigation.css">
    
    <link rel="icon" href="/tbicon.png" type="image/png">
    <link rel="apple-touch-icon" href="/tbicon.png">
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link id="syntax-theme" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.13.0/sql-wasm.js"></script>
    <link rel="stylesheet" href="/sql-playground.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/monokai.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/sql/sql.min.js"></script>
    <script src="/sql-playground.js"></script>
    
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script>
    document.addEventListener("DOMContentLoaded", () => {
        const body = document.body;
        const stylesheet = document.getElementById("syntax-theme");
        const themeToggle = document.getElementById('theme-toggle');

        function setSyntaxTheme(theme) {
            if (theme === "secondary") {
                stylesheet.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css";
            } else {
                stylesheet.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css";
            }
        }

        
        document.querySelectorAll("pre code").forEach((block) => {
            hljs.highlightElement(block);
        });

        
        const currentTheme = localStorage.getItem("theme") || "default";
        if (currentTheme === "secondary") {
            body.classList.add("secondary-theme");
            if (themeToggle) themeToggle.checked = true;
        }
        setSyntaxTheme(currentTheme);

        
        if (themeToggle) {
            themeToggle.addEventListener('change', () => {
                const newTheme = themeToggle.checked ? 'secondary' : 'default';
                if (themeToggle.checked) {
                    body.classList.add('secondary-theme');
                } else {
                    body.classList.remove('secondary-theme');
                }
                localStorage.setItem('theme', newTheme);
                setSyntaxTheme(newTheme);
            });
        }
        
        
        const editBtn = document.getElementById('editor-edit');
        if (editBtn) {
            editBtn.addEventListener('click', async function () {
                const slug = "sqlog\/advent-of-sql-2025-day-15";
                const type = "sqlog";
                console.log("Editing post:", slug, type);
                const url = "https:\/\/devmeetgor.netlify.app/.netlify/functions/api?slug=" + slug + "&method=edit&type=" + type;
                
                try {
                    const res = await fetch(url);
                    if (!res.ok) throw new Error("Failed to fetch edit content");
                    const html = await res.text();
                    document.querySelector('.post-content').innerHTML = html;
                } catch (err) {
                    console.error(err);
                    alert("Error loading editor content");
                }
            });
        }
    });
    </script>
    
    
    <script src="/seasonal-effects.js" defer></script>
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EET2ZX4QY1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-EET2ZX4QY1');
    </script>
</head>
<body>
    <header class="header">
  <a class="site-title" href="/" aria-label="Meet Gor - Home">Meet Gor</a>
  <nav>
    <ul>
      <li><a href="/" aria-label="Home">Home</a></li>
      <li><a href="/posts" aria-label="Posts">Posts</a></li>
      <li><a href="/all-content" aria-label="All Content">All Content</a></li>
      <li><a href="/about" aria-label="About">About</a></li>
      <li><a href="/contact" aria-label="Contact">Contact</a></li>
    </ul>
  </nav>
  <div class="theme-switch">
    <input type="checkbox" id="theme-toggle" aria-label="Toggle Theme">
    <label for="theme-toggle"></label>
  </div>
  
</header>
    
    <main class="container">
        <article class="blog-post">
            <h1>Advent of SQL 2025 Day 15: Confirmation Phrase Dispatches</h1>
            
            <div class="post-meta">
                Published on  <time datetime="2025-12-28 20:30 &#43;0530">2025-12-28 20:30 &#43;0530</time>
            </div>
            
            <div class="post-meta">
                Type: <a href="/sqlog">sqlog</a>
            </div>
            
            <div class="post-meta tags">
                <span class="post-series-label"> Tags:</span>
                
                <a href="/tags/sqlite">#sqlite</a>
                
                <a href="/tags/sql">#sql</a>
                
                <a href="/tags/advent-of-sql">#advent-of-sql</a>
                
            </div>
            
            
            <div class="post-series">
                <span class="series-label">Part of the
                <span class="series-list">
                    
                    <a href="/series/advent-of-sql-2025" class="series-link"> advent-of-sql-2025</a>
                    
                </span></span>
                <span class="series-label">series</span>
            </div>
            
            
            
            
            <hr>
            
            <div class="post-content">
                <h2 id="advent-of-sql-day-15---confirmation-phrase-dispatches">Advent of SQL, Day 15 - Confirmation Phrase Dispatches</h2>
<p>We are on the final day of Advent of SQL!</p>
<p>I can't believe it, I completed it! (with some help of course, I ~~don't~~ didn't know SQL very well. But this 15 days flipped it around.). I feel good and fresh to start the year to go deep in SQLite and databases!</p>
<p>Let's solve the last day first, if it has somethings reamining to teach us!</p>
<p>We need to make a few changes.</p>
<p>SQLite doesn't have <code>-&gt;&gt;</code> operator for extracting JSON values from the columns, so we need to use <code>json_extract</code> instead.</p>
<p>So, replace this 9th line from and with:</p>
<div class="code-block"><div class="code-header"><span class="language-name">diff</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-diff">-    marker_letter TEXT GENERATED ALWAYS AS (payload ->> 'marker') STORED,
+    marker_letter TEXT GENERATED ALWAYS AS (json_extract(payload, '$.marker')) STORED,
</code></pre></div><p>Once we have it, we also need to remove the marker <code>::jsonb</code> from the each insert row, we can do that with <code>sed</code> or any other utility you like.</p>
<div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sed "s/'\(.*\)'::jsonb/'\1'/g" day15-inserts.sql > day15-inserts-sqlite.sql
</code></pre></div><div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">DROP TABLE IF EXISTS incoming_dispatches;
DROP TABLE IF EXISTS system_dispatches;

CREATE TABLE system_dispatches (
    id SERIAL PRIMARY KEY,
    system_id TEXT NOT NULL,
    dispatched_at TIMESTAMP NOT NULL,
    payload JSONB NOT NULL,
    marker_letter TEXT GENERATED ALWAYS AS (json_extract(payload, '$.marker')) STORED,
    UNIQUE (system_id, dispatched_at, payload)
);

CREATE TABLE incoming_dispatches (
    system_id TEXT,
    dispatched_at TIMESTAMP,
    payload JSONB
);

INSERT INTO system_dispatches (system_id, dispatched_at, payload) VALUES
('SYS-0081', '2025-12-21T06:02:26', '{"marker": "T", "source": "secondary"}'),
('SYS-0137', '2025-12-19T06:03:21', '{"marker": "D", "source": "secondary"}'),
('SYS-0237', '2025-12-19T06:23:37', '{"marker": "D", "source": "secondary"}'),
('SYS-0006', '2025-12-24T18:10:16', '{"marker": "K", "source": "secondary"}'),
('SYS-0170', '2025-12-19T06:17:24', '{"marker": "I", "source": "secondary"}'),
('SYS-0224', '2025-12-19T06:23:24', '{"marker": "S", "source": "secondary"}'),
('SYS-0007', '2025-12-24T18:10:06', '{"marker": "O", "source": "secondary"}'),
('SYS-0035', '2025-12-23T15:55:34', '{"marker": "C", "source": "secondary"}'),
('SYS-0010', '2025-12-23T15:55:09', '{"marker": "L", "source": "secondary"}'),
('SYS-0037', '2025-12-23T15:55:36', '{"marker": "D", "source": "secondary"}'),
('SYS-0001', '2025-12-24T08:02:00', '{"marker": "X", "source": "primary"}'),
('SYS-0225', '2025-12-19T06:23:25', '{"marker": "Q", "source": "secondary"}'),
('SYS-0095', '2025-12-21T06:02:40', '{"marker": "D", "source": "secondary"}'),
('SYS-0021', '2025-12-23T15:55:20', '{"marker": "W", "source": "secondary"}'),
('SYS-0001', '2025-12-24T08:10:00', '{"marker": "A", "source": "primary"}'),
('SYS-0009', '2025-12-24T08:02:08', '{"marker": "U", "source": "primary"}'),
('SYS-0119', '2025-12-19T06:03:03', '{"marker": "E", "source": "secondary"}'),
('SYS-0142', '2025-12-19T06:03:26', '{"marker": "O", "source": "secondary"}'),
('SYS-0048', '2025-12-23T15:55:30', '{"marker": "I", "source": "secondary"}'),
('SYS-0228', '2025-12-19T06:23:28', '{"marker": "G", "source": "secondary"}'),
('SYS-0092', '2025-12-21T06:02:37', '{"marker": "K", "source": "secondary"}'),
('SYS-0008', '2025-12-24T08:02:07', '{"marker": "B", "source": "primary"}'),
('SYS-0111', '2025-12-19T06:02:55', '{"marker": "W", "source": "secondary"}'),
('SYS-0106', '2025-12-19T06:02:50', '{"marker": "L", "source": "secondary"}'),
('SYS-0082', '2025-12-21T06:02:27', '{"marker": "O", "source": "secondary"}'),
('SYS-0180', '2025-12-19T06:17:31', '{"marker": "N", "source": "secondary"}'),
('SYS-0103', '2025-12-19T06:02:47', '{"marker": "F", "source": "secondary"}'),
('SYS-0096', '2025-12-21T06:02:41', '{"marker": "A", "source": "secondary"}'),
('SYS-0003', '2025-12-23T06:02:02', '{"marker": "Z", "source": "primary"}'),
('SYS-0157', '2025-12-19T06:17:11', '{"marker": "D", "source": "secondary"}'),
('SYS-0010', '2025-12-23T06:02:09', '{"marker": "C", "source": "primary"}'),
('SYS-0102', '2025-12-19T06:02:46', '{"marker": "O", "source": "secondary"}'),
('SYS-0072', '2025-12-23T06:02:18', '{"marker": "K", "source": "secondary"}'),
('SYS-0175', '2025-12-19T06:17:29', '{"marker": "D", "source": "secondary"}'),
('SYS-0214', '2025-12-19T06:23:14', '{"marker": "U", "source": "secondary"}'),
('SYS-0005', '2025-12-24T08:02:04', '{"marker": "P", "source": "primary"}'),
('SYS-0216', '2025-12-19T06:23:16', '{"marker": "A", "source": "secondary"}'),
('SYS-0047', '2025-12-23T15:55:46', '{"marker": "H", "source": "secondary"}'),
('SYS-0019', '2025-12-23T15:55:18', '{"marker": "H", "source": "secondary"}'),
('SYS-0043', '2025-12-23T15:55:42', '{"marker": "Q", "source": "secondary"}'),
('SYS-0039', '2025-12-23T15:55:38', '{"marker": "L", "source": "secondary"}'),
('SYS-0212', '2025-12-19T06:23:12', '{"marker": "K", "source": "secondary"}'),
('SYS-0133', '2025-12-19T06:03:17', '{"marker": "C", "source": "secondary"}'),
('SYS-0005', '2025-12-24T08:10:04', '{"marker": "N", "source": "primary"}'),
('SYS-0011', '2025-12-24T08:02:10', '{"marker": "J", "source": "primary"}'),
('SYS-0080', '2025-12-21T06:02:25', '{"marker": "N", "source": "secondary"}'),
('SYS-0230', '2025-12-19T06:23:30', '{"marker": "I", "source": "secondary"}'),
('SYS-0100', '2025-12-21T06:02:45', '{"marker": "N", "source": "secondary"}'),
('SYS-0061', '2025-12-23T06:02:07', '{"marker": "T", "source": "secondary"}'),
('SYS-0022', '2025-12-23T15:55:21', '{"marker": "K", "source": "secondary"}'),
('SYS-0149', '2025-12-19T06:17:03', '{"marker": "H", "source": "secondary"}'),
('SYS-0009', '2025-12-23T15:55:08', '{"marker": "D", "source": "secondary"}'),
('SYS-0002', '2025-12-24T08:02:01', '{"marker": "Y", "source": "primary"}'),
('SYS-0132', '2025-12-19T06:03:16', '{"marker": "K", "source": "secondary"}'),
('SYS-0033', '2025-12-23T15:55:32', '{"marker": "W", "source": "secondary"}'),
('SYS-0193', '2025-12-19T06:17:44', '{"marker": "C", "source": "secondary"}'),
('SYS-0167', '2025-12-19T06:17:21', '{"marker": "A", "source": "secondary"}'),
('SYS-0008', '2025-12-24T08:10:07', '{"marker": "F", "source": "primary"}'),
('SYS-0186', '2025-12-19T06:17:37', '{"marker": "L", "source": "secondary"}'),
('SYS-0078', '2025-12-21T06:02:23', '{"marker": "V", "source": "secondary"}'),
('SYS-0085', '2025-12-21T06:02:30', '{"marker": "Q", "source": "secondary"}'),
('SYS-0046', '2025-12-23T15:55:45', '{"marker": "G", "source": "secondary"}'),
('SYS-0054', '2025-12-23T15:55:36', '{"marker": "W", "source": "secondary"}'),
('SYS-0235', '2025-12-19T06:23:35', '{"marker": "D", "source": "secondary"}'),
('SYS-0089', '2025-12-21T06:02:34', '{"marker": "H", "source": "secondary"}'),
('SYS-0011', '2025-12-23T06:02:10', '{"marker": "J", "source": "primary"}'),
('SYS-0034', '2025-12-23T15:55:33', '{"marker": "K", "source": "secondary"}'),
('SYS-0129', '2025-12-19T06:03:13', '{"marker": "H", "source": "secondary"}'),
('SYS-0211', '2025-12-19T06:23:11', '{"marker": "W", "source": "secondary"}'),
('SYS-0151', '2025-12-19T06:17:05', '{"marker": "W", "source": "secondary"}'),
('SYS-0204', '2025-12-19T06:23:04', '{"marker": "S", "source": "secondary"}'),
('SYS-0213', '2025-12-19T06:23:13', '{"marker": "C", "source": "secondary"}'),
('SYS-0147', '2025-12-19T06:03:31', '{"marker": "A", "source": "secondary"}'),
('SYS-0140', '2025-12-19T06:03:24', '{"marker": "N", "source": "secondary"}'),
('SYS-0123', '2025-12-19T06:03:07', '{"marker": "F", "source": "secondary"}'),
('SYS-0052', '2025-12-23T15:55:34', '{"marker": "H", "source": "secondary"}'),
('SYS-0148', '2025-12-19T06:17:02', '{"marker": "G", "source": "secondary"}'),
('SYS-0059', '2025-12-23T06:02:05', '{"marker": "E", "source": "secondary"}'),
('SYS-0027', '2025-12-23T15:55:26', '{"marker": "K", "source": "secondary"}'),
('SYS-0055', '2025-12-23T15:55:37', '{"marker": "K", "source": "secondary"}'),
('SYS-0155', '2025-12-19T06:17:09', '{"marker": "D", "source": "secondary"}'),
('SYS-0107', '2025-12-19T06:02:51', '{"marker": "A", "source": "secondary"}'),
('SYS-0173', '2025-12-19T06:17:27', '{"marker": "C", "source": "secondary"}'),
('SYS-0007', '2025-12-23T06:02:06', '{"marker": "K", "source": "primary"}'),
('SYS-0016', '2025-12-23T15:55:15', '{"marker": "L", "source": "secondary"}'),
('SYS-0168', '2025-12-19T06:17:22', '{"marker": "G", "source": "secondary"}'),
('SYS-0196', '2025-12-19T06:17:47', '{"marker": "A", "source": "secondary"}'),
('SYS-0234', '2025-12-19T06:23:34', '{"marker": "U", "source": "secondary"}'),
('SYS-0210', '2025-12-19T06:23:10', '{"marker": "I", "source": "secondary"}'),
('SYS-0135', '2025-12-19T06:03:19', '{"marker": "D", "source": "secondary"}'),
('SYS-0150', '2025-12-19T06:17:04', '{"marker": "I", "source": "secondary"}'),
('SYS-0091', '2025-12-21T06:02:36', '{"marker": "W", "source": "secondary"}'),
('SYS-0154', '2025-12-19T06:17:08', '{"marker": "U", "source": "secondary"}'),
('SYS-0223', '2025-12-19T06:23:23', '{"marker": "F", "source": "secondary"}'),
('SYS-0020', '2025-12-23T15:55:19', '{"marker": "I", "source": "secondary"}'),
('SYS-0160', '2025-12-19T06:17:14', '{"marker": "N", "source": "secondary"}'),
('SYS-0128', '2025-12-19T06:03:12', '{"marker": "G", "source": "secondary"}'),
('SYS-0194', '2025-12-19T06:17:45', '{"marker": "U", "source": "secondary"}'),
('SYS-0231', '2025-12-19T06:23:31', '{"marker": "W", "source": "secondary"}'),
('SYS-0045', '2025-12-23T15:55:44', '{"marker": "A", "source": "secondary"}'),
('SYS-0190', '2025-12-19T06:17:41', '{"marker": "I", "source": "secondary"}'),
('SYS-0197', '2025-12-19T06:17:48', '{"marker": "D", "source": "secondary"}'),
('SYS-0002', '2025-12-23T06:02:01', '{"marker": "Y", "source": "primary"}'),
('SYS-0008', '2025-12-24T18:10:07', '{"marker": "F", "source": "secondary"}'),
('SYS-0158', '2025-12-19T06:17:12', '{"marker": "V", "source": "secondary"}'),
('SYS-0003', '2025-12-24T08:10:02', '{"marker": "V", "source": "primary"}'),
('SYS-0171', '2025-12-19T06:17:25', '{"marker": "W", "source": "secondary"}'),
('SYS-0229', '2025-12-19T06:23:29', '{"marker": "H", "source": "secondary"}'),
('SYS-0079', '2025-12-21T06:02:24', '{"marker": "E", "source": "secondary"}'),
('SYS-0215', '2025-12-19T06:23:15', '{"marker": "D", "source": "secondary"}'),
('SYS-0233', '2025-12-19T06:23:33', '{"marker": "C", "source": "secondary"}'),
('SYS-0060', '2025-12-23T06:02:06', '{"marker": "N", "source": "secondary"}'),
('SYS-0026', '2025-12-23T15:55:25', '{"marker": "W", "source": "secondary"}'),
('SYS-0125', '2025-12-19T06:03:09', '{"marker": "Q", "source": "secondary"}'),
('SYS-0001', '2025-12-24T18:10:00', '{"marker": "A", "source": "secondary"}'),
('SYS-0136', '2025-12-19T06:03:20', '{"marker": "A", "source": "secondary"}'),
('SYS-0010', '2025-12-24T08:02:09', '{"marker": "C", "source": "primary"}'),
('SYS-0010', '2025-12-24T08:10:09', '{"marker": "Q", "source": "primary"}'),
('SYS-0044', '2025-12-23T15:55:43', '{"marker": "L", "source": "secondary"}'),
('SYS-0115', '2025-12-19T06:02:59', '{"marker": "D", "source": "secondary"}'),
('SYS-0005', '2025-12-24T18:10:15', '{"marker": "W", "source": "secondary"}'),
('SYS-0094', '2025-12-21T06:02:39', '{"marker": "U", "source": "secondary"}'),
('SYS-0191', '2025-12-19T06:17:42', '{"marker": "W", "source": "secondary"}'),
('SYS-0182', '2025-12-19T06:17:33', '{"marker": "O", "source": "secondary"}'),
('SYS-0195', '2025-12-19T06:17:46', '{"marker": "D", "source": "secondary"}'),
('SYS-0227', '2025-12-19T06:23:27', '{"marker": "A", "source": "secondary"}'),
('SYS-0032', '2025-12-23T15:55:31', '{"marker": "I", "source": "secondary"}'),
('SYS-0177', '2025-12-19T06:17:31', '{"marker": "D", "source": "secondary"}'),
('SYS-0068', '2025-12-23T06:02:14', '{"marker": "G", "source": "secondary"}'),
('SYS-0069', '2025-12-23T06:02:15', '{"marker": "H", "source": "secondary"}'),
('SYS-0009', '2025-12-23T06:02:08', '{"marker": "U", "source": "primary"}'),
('SYS-0176', '2025-12-19T06:17:30', '{"marker": "A", "source": "secondary"}'),
('SYS-0008', '2025-12-23T06:02:07', '{"marker": "B", "source": "primary"}'),
('SYS-0099', '2025-12-21T06:02:44', '{"marker": "E", "source": "secondary"}'),
('SYS-0014', '2025-12-23T15:55:13', '{"marker": "S", "source": "secondary"}'),
('SYS-0042', '2025-12-23T15:55:41', '{"marker": "S", "source": "secondary"}'),
('SYS-0006', '2025-12-24T08:02:05', '{"marker": "R", "source": "primary"}'),
('SYS-0187', '2025-12-19T06:17:38', '{"marker": "A", "source": "secondary"}'),
('SYS-0174', '2025-12-19T06:17:28', '{"marker": "U", "source": "secondary"}'),
('SYS-0056', '2025-12-23T15:55:55', '{"marker": "A", "source": "secondary"}'),
('SYS-0199', '2025-12-19T06:17:50', '{"marker": "E", "source": "secondary"}'),
('SYS-0120', '2025-12-19T06:03:04', '{"marker": "N", "source": "secondary"}'),
('SYS-0003', '2025-12-24T08:02:02', '{"marker": "Z", "source": "primary"}'),
('SYS-0116', '2025-12-19T06:02:59', '{"marker": "A", "source": "secondary"}'),
('SYS-0008', '2025-12-24T18:10:18', '{"marker": "U", "source": "secondary"}'),
('SYS-0205', '2025-12-19T06:23:05', '{"marker": "Q", "source": "secondary"}'),
('SYS-0006', '2025-12-24T08:10:05', '{"marker": "T", "source": "primary"}'),
('SYS-0145', '2025-12-19T06:03:29', '{"marker": "Q", "source": "secondary"}'),
('SYS-0004', '2025-12-24T08:10:03', '{"marker": "E", "source": "primary"}'),
('SYS-0065', '2025-12-23T06:02:11', '{"marker": "Q", "source": "secondary"}'),
('SYS-0086', '2025-12-21T06:02:31', '{"marker": "L", "source": "secondary"}'),
('SYS-0188', '2025-12-19T06:17:39', '{"marker": "G", "source": "secondary"}'),
('SYS-0183', '2025-12-19T06:17:34', '{"marker": "F", "source": "secondary"}'),
('SYS-0062', '2025-12-23T06:02:08', '{"marker": "O", "source": "secondary"}'),
('SYS-0058', '2025-12-23T15:55:57', '{"marker": "V", "source": "secondary"}'),
('SYS-0169', '2025-12-19T06:17:23', '{"marker": "H", "source": "secondary"}'),
('SYS-0105', '2025-12-19T06:02:49', '{"marker": "Q", "source": "secondary"}'),
('SYS-0001', '2025-12-24T18:10:11', '{"marker": "A", "source": "secondary"}'),
('SYS-0005', '2025-12-23T06:02:04', '{"marker": "P", "source": "primary"}'),
('SYS-0131', '2025-12-19T06:03:15', '{"marker": "W", "source": "secondary"}'),
('SYS-0232', '2025-12-19T06:23:32', '{"marker": "K", "source": "secondary"}'),
('SYS-0028', '2025-12-23T15:55:27', '{"marker": "L", "source": "secondary"}'),
('SYS-0070', '2025-12-23T06:02:16', '{"marker": "I", "source": "secondary"}'),
('SYS-0029', '2025-12-23T15:55:28', '{"marker": "A", "source": "secondary"}'),
('SYS-0127', '2025-12-19T06:03:11', '{"marker": "A", "source": "secondary"}'),
('SYS-0010', '2025-12-24T18:10:09', '{"marker": "Q", "source": "secondary"}'),
('SYS-0025', '2025-12-23T15:55:24', '{"marker": "I", "source": "secondary"}'),
('SYS-0164', '2025-12-19T06:17:18', '{"marker": "S", "source": "secondary"}'),
('SYS-0114', '2025-12-19T06:02:58', '{"marker": "U", "source": "secondary"}'),
('SYS-0009', '2025-12-24T18:10:08', '{"marker": "S", "source": "secondary"}'),
('SYS-0184', '2025-12-19T06:17:35', '{"marker": "S", "source": "secondary"}'),
('SYS-0003', '2025-12-24T18:10:02', '{"marker": "V", "source": "secondary"}'),
('SYS-0053', '2025-12-23T15:55:35', '{"marker": "I", "source": "secondary"}'),
('SYS-0117', '2025-12-19T06:03:01', '{"marker": "D", "source": "secondary"}'),
('SYS-0074', '2025-12-23T06:02:20', '{"marker": "U", "source": "secondary"}'),
('SYS-0198', '2025-12-19T06:17:49', '{"marker": "V", "source": "secondary"}'),
('SYS-0036', '2025-12-23T15:55:35', '{"marker": "U", "source": "secondary"}'),
('SYS-0112', '2025-12-19T06:02:56', '{"marker": "K", "source": "secondary"}'),
('SYS-0023', '2025-12-23T15:55:22', '{"marker": "C", "source": "secondary"}'),
('SYS-0121', '2025-12-19T06:03:05', '{"marker": "T", "source": "secondary"}'),
('SYS-0181', '2025-12-19T06:17:32', '{"marker": "T", "source": "secondary"}'),
('SYS-0003', '2025-12-24T18:10:13', '{"marker": "H", "source": "secondary"}'),
('SYS-0130', '2025-12-19T06:03:14', '{"marker": "I", "source": "secondary"}'),
('SYS-0066', '2025-12-23T06:02:12', '{"marker": "L", "source": "secondary"}'),
('SYS-0203', '2025-12-19T06:17:54', '{"marker": "F", "source": "secondary"}'),
('SYS-0002', '2025-12-24T18:10:01', '{"marker": "D", "source": "secondary"}'),
('SYS-0104', '2025-12-19T06:02:48', '{"marker": "S", "source": "secondary"}'),
('SYS-0017', '2025-12-23T15:55:16', '{"marker": "A", "source": "secondary"}'),
('SYS-0004', '2025-12-24T18:10:03', '{"marker": "E", "source": "secondary"}'),
('SYS-0238', '2025-12-19T06:23:38', '{"marker": "D", "source": "secondary"}'),
('SYS-0110', '2025-12-19T06:02:54', '{"marker": "I", "source": "secondary"}'),
('SYS-0071', '2025-12-23T06:02:17', '{"marker": "W", "source": "secondary"}'),
('SYS-0004', '2025-12-24T18:10:14', '{"marker": "I", "source": "secondary"}'),
('SYS-0031', '2025-12-23T15:55:30', '{"marker": "H", "source": "secondary"}'),
('SYS-0004', '2025-12-23T06:02:03', '{"marker": "M", "source": "primary"}'),
('SYS-0141', '2025-12-19T06:03:25', '{"marker": "T", "source": "secondary"}'),
('SYS-0207', '2025-12-19T06:23:07', '{"marker": "A", "source": "secondary"}'),
('SYS-0122', '2025-12-19T06:03:06', '{"marker": "O", "source": "secondary"}'),
('SYS-0006', '2025-12-24T18:10:05', '{"marker": "T", "source": "secondary"}'),
('SYS-0030', '2025-12-23T15:55:29', '{"marker": "G", "source": "secondary"}'),
('SYS-0192', '2025-12-19T06:17:43', '{"marker": "K", "source": "secondary"}'),
('SYS-0144', '2025-12-19T06:03:28', '{"marker": "S", "source": "secondary"}'),
('SYS-0098', '2025-12-21T06:02:43', '{"marker": "V", "source": "secondary"}'),
('SYS-0200', '2025-12-19T06:17:51', '{"marker": "N", "source": "secondary"}'),
('SYS-0007', '2025-12-24T08:02:06', '{"marker": "K", "source": "primary"}'),
('SYS-0220', '2025-12-19T06:23:20', '{"marker": "N", "source": "secondary"}'),
('SYS-0063', '2025-12-23T06:02:09', '{"marker": "F", "source": "secondary"}'),
('SYS-0109', '2025-12-19T06:02:53', '{"marker": "H", "source": "secondary"}'),
('SYS-0179', '2025-12-19T06:17:30', '{"marker": "E", "source": "secondary"}'),
('SYS-0163', '2025-12-19T06:17:17', '{"marker": "F", "source": "secondary"}'),
('SYS-0162', '2025-12-19T06:17:16', '{"marker": "O", "source": "secondary"}'),
('SYS-0222', '2025-12-19T06:23:22', '{"marker": "O", "source": "secondary"}'),
('SYS-0134', '2025-12-19T06:03:18', '{"marker": "U", "source": "secondary"}'),
('SYS-0004', '2025-12-24T08:02:03', '{"marker": "M", "source": "primary"}'),
('SYS-0139', '2025-12-19T06:03:23', '{"marker": "E", "source": "secondary"}'),
('SYS-0097', '2025-12-21T06:02:42', '{"marker": "D", "source": "secondary"}'),
('SYS-0146', '2025-12-19T06:03:30', '{"marker": "L", "source": "secondary"}'),
('SYS-0101', '2025-12-19T06:02:45', '{"marker": "T", "source": "secondary"}'),
('SYS-0201', '2025-12-19T06:17:52', '{"marker": "T", "source": "secondary"}'),
('SYS-0051', '2025-12-23T15:55:33', '{"marker": "C", "source": "secondary"}'),
('SYS-0172', '2025-12-19T06:17:26', '{"marker": "K", "source": "secondary"}'),
('SYS-0083', '2025-12-21T06:02:28', '{"marker": "F", "source": "secondary"}'),
('SYS-0009', '2025-12-24T08:10:08', '{"marker": "S", "source": "primary"}'),
('SYS-0124', '2025-12-19T06:03:08', '{"marker": "S", "source": "secondary"}'),
('SYS-0041', '2025-12-23T15:55:40', '{"marker": "F", "source": "secondary"}'),
('SYS-0049', '2025-12-23T15:55:31', '{"marker": "W", "source": "secondary"}'),
('SYS-0202', '2025-12-19T06:17:53', '{"marker": "O", "source": "secondary"}'),
('SYS-0178', '2025-12-19T06:17:29', '{"marker": "V", "source": "secondary"}'),
('SYS-0090', '2025-12-21T06:02:35', '{"marker": "I", "source": "secondary"}'),
('SYS-0006', '2025-12-23T06:02:05', '{"marker": "R", "source": "primary"}'),
('SYS-0073', '2025-12-23T06:02:19', '{"marker": "C", "source": "secondary"}'),
('SYS-0076', '2025-12-23T06:02:22', '{"marker": "A", "source": "secondary"}'),
('SYS-0217', '2025-12-19T06:23:17', '{"marker": "D", "source": "secondary"}'),
('SYS-0159', '2025-12-19T06:17:13', '{"marker": "E", "source": "secondary"}'),
('SYS-0161', '2025-12-19T06:17:15', '{"marker": "T", "source": "secondary"}'),
('SYS-0221', '2025-12-19T06:23:21', '{"marker": "T", "source": "secondary"}'),
('SYS-0236', '2025-12-19T06:23:36', '{"marker": "U", "source": "secondary"}'),
('SYS-0064', '2025-12-23T06:02:10', '{"marker": "S", "source": "secondary"}'),
('SYS-0126', '2025-12-19T06:03:10', '{"marker": "L", "source": "secondary"}'),
('SYS-0024', '2025-12-23T15:55:23', '{"marker": "H", "source": "secondary"}'),
('SYS-0113', '2025-12-19T06:02:57', '{"marker": "C", "source": "secondary"}'),
('SYS-0038', '2025-12-23T15:55:37', '{"marker": "L", "source": "secondary"}'),
('SYS-0075', '2025-12-23T06:02:21', '{"marker": "D", "source": "secondary"}'),
('SYS-0088', '2025-12-21T06:02:33', '{"marker": "G", "source": "secondary"}'),
('SYS-0007', '2025-12-24T08:10:06', '{"marker": "O", "source": "primary"}'),
('SYS-0067', '2025-12-23T06:02:13', '{"marker": "A", "source": "secondary"}'),
('SYS-0156', '2025-12-19T06:17:10', '{"marker": "A", "source": "secondary"}'),
('SYS-0040', '2025-12-23T15:55:39', '{"marker": "O", "source": "secondary"}'),
('SYS-0219', '2025-12-19T06:23:19', '{"marker": "E", "source": "secondary"}'),
('SYS-0166', '2025-12-19T06:17:20', '{"marker": "L", "source": "secondary"}'),
('SYS-0007', '2025-12-24T18:10:17', '{"marker": "C", "source": "secondary"}'),
('SYS-0153', '2025-12-19T06:17:07', '{"marker": "C", "source": "secondary"}'),
('SYS-0077', '2025-12-23T06:02:23', '{"marker": "D", "source": "secondary"}'),
('SYS-0084', '2025-12-21T06:02:29', '{"marker": "S", "source": "secondary"}');

INSERT INTO incoming_dispatches (system_id, dispatched_at, payload) VALUES
('SYS-0013', '2025-12-23T15:55:12', '{"marker": "F", "source": "secondary"}'),
('SYS-0002', '2025-12-24T08:10:01', '{"marker": "D", "source": "primary"}'),
('SYS-0012', '2025-12-23T15:55:11', '{"marker": "O", "source": "secondary"}'),
('SYS-0108', '2025-12-19T06:02:52', '{"marker": "G", "source": "secondary"}'),
('SYS-0165', '2025-12-19T06:17:19', '{"marker": "Q", "source": "secondary"}'),
('SYS-0189', '2025-12-19T06:17:40', '{"marker": "H", "source": "secondary"}'),
('SYS-0050', '2025-12-23T15:55:32', '{"marker": "K", "source": "secondary"}'),
('SYS-0138', '2025-12-19T06:03:22', '{"marker": "V", "source": "secondary"}'),
('SYS-0087', '2025-12-21T06:02:32', '{"marker": "A", "source": "secondary"}'),
('SYS-0208', '2025-12-19T06:23:08', '{"marker": "G", "source": "secondary"}'),
('SYS-0057', '2025-12-23T15:55:56', '{"marker": "D", "source": "secondary"}'),
('SYS-0002', '2025-12-24T18:10:12', '{"marker": "G", "source": "secondary"}'),
('SYS-0011', '2025-12-24T08:10:10', '{"marker": "L", "source": "primary"}'),
('SYS-0226', '2025-12-19T06:23:26', '{"marker": "L", "source": "secondary"}'),
('SYS-0206', '2025-12-19T06:23:06', '{"marker": "L", "source": "secondary"}'),
('SYS-0118', '2025-12-19T06:03:02', '{"marker": "V", "source": "secondary"}'),
('SYS-0185', '2025-12-19T06:17:36', '{"marker": "Q", "source": "secondary"}'),
('SYS-0218', '2025-12-19T06:23:18', '{"marker": "V", "source": "secondary"}'),
('SYS-0018', '2025-12-23T15:55:17', '{"marker": "G", "source": "secondary"}'),
('SYS-0005', '2025-12-24T18:10:04', '{"marker": "N", "source": "secondary"}'),
('SYS-0093', '2025-12-21T06:02:38', '{"marker": "C", "source": "secondary"}'),
('SYS-0011', '2025-12-24T18:10:10', '{"marker": "L", "source": "secondary"}'),
('SYS-0011', '2025-12-23T15:55:10', '{"marker": "L", "source": "secondary"}'),
('SYS-0143', '2025-12-19T06:03:27', '{"marker": "F", "source": "secondary"}'),
('SYS-0152', '2025-12-19T06:17:06', '{"marker": "K", "source": "secondary"}'),
('SYS-0015', '2025-12-23T15:55:14', '{"marker": "Q", "source": "secondary"}'),
('SYS-0001', '2025-12-23T06:02:00', '{"marker": "X", "source": "primary"}'),
('SYS-0209', '2025-12-19T06:23:09', '{"marker": "H", "source": "secondary"}'),
('SYS-0133', '2025-12-19T06:03:17', '{"marker": "C", "source": "secondary"}'),
('SYS-0158', '2025-12-19T06:17:12', '{"marker": "V", "source": "secondary"}'),
('SYS-0195', '2025-12-19T06:17:46', '{"marker": "D", "source": "secondary"}'),
('SYS-0182', '2025-12-19T06:17:33', '{"marker": "O", "source": "secondary"}'),
('SYS-0033', '2025-12-23T15:55:32', '{"marker": "W", "source": "secondary"}'),
('SYS-0083', '2025-12-21T06:02:28', '{"marker": "F", "source": "secondary"}'),
('SYS-0002', '2025-12-23T06:02:01', '{"marker": "Y", "source": "primary"}'),
('SYS-0076', '2025-12-23T06:02:22', '{"marker": "A", "source": "secondary"}'),
('SYS-0009', '2025-12-24T08:02:08', '{"marker": "U", "source": "primary"}'),
('SYS-0194', '2025-12-19T06:17:45', '{"marker": "U", "source": "secondary"}');

</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>$ sqlite3
SQLite version 3.50.4 2025-07-30 19:33:53
Enter ".help" for usage hints.
Connected to a transient in-memory database.
Use ".open FILENAME" to reopen on a persistent database.
sqlite> .read day15-inserts.sql
Parse error near line 19: unrecognized token: ":"
  6:02:26', '{"marker": "T", "source": "secondary"}'::jsonb), ('SYS-0137', '2025
                                      error here ---^
Parse error near line 275: unrecognized token: ":"
  5:55:12', '{"marker": "F", "source": "secondary"}'::jsonb), ('SYS-0002', '2025
                                      error here ---^
sqlite> .read day15-inserts-sqlite.sql
sqlite> .schema
CREATE TABLE system_dispatches (
    id SERIAL PRIMARY KEY,
    system_id TEXT NOT NULL,
    dispatched_at TIMESTAMP NOT NULL,
    payload JSONB NOT NULL,
    marker_letter TEXT GENERATED ALWAYS AS (json_extract(payload, '$.marker')) STORED,
    UNIQUE (system_id, dispatched_at, payload)
);
CREATE TABLE incoming_dispatches (
    system_id TEXT,
    dispatched_at TIMESTAMP,
    payload JSONB
);
sqlite> .mode table
sqlite> SELECT * FROM system_dispatches LIMIT 10;
+----+-----------+---------------------+----------------------------------------+---------------+
| id | system_id |    dispatched_at    |                payload                 | marker_letter |
+----+-----------+---------------------+----------------------------------------+---------------+
|    | SYS-0081  | 2025-12-21T06:02:26 | {"marker": "T", "source": "secondary"} | T             |
|    | SYS-0137  | 2025-12-19T06:03:21 | {"marker": "D", "source": "secondary"} | D             |
|    | SYS-0237  | 2025-12-19T06:23:37 | {"marker": "D", "source": "secondary"} | D             |
|    | SYS-0006  | 2025-12-24T18:10:16 | {"marker": "K", "source": "secondary"} | K             |
|    | SYS-0170  | 2025-12-19T06:17:24 | {"marker": "I", "source": "secondary"} | I             |
|    | SYS-0224  | 2025-12-19T06:23:24 | {"marker": "S", "source": "secondary"} | S             |
|    | SYS-0007  | 2025-12-24T18:10:06 | {"marker": "O", "source": "secondary"} | O             |
|    | SYS-0035  | 2025-12-23T15:55:34 | {"marker": "C", "source": "secondary"} | C             |
|    | SYS-0010  | 2025-12-23T15:55:09 | {"marker": "L", "source": "secondary"} | L             |
|    | SYS-0037  | 2025-12-23T15:55:36 | {"marker": "D", "source": "secondary"} | D             |
+----+-----------+---------------------+----------------------------------------+---------------+
sqlite> SELECT * FROM incoming_dispatches LIMIT 10;
+-----------+---------------------+----------------------------------------+
| system_id |    dispatched_at    |                payload                 |
+-----------+---------------------+----------------------------------------+
| SYS-0013  | 2025-12-23T15:55:12 | {"marker": "F", "source": "secondary"} |
| SYS-0002  | 2025-12-24T08:10:01 | {"marker": "D", "source": "primary"}   |
| SYS-0012  | 2025-12-23T15:55:11 | {"marker": "O", "source": "secondary"} |
| SYS-0108  | 2025-12-19T06:02:52 | {"marker": "G", "source": "secondary"} |
| SYS-0165  | 2025-12-19T06:17:19 | {"marker": "Q", "source": "secondary"} |
| SYS-0189  | 2025-12-19T06:17:40 | {"marker": "H", "source": "secondary"} |
| SYS-0050  | 2025-12-23T15:55:32 | {"marker": "K", "source": "secondary"} |
| SYS-0138  | 2025-12-19T06:03:22 | {"marker": "V", "source": "secondary"} |
| SYS-0087  | 2025-12-21T06:02:32 | {"marker": "A", "source": "secondary"} |
| SYS-0208  | 2025-12-19T06:23:08 | {"marker": "G", "source": "secondary"} |
+-----------+---------------------+----------------------------------------+
sqlite>
</code></pre></div><p>Good to go!</p>
<h2 id="problem">Problem</h2>
<blockquote>
<p>Reconstruct the final confirmation phrase to text Santa based on the elves hazy recollection of how they solved this problem before.</p>
<p>Your final result should include the marker_letter for each system, using only the most recent dispatch from a primary source. Once the correct dispatch has been identified for every system, combine the results and order them by dispatched_at in ascending order to reveal the confirmation phrase.</p>
<p>The sleigh wont launch without it.</p>
</blockquote>
<p>So, we need to first make sure we have the right <code>dispatches</code>.</p>
<p>We have two tables.</p>
<ol>
<li><code>system_dispatches</code></li>
<li><code>incoming_dispatches</code></li>
</ol>
<p>The problem statement also states:</p>
<blockquote>
<p>The system kept throwing errors until we figured out how to handle duplicates. Whatever you do the records already in system_dispatches must take precedence.</p>
</blockquote>
<p>So, we need to take the <code>system_dispatches</code> as the ground truth. However we need to include something or the other from the <code>incoming_dispatches</code> as there are new entries being created.</p>
<p>So, we will first try to insert into the system dispatches everything in the <code>incoming_dispatches</code></p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">INSERT INTO system_dispatches (system_id, dispatched_at, payload)
SELECT system_id, dispatched_at, payload
FROM incoming_dispatches;
</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> INSERT INTO system_dispatches (system_id, dispatched_at, payload)
SELECT system_id, dispatched_at, payload
FROM incoming_dispatches;
Runtime error: UNIQUE constraint failed: system_dispatches.system_id, system_dispatches.dispatched_at, system_dispatches.payload (19)
sqlite>
</code></pre></div><p>Ops!</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT COUNT(*) as system_dispatches_count FROM system_dispatches ;
SELECT COUNT(*) as incoming_dispatches_count FROM incoming_dispatches;
SELECT COUNT(*) as common_dispatches_count FROM (SELECT system_id, dispatched_at, payload FROM system_dispatches INTERSECT SELECT * FROM incoming_dispatches);


</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> SELECT COUNT(*) FROM system_dispatches ;
+----------+
| COUNT(*) |
+----------+
| 254      |
+----------+
sqlite> SELECT COUNT(*) FROM incoming_dispatches;
+----------+
| COUNT(*) |
+----------+
| 38       |
+----------+

sqlite> SELECT COUNT(*) FROM (SELECT system_id, dispatched_at, payload FROM system_dispatches UNION SELECT * FROM incoming_dispatches);
+----------+
| COUNT(*) |
+----------+
| 282      |
+----------+

sqlite> SELECT DISTINCT COUNT(*) FROM (SELECT system_id, dispatched_at, payload FROM system_dispatches UNION SELECT * FROM incoming_dispatches);
+----------+
| COUNT(*) |
+----------+
| 282      |
+----------+

sqlite> SELECT COUNT(*) FROM (SELECT system_id, dispatched_at, payload FROM system_dispatches INTERSECT SELECT * FROM incoming_dispatches);
+----------+
| COUNT(*) |
+----------+
| 10       |
+----------+
sqlite>
</code></pre></div><p>We need to be careful about what we insert into the <code>system_dispatches</code>.</p>
<p>I think the duplicates causes this conflict in constraints, we can ignore on the constraint failures and don't insert that row.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">INSERT OR IGNORE INTO system_dispatches (system_id, dispatched_at, payload)
SELECT system_id, dispatched_at, payload
FROM incoming_dispatches;
</code></pre><div class="output"></div></div><p>Ok, now if we see the count, we get <code>282</code> which is making sense.</p>
<ul>
<li>The original <code>system_dispatches</code> had a count of <code>254</code> before merge.</li>
<li>The original <code>incoming_dispatches</code> had a count of <code>38</code>.</li>
<li>After merging <code>incoming_dispatches</code> into <code>system_dispatches</code> table, we have a <code>282</code> records in <code>system_dispatches</code> but <code>254+38=292</code>, what about the <code>10</code>? Those were already there in the <code>system_dispatches</code>. As we saw in the earlier query, there were <code>10</code> rows in common from the <code>incoming_dispatches</code> table before merge.</li>
</ul>
<div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> SELECT COUNT(*) FROM system_dispatches ;
+----------+
| COUNT(*) |
+----------+
| 254      |
+----------+
sqlite> SELECT COUNT(*) FROM incoming_dispatches;
+----------+
| COUNT(*) |
+----------+
| 38       |
+----------+
sqlite> INSERT INTO system_dispatches (system_id, dispatched_at, payload)
SELECT system_id, dispatched_at, payload
FROM incoming_dispatches;
Runtime error: UNIQUE constraint failed: system_dispatches.system_id, system_dispatches.dispatched_at, system_dispatches.payload (19)
sqlite> INSERT OR IGNORE INTO system_dispatches (system_id, dispatched_at, payload)
SELECT system_id, dispatched_at, payload
FROM incoming_dispatches;
sqlite> SELECT COUNT(*) FROM system_dispatches ;
+----------+
| COUNT(*) |
+----------+
| 282      |
+----------+
sqlite>
</code></pre></div><p>Now, to the actual problem.</p>
<p>What we need to do now?</p>
<ul>
<li>Using only the most recent dispatch from a primary source.</li>
<li>Once the correct dispatch has been identified for every system, combine the results and order them by dispatched_at in ascending order</li>
<li>Reveal the confirmation phrase</li>
</ul>
<p>We have the single source now!</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT * FROM system_dispatches LIMIT 10;
</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>SELECT * FROM system_dispatches LIMIT 10;
+----+-----------+---------------------+----------------------------------------+---------------+
| id | system_id |    dispatched_at    |                payload                 | marker_letter |
+----+-----------+---------------------+----------------------------------------+---------------+
|    | SYS-0081  | 2025-12-21T06:02:26 | {"marker": "T", "source": "secondary"} | T             |
|    | SYS-0137  | 2025-12-19T06:03:21 | {"marker": "D", "source": "secondary"} | D             |
|    | SYS-0237  | 2025-12-19T06:23:37 | {"marker": "D", "source": "secondary"} | D             |
|    | SYS-0006  | 2025-12-24T18:10:16 | {"marker": "K", "source": "secondary"} | K             |
|    | SYS-0170  | 2025-12-19T06:17:24 | {"marker": "I", "source": "secondary"} | I             |
|    | SYS-0224  | 2025-12-19T06:23:24 | {"marker": "S", "source": "secondary"} | S             |
|    | SYS-0007  | 2025-12-24T18:10:06 | {"marker": "O", "source": "secondary"} | O             |
|    | SYS-0035  | 2025-12-23T15:55:34 | {"marker": "C", "source": "secondary"} | C             |
|    | SYS-0010  | 2025-12-23T15:55:09 | {"marker": "L", "source": "secondary"} | L             |
|    | SYS-0037  | 2025-12-23T15:55:36 | {"marker": "D", "source": "secondary"} | D             |
+----+-----------+---------------------+----------------------------------------+---------------+
sqlite>
</code></pre></div><p>We have 4 columns.</p>
<ul>
<li>system_id</li>
<li>dispatched_at</li>
<li>payload (json string)</li>
<li>marker (its a generated table from the payload[&quot;marker&quot;] string)</li>
</ul>
<p>So, we need to group by system, that's where the <code>system_id</code> is for.</p>
<p>Then we need to order by <code>dispatched_at</code> with the latest ones.</p>
<p>Finally we also need to filter the records that has <code>payload[&quot;source&quot;]</code> as <code>primary</code>.</p>
<p>But wait, if we group by <code>system_id</code> then how can we get the latest dispatched ordered correctly? We can't use it in the <code>ORDER BY</code> as the group would have already been created right?</p>
<p>Oh! We might need window functions, but just a moment, can we do it without them?</p>
<p>Let's try.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT 
    system_id,
    MAX(dispatched_at),
    payload, 
    marker_letter
FROM system_dispatches
WHERE json_extract(payload, '$.source') = 'primary'
GROUP BY system_id
ORDER BY dispatched_at ASC;
</code></pre><div class="output"></div></div><p>Oh boy, that was simple!</p>
<p>We just grouped by <code>system_id</code>, filtered the source as <code>primary</code> and selected the row with <code>MAX(dispatched_at)</code> which will give us the latest dispatch record for a system. Boom!</p>
<p>The confirmation phrase is <code>ADVENTOFSQL</code></p>
<p>We can just select the <code>marker_letter</code></p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT
    marker_letter
FROM system_dispatches
WHERE json_extract(payload, '$.source') = 'primary'
GROUP BY system_id
ORDER BY dispatched_at ASC;
</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> SELECT
    marker_letter
FROM system_dispatches
WHERE json_extract(payload, '$.source') = 'primary'
GROUP BY system_id
ORDER BY dispatched_at ASC;
+---------------+
| marker_letter |
+---------------+
| X             |
| Y             |
| Z             |
| M             |
| P             |
| R             |
| K             |
| B             |
| U             |
| C             |
| J             |
+---------------+
sqlite>
</code></pre></div><p>Whops! What happened, the marker letter changed?</p>
<p>Yep, because we have ordered by <code>dispatched_at DESC</code> but never told how to return the rows, by using <code>MAX(dispatched_at)</code> we were selecting the latest date record. Without it, we are selecting the first record in the group that could be the first or the oldest dispatched_at time.</p>
<p>So, we need <code>MAX(dispatched_at)</code> included in the selected result set.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT
    marker_letter, MAX(dispatched_at)
FROM system_dispatches
WHERE json_extract(payload, '$.source') = 'primary'
GROUP BY system_id
ORDER BY dispatched_at ASC;
</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code> SELECT
    marker_letter, MAX(dispatched_at)
FROM system_dispatches
WHERE json_extract(payload, '$.source') = 'primary'
GROUP BY system_id
ORDER BY dispatched_at ASC;
+---------------+---------------------+
| marker_letter | MAX(dispatched_at)  |
+---------------+---------------------+
| A             | 2025-12-24T08:10:00 |
| D             | 2025-12-24T08:10:01 |
| V             | 2025-12-24T08:10:02 |
| E             | 2025-12-24T08:10:03 |
| N             | 2025-12-24T08:10:04 |
| T             | 2025-12-24T08:10:05 |
| O             | 2025-12-24T08:10:06 |
| F             | 2025-12-24T08:10:07 |
| S             | 2025-12-24T08:10:08 |
| Q             | 2025-12-24T08:10:09 |
| L             | 2025-12-24T08:10:10 |
+---------------+---------------------+
sqlite>
</code></pre></div><p>There, we go! It scared me for a moment.</p>
<p>We order by, only keep the <code>source</code> as <code>primary</code> and then select the latest <code>dispatched_at</code> for a given system_id.</p>
<p>If you don't want to do this way! I found a few more hacks</p>
<h3 id="with-subquery">With Subquery</h3>
<p>We can SELECT the <code>MAX(dispatched_at)</code> in a subquery for that system_id and filter based on the <code>primary</code> source as usual.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT 
    *
FROM system_dispatches
WHERE 
    json_extract(system_dispatches.payload, '$.source') = 'primary'
    AND system_dispatches.dispatched_at = (
        SELECT 
            MAX(latest_dispatches.dispatched_at)
        FROM system_dispatches latest_dispatches
        WHERE 
            latest_dispatches.system_id = system_dispatches.system_id
            AND json_extract(latest_dispatches.payload, '$.source') = 'primary'
   )
ORDER BY system_dispatches.dispatched_at ASC;
</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> SELECT 
    *
FROM system_dispatches
WHERE 
    json_extract(system_dispatches.payload, '$.source') = 'primary'
    AND system_dispatches.dispatched_at = (
        SELECT 
            MAX(latest_dispatches.dispatched_at)
        FROM system_dispatches latest_dispatches
        WHERE 
            latest_dispatches.system_id = system_dispatches.system_id
            AND json_extract(latest_dispatches.payload, '$.source') = 'primary'
   )
ORDER BY system_dispatches.dispatched_at ASC;

+----+-----------+---------------------+--------------------------------------+---------------+
| id | system_id |    dispatched_at    |               payload                | marker_letter |
+----+-----------+---------------------+--------------------------------------+---------------+
|    | SYS-0001  | 2025-12-24T08:10:00 | {"marker": "A", "source": "primary"} | A             |
|    | SYS-0002  | 2025-12-24T08:10:01 | {"marker": "D", "source": "primary"} | D             |
|    | SYS-0003  | 2025-12-24T08:10:02 | {"marker": "V", "source": "primary"} | V             |
|    | SYS-0004  | 2025-12-24T08:10:03 | {"marker": "E", "source": "primary"} | E             |
|    | SYS-0005  | 2025-12-24T08:10:04 | {"marker": "N", "source": "primary"} | N             |
|    | SYS-0006  | 2025-12-24T08:10:05 | {"marker": "T", "source": "primary"} | T             |
|    | SYS-0007  | 2025-12-24T08:10:06 | {"marker": "O", "source": "primary"} | O             |
|    | SYS-0008  | 2025-12-24T08:10:07 | {"marker": "F", "source": "primary"} | F             |
|    | SYS-0009  | 2025-12-24T08:10:08 | {"marker": "S", "source": "primary"} | S             |
|    | SYS-0010  | 2025-12-24T08:10:09 | {"marker": "Q", "source": "primary"} | Q             |
|    | SYS-0011  | 2025-12-24T08:10:10 | {"marker": "L", "source": "primary"} | L             |
+----+-----------+---------------------+--------------------------------------+---------------+
sqlite>
</code></pre></div><h3 id="window-funciton">Window Funciton</h3>
<p>We can even use the window function to partition by the <code>system_id</code> and there itself order by the <code>dispatched_at</code> latest time. And then select it as a CTE table.</p>
<p>We can use a <code>ROW_NUMBER</code> function to assign a rank to each row per system_id and ordered by the latest <code>dispatched_at</code></p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">WITH latest_dispatches AS (
    SELECT
        *,
        ROW_NUMBER() OVER (
            PARTITION BY system_id
            ORDER BY dispatched_at DESC
        ) as rank
    FROM system_dispatches
    WHERE json_extract(payload, '$.source') = 'primary'
) SELECT * FROM latest_dispatches WHERE rank = 1 ORDER BY dispatched_at ASC;
</code></pre><div class="output"></div></div><p>The rest is the same as the above query. We order by dispatched latest but then order by ascending (oldest first) in the final result set.</p>
<div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> WITH latest_dispatches AS (
    SELECT
        *,
        ROW_NUMBER() OVER (
            PARTITION BY system_id
            ORDER BY dispatched_at DESC
        ) as rank
    FROM system_dispatches
    WHERE json_extract(payload, '$.source') = 'primary'
) SELECT * FROM latest_dispatches WHERE rank = 1 ORDER BY dispatched_at ASC;
+----+-----------+---------------------+--------------------------------------+---------------+------+
| id | system_id |    dispatched_at    |               payload                | marker_letter | rank |
+----+-----------+---------------------+--------------------------------------+---------------+------+
|    | SYS-0001  | 2025-12-24T08:10:00 | {"marker": "A", "source": "primary"} | A             | 1    |
|    | SYS-0002  | 2025-12-24T08:10:01 | {"marker": "D", "source": "primary"} | D             | 1    |
|    | SYS-0003  | 2025-12-24T08:10:02 | {"marker": "V", "source": "primary"} | V             | 1    |
|    | SYS-0004  | 2025-12-24T08:10:03 | {"marker": "E", "source": "primary"} | E             | 1    |
|    | SYS-0005  | 2025-12-24T08:10:04 | {"marker": "N", "source": "primary"} | N             | 1    |
|    | SYS-0006  | 2025-12-24T08:10:05 | {"marker": "T", "source": "primary"} | T             | 1    |
|    | SYS-0007  | 2025-12-24T08:10:06 | {"marker": "O", "source": "primary"} | O             | 1    |
|    | SYS-0008  | 2025-12-24T08:10:07 | {"marker": "F", "source": "primary"} | F             | 1    |
|    | SYS-0009  | 2025-12-24T08:10:08 | {"marker": "S", "source": "primary"} | S             | 1    |
|    | SYS-0010  | 2025-12-24T08:10:09 | {"marker": "Q", "source": "primary"} | Q             | 1    |
|    | SYS-0011  | 2025-12-24T08:10:10 | {"marker": "L", "source": "primary"} | L             | 1    |
+----+-----------+---------------------+--------------------------------------+---------------+------+
sqlite>
</code></pre></div><p>Phew!</p>
<p>That was a good one to end the advent of SQL!</p>
<p>I enjoyed it!</p>
<p>I learnt a ton</p>
<ul>
<li>CTEs</li>
<li>JOINs (some wired stuff can be done)</li>
<li>Window Functions (LAG, LEAD, ROW_NUMBER)</li>
<li>FTS (in SQLite)</li>
<li>Json parsing</li>
<li>date shenanigans</li>
<li>CTEs don't support insert and delete in SQLite (it ruined my day 10 solution)</li>
<li>Recursive CTEs</li>
<li>String manipulation (thanks to xml parsing)</li>
<li>I need to write a post about explaining what I learned.</li>
</ul>
<p>Thanks <a href="https://aaronfrancis.com/">Aaron francis</a> from <a href="https://databaseschool.com/">databaseschool</a> for this challenge and explaining in depth on each day(i didn't watch all) and <a href="https://x.com/krpetrich">Kelsey Petrich</a> for the lore of each problem, those were really lovely to read!</p>
<p>Happy Coding :)
Merry Christmas
Happy New year
Whatever you celebrate!</p>

            </div>
        </article>
        
        
        

<nav class="post-navigation" aria-label="Post Navigation">
    <div class="nav-container">
        
        
        <a href="/sqlog/advent-of-sql-2025-day-14" class="nav-link nav-prev" title="Previous Post">
            <span class="nav-arrow"></span>
            <span class="nav-label">Previous</span>
            <span class="nav-title">Advent of SQL 2025 Day 14: Ski Resort Paths</span>
        </a>
        

        
        <div class="nav-link nav-next nav-empty"></div>
        
    </div>
</nav>


        
        
        


<aside class="related-reading" aria-labelledby="related-reading-title">
    <h3 id="related-reading-title" class="related-title"> Related Reading</h3>
    <ul class="related-list">
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-14" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 14: Ski Resort Paths</span>
                <span class="related-post-date">2025-12-28 15:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-13" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 13: XML Travel Manifests</span>
                <span class="related-post-date">2025-12-27 20:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-12" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 12: Archive Flight Records</span>
                <span class="related-post-date">2025-12-27 15:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-11" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 11: Behavior Score</span>
                <span class="related-post-date">2025-12-26 15:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-10" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 10: Misdelivered Presents</span>
                <span class="related-post-date">2025-12-25 15:30 &#43;0530</span>
            </a>
        </li>
        
        
    </ul>
</aside>


    </main>
    
    <div id="comments">
        <script src="https://giscus.app/client.js"
            data-repo="Mr-Destructive/meetgor.com"
            data-repo-id="R_kgDOHZ6V_g"
            data-category="Q&A"
            data-category-id="DIC_kwDOHZ6V_s4CRfn4"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="bottom"
            data-theme="dark_high_contrast"
            data-lang="en"
            crossorigin="anonymous"
            async>
        </script>
    </div>
    
    <footer class="site-footer" role="contentinfo">
  <div class="footer-content">
    <p>&copy; Meet Gor. All rights reserved.</p>
    <div class="social-links">
      <a href="/contact" aria-label="Connect with me">Connect with me</a>
    </div>
  </div>
</footer>
    
</body>
</html>
