<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <title>Turn Python dictionary into a neat CSV table | Meet Gor</title>
    <meta name="title" content="Turn Python dictionary into a neat CSV table | Meet Gor">
    <meta name="description" content="Exploring how to write python dict/key-value pairs and a table-like structure to a CSV file.">
    <meta name="author" content="Meet Gor">
    <meta name="keywords" content="python">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="meetgor.com/til/python-dict-to-csv-table">
    
    
    <meta property="og:type" content="article">
    <meta property="og:url" content="meetgor.com/til/python-dict-to-csv-table">
    <meta property="og:title" content="Turn Python dictionary into a neat CSV table | Meet Gor">
    <meta property="og:description" content="Exploring how to write python dict/key-value pairs and a table-like structure to a CSV file.">
    <meta property="og:image" content="meetgor.com/tbicon.png">
    <meta property="og:site_name" content="Meet Gor">
    <meta property="article:published_time" content="2024-03-20">
    <meta property="article:modified_time" content="2024-03-20">
    <meta property="article:author" content="Meet Gor">
    
    <meta property="article:tag" content="python">
    
    
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@meetgor711">
    <meta name="twitter:creator" content="@meetgor711">
    <meta name="twitter:url" content="meetgor.com/til/python-dict-to-csv-table">
    <meta name="twitter:title" content="Turn Python dictionary into a neat CSV table | Meet Gor">
    <meta name="twitter:description" content="Exploring how to write python dict/key-value pairs and a table-like structure to a CSV file.">
    <meta name="twitter:image" content="meetgor.com/tbicon.png">
    
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "meetgor.com/til\/python-dict-to-csv-table"
        },
        "headline": "Turn Python dictionary into a neat CSV table",
        "description": "Exploring how to write python dict\/key-value pairs and a table-like structure to a CSV file.",
        "datePublished": "2024-03-20",
        "dateModified": "2024-03-20",
        "author": {
            "@type": "Person",
            "name": "Meet Gor"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Meet Gor",
            "logo": {
                "@type": "ImageObject",
                "url": "meetgor.com/tbicon.png"
            }
        },
        
        "keywords": "python",
        "articleBody": "\u0026lt;h2 id=\u0026#34;populating-a-python-dict-having-a-table-like-structure-to-a-csv\u0026#34;\u0026gt;Populating a Python dict having a table-like structure to a CSV\u0026lt;\/h2\u0026gt;\n\u0026lt;p\u0026gt;Today, I want to share with you a neat trick I recently discovered for populating a CSV file with data in a table-like structure using Python.\u0026lt;\/p\u0026gt;\n\u0026lt;h3 id=\u0026#34;writing-key-value-pairs-to-a-csv-row\u0026#34;\u0026gt;Writing Key-Value Pairs to a CSV Row\u0026lt;\/h3\u0026gt;\n\u0026lt;p\u0026gt;Firstly, let\u0026#39;s discuss the \u0026lt;code\u0026gt;write_key_value\u0026lt;\/code\u0026gt; function. This function allows us to write key-value pairs to a CSV row. It\u0026#39;s particularly useful when dealing with metrics or data that can be represented as simple pairs.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;python\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-python\u0026#34;\u0026gt;# Function to populate a CSV row with key-value pairs\ndef write_key_value(writer, dictionary):\n    for key, value in dictionary.items():\n        writer.writerow([key, value])\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;h3 id=\u0026#34;writing-a-table-like-structure-to-a-csv-file\u0026#34;\u0026gt;Writing a Table-Like Structure to a CSV File\u0026lt;\/h3\u0026gt;\n\u0026lt;p\u0026gt;Now, let\u0026#39;s dive into the \u0026lt;code\u0026gt;write_table\u0026lt;\/code\u0026gt; function, which handles more complex scenarios where the data follows a table-like structure. This function takes into account different types of metrics and adjusts the CSV table structure accordingly.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Assuming you have a structure of the dictionary like:\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;python\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-python\u0026#34;\u0026gt;data = {\n    \u0026#34;Students\u0026#34;: {\n        \u0026#34;John Doe\u0026#34;: {\n            \u0026#34;course\u0026#34;: \u0026#34;Mathematics\u0026#34;,\n            \u0026#34;grade\u0026#34;: \u0026#34;A\u0026#34;,\n            \u0026#34;attendance\u0026#34;: 95,\n            \u0026#34;assignments_completed\u0026#34;: 15,\n            \u0026#34;student_id\u0026#34;: \u0026#34;JD001\u0026#34;\n        },\n        \u0026#34;Alice Smith\u0026#34;: {\n            \u0026#34;course\u0026#34;: \u0026#34;Physics\u0026#34;,\n            \u0026#34;grade\u0026#34;: \u0026#34;B\u002b\u0026#34;,\n            \u0026#34;attendance\u0026#34;: 85,\n            \u0026#34;assignments_completed\u0026#34;: 12,\n            \u0026#34;student_id\u0026#34;: \u0026#34;AS002\u0026#34;\n        },\n        \u0026#34;Bob Johnson\u0026#34;: {\n            \u0026#34;course\u0026#34;: \u0026#34;Computer Science\u0026#34;,\n            \u0026#34;grade\u0026#34;: \u0026#34;A-\u0026#34;,\n            \u0026#34;attendance\u0026#34;: 90,\n            \u0026#34;assignments_completed\u0026#34;: 14,\n            \u0026#34;student_id\u0026#34;: \u0026#34;BJ003\u0026#34;\n        }\n    }\n}\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;And you want to write it to a CSV file, like this:\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;csv\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-csv\u0026#34;\u0026gt;student, course, grade, attendance, assignments_completed, student_id\nJohn Doe, Mathematics, A, 95, 15, JD001\nAlice Smith, Physics, B\u002b, 85, 12, AS002\nBob Johnson, Computer Science, A-, 90, 14, BJ003\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;We can create a function \u0026lt;code\u0026gt;write_table\u0026lt;\/code\u0026gt; that will take in the \u0026lt;code\u0026gt;dictionary\u0026lt;\/code\u0026gt; as the actual data. We want to store the keys of the inner dictionary to be the header\/columns of the csv file. As we can see the keys of the inner dict i.e. the value for the key \u0026lt;code\u0026gt;John Doe\u0026lt;\/code\u0026gt; is a dict with the keys \u0026lt;code\u0026gt;course\u0026lt;\/code\u0026gt;, \u0026lt;code\u0026gt;grade\u0026lt;\/code\u0026gt;, \u0026lt;code\u0026gt;attendance\u0026lt;\/code\u0026gt;, etc. which remain the same for the all the keys in the dictionary.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;So, we can first create a \u0026lt;code\u0026gt;row_keys\u0026lt;\/code\u0026gt; variable to store the keys of the actual dictionary this will be the first column rows in the csv.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Further we check if the \u0026lt;code\u0026gt;row_keys\u0026lt;\/code\u0026gt; is a dict and then we append it with the \u0026lt;code\u0026gt;index_key\u0026lt;\/code\u0026gt; which will be the first column in the csv. Since all the keys remain the same for the inner-dict, we can pick the first dict and create the \u0026lt;code\u0026gt;header\u0026lt;\/code\u0026gt; with the inner-dict keys.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;So, we can write the list \u0026lt;code\u0026gt;header\u0026lt;\/code\u0026gt; to the csv file.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Then for each key in the \u0026lt;code\u0026gt;row_keys\u0026lt;\/code\u0026gt; we can create a list \u0026lt;code\u0026gt;row\u0026lt;\/code\u0026gt; with the key and the values of the inner-dict.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;python\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-python\u0026#34;\u0026gt;# Function to populate a CSV with a table-like structure\ndef write_table(writer, dictionary, index_key):\n\n    row_keys = list(dictionary.keys())\n\n    if row_keys and data[row_keys[0]] is not None:\n        headers = [index_key] \u002b list(\n            dictionary[row_keys[0]].keys()\n        )\n    else:\n        return\n    writer.writerow(headers)\n    for key in row_keys:\n        row = [key] \u002b list(dictionary[key].values())\n        writer.writerow(row)\n\n\nwith open(\u0026#39;data.csv\u0026#39;, \u0026#39;w\u0026#39;, newline=\u0026#39;\u0026#39;) as csvfile:\n    writer = csv.writer(csvfile)\n    for key in data:\n        write_table(writer, data[key], key)\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;h3 id=\u0026#34;example-usage\u0026#34;\u0026gt;Example Usage\u0026lt;\/h3\u0026gt;\n\u0026lt;p\u0026gt;To illustrate how these functions can be used, let\u0026#39;s consider a scenario where we have various types of metrics to populate into a CSV file. We handle key-value paired metrics separately and then populate the CSV with table-like metrics.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;python\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-python\u0026#34;\u0026gt;import csv\n\ndata = {\n    \u0026#34;Students\u0026#34;: {\n        \u0026#34;John Doe\u0026#34;: {\n            \u0026#34;course\u0026#34;: \u0026#34;Mathematics\u0026#34;,\n            \u0026#34;grade\u0026#34;: \u0026#34;A\u0026#34;,\n            \u0026#34;attendance\u0026#34;: 95,\n            \u0026#34;assignments_completed\u0026#34;: 15,\n            \u0026#34;student_id\u0026#34;: \u0026#34;JD001\u0026#34;\n        },\n        \u0026#34;Alice Smith\u0026#34;: {\n            \u0026#34;course\u0026#34;: \u0026#34;Physics\u0026#34;,\n            \u0026#34;grade\u0026#34;: \u0026#34;B\u002b\u0026#34;,\n            \u0026#34;attendance\u0026#34;: 85,\n            \u0026#34;assignments_completed\u0026#34;: 12,\n            \u0026#34;student_id\u0026#34;: \u0026#34;AS002\u0026#34;\n        },\n        \u0026#34;Bob Johnson\u0026#34;: {\n            \u0026#34;course\u0026#34;: \u0026#34;Computer Science\u0026#34;,\n            \u0026#34;grade\u0026#34;: \u0026#34;A-\u0026#34;,\n            \u0026#34;attendance\u0026#34;: 90,\n            \u0026#34;assignments_completed\u0026#34;: 14,\n            \u0026#34;student_id\u0026#34;: \u0026#34;BJ003\u0026#34;\n        }\n    },\n    \u0026#34;Countries\u0026#34;: {\n        \u0026#34;USA\u0026#34;: {\n            \u0026#34;capital\u0026#34;: \u0026#34;Washington, D.C.\u0026#34;,\n            \u0026#34;population\u0026#34;: 331000000,\n            \u0026#34;area_sq_km\u0026#34;: 9833517,\n            \u0026#34;official_languages\u0026#34;: [\u0026#34;English\u0026#34;, \u0026#34;Spanish\u0026#34;],\n            \u0026#34;currency\u0026#34;: \u0026#34;United States Dollar (USD)\u0026#34;\n        },\n        \u0026#34;India\u0026#34;: {\n            \u0026#34;capital\u0026#34;: \u0026#34;New Delhi\u0026#34;,\n            \u0026#34;population\u0026#34;: 1380004385,\n            \u0026#34;area_sq_km\u0026#34;: 3287263,\n            \u0026#34;official_languages\u0026#34;: [\u0026#34;Hindi\u0026#34;, \u0026#34;English\u0026#34;],\n            \u0026#34;currency\u0026#34;: \u0026#34;Indian Rupee (INR)\u0026#34;\n        },\n        \u0026#34;Brazil\u0026#34;: {\n            \u0026#34;capital\u0026#34;: \u0026#34;Brasília\u0026#34;,\n            \u0026#34;population\u0026#34;: 212559417,\n            \u0026#34;area_sq_km\u0026#34;: 8515770,\n            \u0026#34;official_languages\u0026#34;: [\u0026#34;Portuguese\u0026#34;],\n            \u0026#34;currency\u0026#34;: \u0026#34;Brazilian Real (BRL)\u0026#34;\n        }\n    }\n}\n\ndef populate_table(writer, data, index_key):\n    row_keys = list(data.keys())\n    if row_keys and data[row_keys[0]] is not None:\n        headers = [index_key] \u002b list(data[row_keys[0]].keys())\n    else:\n        return\n    writer.writerow(headers)\n    for key in row_keys:\n        row = [key] \u002b list(data[key].values())\n        writer.writerow(row)\n\n\nwith open(\u0026#39;data.csv\u0026#39;, \u0026#39;w\u0026#39;, newline=\u0026#39;\u0026#39;) as csvfile:\n    writer = csv.writer(csvfile)\n    for key in data:\n        populate_table(writer, data[key], key)\n        writer.writerow([])\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;csv\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-csv\u0026#34;\u0026gt;Students,course,grade,attendance,assignments_completed,student_id\nJohn Doe,Mathematics,A,95,15,JD001\nAlice Smith,Physics,B\u002b,85,12,AS002\nBob Johnson,Computer Science,A-,90,14,BJ003\n\nCountries,capital,population,area_sq_km,official_languages,currency\nUSA,\u0026#34;Washington, D.C.\u0026#34;,331000000,9833517,\u0026#34;[\u0026#39;English\u0026#39;, \u0026#39;Spanish\u0026#39;]\u0026#34;,United States Dollar (USD)\nIndia,New Delhi,1380004385,3287263,\u0026#34;[\u0026#39;Hindi\u0026#39;, \u0026#39;English\u0026#39;]\u0026#34;,Indian Rupee (INR)\nBrazil,Brasília,212559417,8515770,[\u0026#39;Portuguese\u0026#39;],Brazilian Real (BRL)\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Thank you, Happy Coding :)\u0026lt;\/p\u0026gt;\n"
    }
    </script>
    
    
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/code-block.css">
    
    <link rel="icon" href="/tbicon.png" type="image/png">
    <link rel="apple-touch-icon" href="/tbicon.png">
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link id="syntax-theme" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.13.0/sql-wasm.js"></script>
    <link rel="stylesheet" href="/sql-playground.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/monokai.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/sql/sql.min.js"></script>
    <script src="/sql-playground.js"></script>
    
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script>
    document.addEventListener("DOMContentLoaded", () => {
        const body = document.body;
        const stylesheet = document.getElementById("syntax-theme");
        const themeToggle = document.getElementById('theme-toggle');

        function setSyntaxTheme(theme) {
            if (theme === "secondary") {
                stylesheet.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css";
            } else {
                stylesheet.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css";
            }
        }

        
        document.querySelectorAll("pre code").forEach((block) => {
            hljs.highlightElement(block);
        });

        
        const currentTheme = localStorage.getItem("theme") || "default";
        if (currentTheme === "secondary") {
            body.classList.add("secondary-theme");
            if (themeToggle) themeToggle.checked = true;
        }
        setSyntaxTheme(currentTheme);

        
        if (themeToggle) {
            themeToggle.addEventListener('change', () => {
                const newTheme = themeToggle.checked ? 'secondary' : 'default';
                if (themeToggle.checked) {
                    body.classList.add('secondary-theme');
                } else {
                    body.classList.remove('secondary-theme');
                }
                localStorage.setItem('theme', newTheme);
                setSyntaxTheme(newTheme);
            });
        }
        
        
        const editBtn = document.getElementById('editor-edit');
        if (editBtn) {
            editBtn.addEventListener('click', async function () {
                const slug = "til\/python-dict-to-csv-table";
                const type = "til";
                console.log("Editing post:", slug, type);
                const url = "https:\/\/devmeetgor.netlify.app/.netlify/functions/api?slug=" + slug + "&method=edit&type=" + type;
                
                try {
                    const res = await fetch(url);
                    if (!res.ok) throw new Error("Failed to fetch edit content");
                    const html = await res.text();
                    document.querySelector('.post-content').innerHTML = html;
                } catch (err) {
                    console.error(err);
                    alert("Error loading editor content");
                }
            });
        }
    });
    </script>
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EET2ZX4QY1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-EET2ZX4QY1');
    </script>
</head>
<body>
    <header class="header">
  <a class="site-title" href="/" aria-label="Meet Gor - Home">Meet Gor</a>
  <nav>
    <ul>
      <li><a href="/" aria-label="Home">Home</a></li>
      <li><a href="/posts" aria-label="Posts">Posts</a></li>
      <li><a href="/about" aria-label="About">About</a></li>
      <li><a href="/contact" aria-label="Contact">Contact</a></li>
    </ul>
  </nav>
  <div class="theme-switch">
    <input type="checkbox" id="theme-toggle" aria-label="Toggle Theme">
    <label for="theme-toggle"></label>
  </div>
  
</header>
    
    <main class="container">
        <article class="blog-post">
            <h1>Turn Python dictionary into a neat CSV table</h1>
            
            <div class="post-meta">
                Published on 📅 <time datetime="2024-03-20">2024-03-20</time>
            </div>
            
            <div class="post-meta">
                Type: <a href="/til">til</a>
            </div>
            
            <div class="post-meta tags">
                <span class="post-series-label">🏷️ Tags:</span>
                
                <a href="/tags/python">#python</a>
                
            </div>
            
            
            
            
            
            <hr>
            
            <div class="post-content">
                <h2 id="populating-a-python-dict-having-a-table-like-structure-to-a-csv">Populating a Python dict having a table-like structure to a CSV</h2>
<p>Today, I want to share with you a neat trick I recently discovered for populating a CSV file with data in a table-like structure using Python.</p>
<h3 id="writing-key-value-pairs-to-a-csv-row">Writing Key-Value Pairs to a CSV Row</h3>
<p>Firstly, let's discuss the <code>write_key_value</code> function. This function allows us to write key-value pairs to a CSV row. It's particularly useful when dealing with metrics or data that can be represented as simple pairs.</p>
<div class="code-block"><div class="code-header"><span class="language-name">python</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-python"># Function to populate a CSV row with key-value pairs
def write_key_value(writer, dictionary):
    for key, value in dictionary.items():
        writer.writerow([key, value])
</code></pre></div><h3 id="writing-a-table-like-structure-to-a-csv-file">Writing a Table-Like Structure to a CSV File</h3>
<p>Now, let's dive into the <code>write_table</code> function, which handles more complex scenarios where the data follows a table-like structure. This function takes into account different types of metrics and adjusts the CSV table structure accordingly.</p>
<p>Assuming you have a structure of the dictionary like:</p>
<div class="code-block"><div class="code-header"><span class="language-name">python</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-python">data = {
    "Students": {
        "John Doe": {
            "course": "Mathematics",
            "grade": "A",
            "attendance": 95,
            "assignments_completed": 15,
            "student_id": "JD001"
        },
        "Alice Smith": {
            "course": "Physics",
            "grade": "B+",
            "attendance": 85,
            "assignments_completed": 12,
            "student_id": "AS002"
        },
        "Bob Johnson": {
            "course": "Computer Science",
            "grade": "A-",
            "attendance": 90,
            "assignments_completed": 14,
            "student_id": "BJ003"
        }
    }
}
</code></pre></div><p>And you want to write it to a CSV file, like this:</p>
<div class="code-block"><div class="code-header"><span class="language-name">csv</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-csv">student, course, grade, attendance, assignments_completed, student_id
John Doe, Mathematics, A, 95, 15, JD001
Alice Smith, Physics, B+, 85, 12, AS002
Bob Johnson, Computer Science, A-, 90, 14, BJ003
</code></pre></div><p>We can create a function <code>write_table</code> that will take in the <code>dictionary</code> as the actual data. We want to store the keys of the inner dictionary to be the header/columns of the csv file. As we can see the keys of the inner dict i.e. the value for the key <code>John Doe</code> is a dict with the keys <code>course</code>, <code>grade</code>, <code>attendance</code>, etc. which remain the same for the all the keys in the dictionary.</p>
<p>So, we can first create a <code>row_keys</code> variable to store the keys of the actual dictionary this will be the first column rows in the csv.</p>
<p>Further we check if the <code>row_keys</code> is a dict and then we append it with the <code>index_key</code> which will be the first column in the csv. Since all the keys remain the same for the inner-dict, we can pick the first dict and create the <code>header</code> with the inner-dict keys.</p>
<p>So, we can write the list <code>header</code> to the csv file.</p>
<p>Then for each key in the <code>row_keys</code> we can create a list <code>row</code> with the key and the values of the inner-dict.</p>
<div class="code-block"><div class="code-header"><span class="language-name">python</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-python"># Function to populate a CSV with a table-like structure
def write_table(writer, dictionary, index_key):

    row_keys = list(dictionary.keys())

    if row_keys and data[row_keys[0]] is not None:
        headers = [index_key] + list(
            dictionary[row_keys[0]].keys()
        )
    else:
        return
    writer.writerow(headers)
    for key in row_keys:
        row = [key] + list(dictionary[key].values())
        writer.writerow(row)


with open('data.csv', 'w', newline='') as csvfile:
    writer = csv.writer(csvfile)
    for key in data:
        write_table(writer, data[key], key)
</code></pre></div><h3 id="example-usage">Example Usage</h3>
<p>To illustrate how these functions can be used, let's consider a scenario where we have various types of metrics to populate into a CSV file. We handle key-value paired metrics separately and then populate the CSV with table-like metrics.</p>
<div class="code-block"><div class="code-header"><span class="language-name">python</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-python">import csv

data = {
    "Students": {
        "John Doe": {
            "course": "Mathematics",
            "grade": "A",
            "attendance": 95,
            "assignments_completed": 15,
            "student_id": "JD001"
        },
        "Alice Smith": {
            "course": "Physics",
            "grade": "B+",
            "attendance": 85,
            "assignments_completed": 12,
            "student_id": "AS002"
        },
        "Bob Johnson": {
            "course": "Computer Science",
            "grade": "A-",
            "attendance": 90,
            "assignments_completed": 14,
            "student_id": "BJ003"
        }
    },
    "Countries": {
        "USA": {
            "capital": "Washington, D.C.",
            "population": 331000000,
            "area_sq_km": 9833517,
            "official_languages": ["English", "Spanish"],
            "currency": "United States Dollar (USD)"
        },
        "India": {
            "capital": "New Delhi",
            "population": 1380004385,
            "area_sq_km": 3287263,
            "official_languages": ["Hindi", "English"],
            "currency": "Indian Rupee (INR)"
        },
        "Brazil": {
            "capital": "Brasília",
            "population": 212559417,
            "area_sq_km": 8515770,
            "official_languages": ["Portuguese"],
            "currency": "Brazilian Real (BRL)"
        }
    }
}

def populate_table(writer, data, index_key):
    row_keys = list(data.keys())
    if row_keys and data[row_keys[0]] is not None:
        headers = [index_key] + list(data[row_keys[0]].keys())
    else:
        return
    writer.writerow(headers)
    for key in row_keys:
        row = [key] + list(data[key].values())
        writer.writerow(row)


with open('data.csv', 'w', newline='') as csvfile:
    writer = csv.writer(csvfile)
    for key in data:
        populate_table(writer, data[key], key)
        writer.writerow([])
</code></pre></div><div class="code-block"><div class="code-header"><span class="language-name">csv</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-csv">Students,course,grade,attendance,assignments_completed,student_id
John Doe,Mathematics,A,95,15,JD001
Alice Smith,Physics,B+,85,12,AS002
Bob Johnson,Computer Science,A-,90,14,BJ003

Countries,capital,population,area_sq_km,official_languages,currency
USA,"Washington, D.C.",331000000,9833517,"['English', 'Spanish']",United States Dollar (USD)
India,New Delhi,1380004385,3287263,"['Hindi', 'English']",Indian Rupee (INR)
Brazil,Brasília,212559417,8515770,['Portuguese'],Brazilian Real (BRL)
</code></pre></div><p>Thank you, Happy Coding :)</p>

            </div>
        </article>
    </main>
    
    <div id="comments">
        <script src="https://giscus.app/client.js"
            data-repo="Mr-Destructive/meetgor.com"
            data-repo-id="R_kgDOHZ6V_g"
            data-category="Q&A"
            data-category-id="DIC_kwDOHZ6V_s4CRfn4"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="bottom"
            data-theme="dark_high_contrast"
            data-lang="en"
            crossorigin="anonymous"
            async>
        </script>
    </div>
    
    <footer class="site-footer" role="contentinfo">
  <div class="footer-content">
    <p>&copy; Meet Gor. All rights reserved.</p>
    <div class="social-links">
      <a href="/contact" aria-label="Connect with me">Connect with me</a>
    </div>
  </div>
</footer>
    
</body>
</html>
