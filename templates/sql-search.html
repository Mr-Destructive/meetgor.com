<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Search</title>
    <link rel="stylesheet" type="text/css" href="/style.css">
    <link rel="stylesheet" href="/code-block.css">
    <link rel="icon" href="/tbicon.png" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/theme/material-darker.min.css">
    <style>
        #sql-editor {
            border: 1px solid var(--border-color);
            border-radius: 6px;
            overflow: hidden;
        }
        
        #run-query {
            background-color: var(--link-normal);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.2s ease;
        }
        
        #run-query:hover {
            background-color: var(--link-hover);
        }
        
        .sql-result-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            background-color: var(--bg-color);
        }
        
        .sql-result-header {
            background-color: rgba(0, 0, 0, 0.05);
            padding: 0.75rem;
            text-align: left;
            border: 1px solid var(--border-color);
            color: var(--text-color);
            font-weight: bold;
        }
        
        .secondary-theme .sql-result-header {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .sql-result-cell {
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }
        
        #results-container {
            margin-top: 1rem;
        }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const themeToggle = document.getElementById('theme-toggle');
            const body = document.body;

            const currentTheme = localStorage.getItem('theme') || 'light';

            if (currentTheme === 'secondary') {
                body.classList.add('secondary-theme');
            }

            themeToggle.addEventListener('click', () => {
                if (body.classList.contains('secondary-theme')) {
                    body.classList.remove('secondary-theme');
                    localStorage.setItem('theme', 'light');
                } else {
                    body.classList.add('secondary-theme');
                    localStorage.setItem('theme', 'secondary');
                }
            });
        });
    </script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EET2ZX4QY1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-EET2ZX4QY1');
    </script>
</head>
<body>
    <header class="header">
        <h1 class="site-title"><a href="/{{ .Config.Blog.PrefixURL }}">{{ .Config.Blog.Name }}</a></h1>
        <nav class="main-nav">
            <ul>
                <li><a href="/{{ .Config.Blog.PrefixURL }}">Home</a></li>
                <li><a href="/{{ .Config.Blog.PrefixURL }}posts">Posts</a></li>
                <li><a href="/{{ .Config.Blog.PrefixURL }}about">About</a></li>
                <li><a href="/{{ .Config.Blog.PrefixURL }}contact">Contact</a></li>
                <li><a href="/{{ .Config.Blog.PrefixURL }}now">Now</a></li>
                <li><a href="/{{ .Config.Blog.PrefixURL }}sql-search">Search</a></li>
            </ul>
        </nav>
        <div class="theme-switch">
            <input type="checkbox" id="theme-toggle" aria-label="Toggle Theme">
            <label for="theme-toggle"></label>
        </div>
    </header>

    <main class="container">
        <h1 class="text-3xl font-bold mb-4">SQL Search</h1>
        <p class="text-lg mb-6">Query the site's content using SQL. The following tables are available:</p>
        <ul class="list-disc list-inside mb-6">
            <li><b>posts</b>: `title`, `date`, `tags`, `content`, `description`, `series`, `status`, `slug`</li>
            <li><b>tils</b>: `title`, `date`, `tags`, `content`, `description`, `series`, `status`, `slug`</li>
            <li><b>newsletter</b>: `title`, `date`, `tags`, `content`, `description`, `series`, `status`, `slug`</li>
            <li><b>work</b>: `title`, `date`, `tags`, `content`, `description`, `series`, `status`, `slug`</li>
            <li><b>projects</b>: `title`, `date`, `tags`, `content`, `description`, `series`, `status`, `slug`</li>
            <li><b>all_posts</b>: `title`, `date`, `tags`, `content`, `description`, `series`, `status`, `slug` (combines all content types)</li>
        </ul>
        <p class="text-lg mb-6">Example queries:</p>
        <pre class="bg-gray-100 p-4 rounded-lg mb-4"><code>SELECT title, date FROM tils ORDER BY date DESC LIMIT 5;</code></pre>
        <pre class="bg-gray-100 p-4 rounded-lg mb-4"><code>SELECT title, tags FROM projects WHERE tags LIKE '%python%';</code></pre>
        <pre class="bg-gray-100 p-4 rounded-lg mb-4"><code>SELECT * FROM newsletter WHERE title LIKE '%weekly%';</code></pre>
        <div id="sql-editor" class="border border-gray-300 rounded-lg mb-4" style="height: 200px;"></div>
        <button id="run-query" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Run Query</button>
        <div id="results-container" class="mt-8"></div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; {{ .Config.Blog.Name }}. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.13.0/sql-wasm.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/sql/sql.min.js"></script>
    <script src="/static/js/sql-search.js" defer></script>
</body>
</html>

