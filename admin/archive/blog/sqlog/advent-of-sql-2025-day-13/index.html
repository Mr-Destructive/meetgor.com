<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <title>Advent of SQL 2025 Day 13: XML Travel Manifests | Meet Gor</title>
    <meta name="title" content="Advent of SQL 2025 Day 13: XML Travel Manifests | Meet Gor">
    <meta name="description" content="">
    <meta name="author" content="Meet Gor">
    <meta name="keywords" content="sqlite, sql, advent-of-sql">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://meetgor.com/sqlog/advent-of-sql-2025-day-13">
    
    
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://meetgor.com/sqlog/advent-of-sql-2025-day-13">
    <meta property="og:title" content="Advent of SQL 2025 Day 13: XML Travel Manifests">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://meetgor.com/tbicon.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Advent of SQL 2025 Day 13: XML Travel Manifests">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Meet Gor">
    <meta property="article:published_time" content="2025-12-27 20:30 &#43;0530">
    <meta property="article:modified_time" content="2025-12-27 20:30 &#43;0530">
    <meta property="article:author" content="Meet Gor">
    
    <meta property="article:tag" content="sqlite">
    
    <meta property="article:tag" content="sql">
    
    <meta property="article:tag" content="advent-of-sql">
    
    
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@meetgor711">
    <meta name="twitter:creator" content="@meetgor711">
    <meta name="twitter:url" content="https://meetgor.com/sqlog/advent-of-sql-2025-day-13">
    <meta name="twitter:title" content="Advent of SQL 2025 Day 13: XML Travel Manifests">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="https://meetgor.com/tbicon.png">
    <meta name="twitter:image:alt" content="Advent of SQL 2025 Day 13: XML Travel Manifests">
    
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/meetgor.com/sqlog\/advent-of-sql-2025-day-13"
        },
        "headline": "Advent of SQL 2025 Day 13: XML Travel Manifests",
        "description": "",
        "datePublished": "2025-12-27 20:30 \u002b0530",
        "dateModified": "2025-12-27 20:30 \u002b0530",
        "author": {
            "@type": "Person",
            "name": "Meet Gor"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Meet Gor",
            "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/meetgor.com/tbicon.png"
            }
        },
        
        "keywords": "sqlite, sql, advent-of-sql",
        "articleBody": "\u0026lt;h2 id=\u0026#34;advent-of-sql---day-13-xml-travel-manifests\u0026#34;\u0026gt;Advent of SQL - Day 13, XML Travel Manifests\u0026lt;\/h2\u0026gt;\n\u0026lt;p\u0026gt;Its day 13 of Advent of SQL, we have some xml to parse, which I don\u0026#39;t think SQL can handle, but string manipulation to the rescue.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s get the SQL for the day:\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;DROP TABLE IF EXISTS travel_manifests;\n\nCREATE TABLE travel_manifests (\n    manifest_id INT PRIMARY KEY,\n    vehicle_id TEXT,\n    departure_time TIMESTAMP,\n    manifest_xml XML\n);\n\nINSERT INTO travel_manifests (manifest_id, vehicle_id, departure_time, manifest_xml) VALUES\n  (1, \u0026#39;SLEIGH-01\u0026#39;, \u0026#39;2025-12-22 06:00:00\u0026#39;, \u0026#39;\u0026lt;manifest\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Nia Grant\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Sofia Kim\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;engine_check\u0026gt;ignored\u0026lt;\/engine_check\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Jonah Wolfe\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;snack_inventory\u0026gt;ignored\u0026lt;\/snack_inventory\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;\u0026#39;),\n  (2, \u0026#39;SLEIGH-07\u0026#39;, \u0026#39;2025-12-23 13:00:00\u0026#39;, \u0026#39;\u0026lt;manifest\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Ravi Patel\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Keiko Ito\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Anya Pavlov\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Nia Grant\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;snack_inventory\u0026gt;ignored\u0026lt;\/snack_inventory\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Carter Lewis\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;engine_check\u0026gt;ignored\u0026lt;\/engine_check\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Layla Brooks\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;reindeer_mood\u0026gt;ignored\u0026lt;\/reindeer_mood\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;\u0026#39;),\n  (3, \u0026#39;FLIGHT-NP-9\u0026#39;, \u0026#39;2025-12-22 18:00:00\u0026#39;, \u0026#39;\u0026lt;manifest\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Keiko Ito\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Jonah Wolfe\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Diego Ramos\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;snack_inventory\u0026gt;ignored\u0026lt;\/snack_inventory\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Priya Das\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Layla Brooks\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;\u0026#39;),\n  (4, \u0026#39;TRAIN-ICE-3\u0026#39;, \u0026#39;2025-12-22 18:00:00\u0026#39;, \u0026#39;\u0026lt;manifest\u0026gt;\u0026lt;reindeer_mood\u0026gt;low\u0026lt;\/reindeer_mood\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Isla Torres\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Ravi Patel\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Hiro Tanaka\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Priya Das\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;\u0026#39;),\n  (5, \u0026#39;FLIGHT-NP-9\u0026#39;, \u0026#39;2025-12-22 17:00:00\u0026#39;, \u0026#39;\u0026lt;manifest\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Nia Grant\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Mateo Cruz\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;snowfall_inches\u0026gt;ignored\u0026lt;\/snowfall_inches\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;\u0026#39;),\n  (6, \u0026#39;CARGO-12\u0026#39;, \u0026#39;2025-12-22 15:00:00\u0026#39;, \u0026#39;\u0026lt;manifest\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Carter Lewis\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Sofia Kim\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Hiro Tanaka\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Lucas Ford\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;snack_inventory\u0026gt;ignored\u0026lt;\/snack_inventory\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Nia Grant\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;\u0026#39;),\n  (7, \u0026#39;SLEIGH-01\u0026#39;, \u0026#39;2025-12-22 11:00:00\u0026#39;, \u0026#39;\u0026lt;manifest\u0026gt;\u0026lt;snack_inventory\u0026gt;unknown\u0026lt;\/snack_inventory\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Priya Das\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Diego Ramos\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Lucas Ford\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Carter Lewis\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;reindeer_mood\u0026gt;ignored\u0026lt;\/reindeer_mood\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Hiro Tanaka\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;weather_note\u0026gt;ignored\u0026lt;\/weather_note\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Zara Sheikh\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;\u0026#39;),\n  (8, \u0026#39;CARGO-12\u0026#39;, \u0026#39;2025-12-23 13:00:00\u0026#39;, \u0026#39;\u0026lt;manifest\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Jonah Wolfe\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Layla Brooks\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Leo Becker\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;weather_note\u0026gt;ignored\u0026lt;\/weather_note\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Ravi Patel\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Sofia Kim\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;snack_inventory\u0026gt;ignored\u0026lt;\/snack_inventory\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Elena Morales\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;\u0026#39;),\n  (9, \u0026#39;SLEIGH-01\u0026#39;, \u0026#39;2025-12-23 10:00:00\u0026#39;, \u0026#39;\u0026lt;manifest\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Sofia Kim\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Bianca Pereira\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Zara Sheikh\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Elena Morales\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;reindeer_mood\u0026gt;ignored\u0026lt;\/reindeer_mood\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Hiro Tanaka\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Keiko Ito\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;snack_inventory\u0026gt;ignored\u0026lt;\/snack_inventory\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;\u0026#39;),\n  (10, \u0026#39;SLEIGH-01\u0026#39;, \u0026#39;2025-12-22 21:00:00\u0026#39;, \u0026#39;\u0026lt;manifest\u0026gt;\u0026lt;snowfall_inches\u0026gt;low\u0026lt;\/snowfall_inches\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Nia Grant\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Ava Johnson\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Priya Das\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Mateo Cruz\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Bianca Pereira\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Leo Becker\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;\u0026#39;),\n  (11, \u0026#39;SLEIGH-07\u0026#39;, \u0026#39;2025-12-23 10:00:00\u0026#39;, \u0026#39;\u0026lt;manifest\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Jonah Wolfe\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Bianca Pereira\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Anya Pavlov\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;\u0026#39;),\n  (12, \u0026#39;SLEIGH-01\u0026#39;, \u0026#39;2025-12-22 08:00:00\u0026#39;, \u0026#39;\u0026lt;manifest\u0026gt;\u0026lt;reindeer_mood\u0026gt;ok\u0026lt;\/reindeer_mood\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Ravi Patel\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;snack_inventory\u0026gt;ignored\u0026lt;\/snack_inventory\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Bianca Pereira\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Keiko Ito\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;\u0026#39;),\n  (13, \u0026#39;FLIGHT-NP-9\u0026#39;, \u0026#39;2025-12-22 11:00:00\u0026#39;, \u0026#39;\u0026lt;manifest\u0026gt;\u0026lt;snowfall_inches\u0026gt;ok\u0026lt;\/snowfall_inches\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Nia Grant\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Elena Morales\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;\u0026#39;),\n  (14, \u0026#39;SLEIGH-01\u0026#39;, \u0026#39;2025-12-22 14:00:00\u0026#39;, \u0026#39;\u0026lt;manifest\u0026gt;\u0026lt;engine_check\u0026gt;high\u0026lt;\/engine_check\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Layla Brooks\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;weather_note\u0026gt;ignored\u0026lt;\/weather_note\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Anya Pavlov\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Keiko Ito\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Zara Sheikh\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;engine_check\u0026gt;ignored\u0026lt;\/engine_check\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Sofia Kim\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;\u0026#39;),\n  (15, \u0026#39;FLIGHT-NP-9\u0026#39;, \u0026#39;2025-12-22 14:00:00\u0026#39;, \u0026#39;\u0026lt;manifest\u0026gt;\u0026lt;snowfall_inches\u0026gt;ok\u0026lt;\/snowfall_inches\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Priya Das\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;priority\u0026lt;\/ticket_class\u0026gt;\u0026lt;snowfall_inches\u0026gt;ignored\u0026lt;\/snowfall_inches\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Bianca Pereira\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Nia Grant\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;\u0026#39;);\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Just one table, with some wild XML.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s see what do we want to do in the problem statement.\u0026lt;\/p\u0026gt;\n\u0026lt;h2 id=\u0026#34;problem\u0026#34;\u0026gt;Problem\u0026lt;\/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Using the \u0026lt;code\u0026gt;travel_manifests\u0026lt;\/code\u0026gt; table, extract the passenger information from the XML data and produce a report that shows all of the departure times for \u0026amp;quot;CARGO\u0026amp;quot; vehicles that have more than 20 passengers booked. Include in the results:\u0026lt;\/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;The vehicle_id\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;The departure_time\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;The total number of passengers on that departure\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;Order the results by departure_time.\u0026lt;\/li\u0026gt;\n\u0026lt;\/ul\u0026gt;\n\u0026lt;\/blockquote\u0026gt;\n\u0026lt;p\u0026gt;Ok, so we need the number of passengers in the records which are of type \u0026lt;code\u0026gt;CARGO\u0026lt;\/code\u0026gt; and have more than 20 passengers booked.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Interesting!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s look at one record.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; .schema\nCREATE TABLE travel_manifests (\n    manifest_id INT PRIMARY KEY,\n    vehicle_id TEXT,\n    departure_time TIMESTAMP,\n    manifest_xml XML\n);\nsqlite\u0026gt; SELECT * FROM travel_manifests WHERE id = 1;\nParse error: no such column: id\n  SELECT * FROM travel_manifests WHERE id = 1;\n                         error here ---^\nsqlite\u0026gt; SELECT * FROM travel_manifests LIMIT 1;\n\u002b-------------\u002b------------\u002b---------------------\u002b--------------------------------------------------------------\u002b\n| manifest_id | vehicle_id |   departure_time    |                         manifest_xml                         |\n\u002b-------------\u002b------------\u002b---------------------\u002b--------------------------------------------------------------\u002b\n| 1           | SLEIGH-01  | 2025-12-22 06:00:00 | \u0026lt;manifest\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Nia Grant\u0026lt;\/name\u0026gt;\u0026lt;tick |\n|             |            |                     | et_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;nam |\n|             |            |                     | e\u0026gt;Sofia Kim\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;eng |\n|             |            |                     | ine_check\u0026gt;ignored\u0026lt;\/engine_check\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name |\n|             |            |                     | \u0026gt;Jonah Wolfe\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;sna |\n|             |            |                     | ck_inventory\u0026gt;ignored\u0026lt;\/snack_inventory\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passenge |\n|             |            |                     | rs\u0026gt;\u0026lt;\/manifest\u0026gt;                                               |\n\u002b-------------\u002b------------\u002b---------------------\u002b--------------------------------------------------------------\u002b\nsqlite\u0026gt; \n\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;So, we have the following columns\u0026lt;\/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;vehicle_id\u0026lt;\/code\u0026gt; which is I think related to filtering \u0026lt;code\u0026gt;CARGO\u0026lt;\/code\u0026gt; related vehicles only\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;departure_time\u0026lt;\/code\u0026gt; which we just return as is\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;manifest_xml\u0026lt;\/code\u0026gt;, oh! This is xml and it has passenger details.\u0026lt;\/li\u0026gt;\n\u0026lt;\/ul\u0026gt;\n\u0026lt;p\u0026gt;If we look carefully, we can see the xml looks like this:\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;xml\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-xml\u0026#34;\u0026gt;\u0026lt;manifest\u0026gt;\n    \u0026lt;passengers\u0026gt;\n        \u0026lt;passenger\u0026gt;\n            \u0026lt;name\u0026gt;Nia Grant\u0026lt;\/name\u0026gt; \n           \u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\n        \u0026lt;\/passenger\u0026gt;\n        \u0026lt;passenger\u0026gt;\n            \u0026lt;name\u0026gt;Sofia Kim\u0026lt;\/name\u0026gt; \n           \u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\n           \u0026lt;engine_check\u0026gt;ignored\u0026lt;\/engine_check\u0026gt;\n       \u0026lt;\/passenger\u0026gt;\n       \u0026lt;passenger\u0026gt;\n           \u0026lt;name\u0026gt;Jonah Wolfe\u0026lt;\/name\u0026gt;\n           \u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\n           \u0026lt;snack_inventory\u0026gt;ignored\u0026lt;\/snack_inventory\u0026gt;\n       \u0026lt;\/passenger\u0026gt;\n    \u0026lt;\/passengers\u0026gt;\n\u0026lt;\/manifest\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;We have \u0026lt;code\u0026gt;manifest\u0026lt;\/code\u0026gt; which has a property of \u0026lt;code\u0026gt;passengers\u0026lt;\/code\u0026gt; which is a list of \u0026lt;code\u0026gt;passenger\u0026lt;\/code\u0026gt; tags, inside of which, each element of \u0026lt;code\u0026gt;passenger\u0026lt;\/code\u0026gt; has its details like \u0026lt;code\u0026gt;name\u0026lt;\/code\u0026gt;, \u0026lt;code\u0026gt;ticket_class\u0026lt;\/code\u0026gt;, etc.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We only want the count of \u0026lt;code\u0026gt;passengers\u0026lt;\/code\u0026gt;, how can we get that? The dirtiest way to do is to count the occurances of \u0026lt;code\u0026gt;\u0026amp;lt;passenger\u0026amp;gt;\u0026lt;\/code\u0026gt; or \u0026lt;code\u0026gt;\u0026amp;lt;\/passenger\u0026amp;gt;\u0026lt;\/code\u0026gt; in the xml string.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We can do that with counting the full length of the xml string, and then dividing by the number of times the string can be replaced(which is the dirty part, there could be hidden \u0026lt;code\u0026gt;\u0026amp;lt;passenger\u0026amp;gt;\u0026lt;\/code\u0026gt; string somewhere that might break this logic, but if it is a valid xml, it works). We count the number of characters left after we replace the string \u0026lt;code\u0026gt;\u0026amp;lt;passenger\u0026amp;gt;\u0026lt;\/code\u0026gt; with empty string \u0026lt;code\u0026gt;\u0026#39;\u0026#39;\u0026lt;\/code\u0026gt; so that we can get the difference of the total number of character and the number of characters occupied by the string \u0026lt;code\u0026gt;\u0026amp;lt;passenger\u0026amp;gt;\u0026lt;\/code\u0026gt;. This difference if we divide by the length of \u0026lt;code\u0026gt;\u0026amp;lt;passenger\u0026amp;gt;\u0026lt;\/code\u0026gt; will give us the count of the number of times the \u0026lt;code\u0026gt;\u0026amp;lt;passenger\u0026amp;gt;\u0026lt;\/code\u0026gt; string is present in the xml string.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s take an example from the above. The length of the xml string is 374.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT LENGTH(manifest_xml) FROM travel_manifests LIMIT 1;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; SELECT LENGTH(manifest_xml) FROM travel_manifests LIMIT 1;\n\u002b----------------------\u002b\n| LENGTH(manifest_xml) |\n\u002b----------------------\u002b\n| 374                  |\n\u002b----------------------\u002b\nsqlite\u0026gt; \n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Let\u0026#39;s replace the occurances of \u0026lt;code\u0026gt;\u0026amp;lt;passenger\u0026amp;gt; with empty string in the \u0026lt;\/code\u0026gt;manifest_xml\u0060 string, like so:\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT REPLACE(manifest_xml, \u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;, \u0026#39;\u0026#39;) FROM travel_manifests LIMIT 1;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Now, we can see the string \u0026lt;code\u0026gt;\u0026amp;lt;passenger\u0026amp;gt;\u0026lt;\/code\u0026gt; is gone from the returned result set. We can try getting its length now.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT \n    LENGTH(\n        REPLACE(manifest_xml, \u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;, \u0026#39;\u0026#39;)\n    )\nFROM travel_manifests LIMIT 1;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Now, it says \u0026lt;code\u0026gt;341\u0026lt;\/code\u0026gt; why? Because we removed (replaced with empty string) the occurences of \u0026lt;code\u0026gt;\u0026amp;lt;passenger\u0026amp;gt;\u0026lt;\/code\u0026gt;.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s get the length of \u0026lt;code\u0026gt;\u0026#39;\u0026amp;lt;passenger\u0026amp;gt;\u0026#39;\u0026lt;\/code\u0026gt; string, which should be \u0026lt;code\u0026gt;11\u0026lt;\/code\u0026gt; right?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Spell it \u0026lt;code\u0026gt;p-a-s-s-e-n-g-e-r\u0026lt;\/code\u0026gt; as \u0026lt;code\u0026gt;pass\u0026lt;\/code\u0026gt; \u002b \u0026lt;code\u0026gt;enger\u0026lt;\/code\u0026gt; (4\u002b5=9) and 2 for \u0026lt;code\u0026gt;\u0026amp;lt;\u0026amp;gt;\u0026lt;\/code\u0026gt; so 11. Sometimes I don\u0026#39;t know how to do math, I use SQL.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT LENGTH(\u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;);\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;There it is \u0026lt;code\u0026gt;11\u0026lt;\/code\u0026gt;.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Now, if you compute the difference of the actual length of XML with the removed parts of the \u0026lt;code\u0026gt;\u0026amp;lt;passenger\u0026amp;gt;\u0026lt;\/code\u0026gt; what do we get?\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT LENGTH(manifest_xml) - LENGTH(REPLACE(manifest_xml, \u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;, \u0026#39;\u0026#39;)) FROM travel_manifests LIMIT 1;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;WE got \u0026lt;code\u0026gt;33\u0026lt;\/code\u0026gt;, why would you ask because \u0026lt;code\u0026gt;11\u0026lt;\/code\u0026gt; times 3 is \u0026lt;code\u0026gt;33\u0026lt;\/code\u0026gt;. We found three instances of \u0026lt;code\u0026gt;\u0026amp;lt;passenger\u0026amp;gt;\u0026lt;\/code\u0026gt;,  so we just need to divide by the length of \u0026lt;code\u0026gt;\u0026amp;lt;passenger\u0026amp;gt;\u0026lt;\/code\u0026gt; or hard code it as \u0026lt;code\u0026gt;11\u0026lt;\/code\u0026gt; doesn\u0026#39;t matter.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We would get the number of occurances of \u0026lt;code\u0026gt;\u0026amp;lt;passenger\u0026amp;gt;\u0026lt;\/code\u0026gt; which will give the number of passenger in the xml string.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT\n    (\n        LENGTH(manifest_xml) - LENGTH(REPLACE(manifest_xml, \u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;, \u0026#39;\u0026#39;))\n    ) \/ LENGTH(\u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;)\nFROM travel_manifests LIMIT 1;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Phew, its \u0026lt;code\u0026gt;3\u0026lt;\/code\u0026gt;!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;That was a lot for a simple stuff. But hey its fun!\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; SELECT (manifest_xml) FROM travel_manifests LIMIT 1;\n\u002b--------------------------------------------------------------\u002b\n|                         manifest_xml                         |\n\u002b--------------------------------------------------------------\u002b\n| \u0026lt;manifest\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name\u0026gt;Nia Grant\u0026lt;\/name\u0026gt;\u0026lt;tick |\n| et_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;nam |\n| e\u0026gt;Sofia Kim\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;eng |\n| ine_check\u0026gt;ignored\u0026lt;\/engine_check\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;passenger\u0026gt;\u0026lt;name |\n| \u0026gt;Jonah Wolfe\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;sna |\n| ck_inventory\u0026gt;ignored\u0026lt;\/snack_inventory\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passenge |\n| rs\u0026gt;\u0026lt;\/manifest\u0026gt;                                               |\n\u002b--------------------------------------------------------------\u002b\n\nsqlite\u0026gt; SELECT REPLACE(manifest_xml, \u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;, \u0026#39;\u0026#39;) FROM travel_manifests LIMIT 1;\n\u002b--------------------------------------------------------------\u002b\n|           REPLACE(manifest_xml, \u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;, \u0026#39;\u0026#39;)           |\n\u002b--------------------------------------------------------------\u002b\n| \u0026lt;manifest\u0026gt;\u0026lt;passengers\u0026gt;\u0026lt;name\u0026gt;Nia Grant\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt;ov |\n| ernight\u0026lt;\/ticket_class\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;name\u0026gt;Sofia Kim\u0026lt;\/name\u0026gt;\u0026lt;tic |\n| ket_class\u0026gt;overnight\u0026lt;\/ticket_class\u0026gt;\u0026lt;engine_check\u0026gt;ignored\u0026lt;\/eng |\n| ine_check\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;name\u0026gt;Jonah Wolfe\u0026lt;\/name\u0026gt;\u0026lt;ticket_class\u0026gt; |\n| standard\u0026lt;\/ticket_class\u0026gt;\u0026lt;snack_inventory\u0026gt;ignored\u0026lt;\/snack_inven |\n| tory\u0026gt;\u0026lt;\/passenger\u0026gt;\u0026lt;\/passengers\u0026gt;\u0026lt;\/manifest\u0026gt;                    |\n\u002b--------------------------------------------------------------\u002b\nsqlite\u0026gt; \nsqlite\u0026gt; SELECT LENGTH(REPLACE(manifest_xml, \u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;, \u0026#39;\u0026#39;)) FROM travel_manifests LIMIT 1;\n\u002b--------------------------------------------------\u002b\n| LENGTH(REPLACE(manifest_xml, \u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;, \u0026#39;\u0026#39;)) |\n\u002b--------------------------------------------------\u002b\n| 341                                              |\n\u002b--------------------------------------------------\u002b\nsqlite\u0026gt; SELECT LENGTH(manifest_xml) - LENGTH(REPLACE(manifest_xml, \u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;, \u0026#39;\u0026#39;)) FROM travel_manifests LIMIT 1;\n\u002b--------------------------------------------------------------\u002b\n| LENGTH(manifest_xml) - LENGTH(REPLACE(manifest_xml, \u0026#39;\u0026lt;passen |\n\u002b--------------------------------------------------------------\u002b\n| 33                                                           |\n\u002b--------------------------------------------------------------\u002b\nsqlite\u0026gt; SELECT LENGTH(\u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;) FROM travel_manifests LIMIT 1;\n\u002b-----------------------\u002b\n| LENGTH(\u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;) |\n\u002b-----------------------\u002b\n| 11                    |\n\u002b-----------------------\u002b\n\nsqlite\u0026gt; SELECT (LENGTH(manifest_xml) - LENGTH(REPLACE(manifest_xml, \u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;, \u0026#39;\u0026#39;)))\/LENGTH(\u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;) FROM travel_manifests LIMIT 1;\n\u002b--------------------------------------------------------------\u002b\n| (LENGTH(manifest_xml) - LENGTH(REPLACE(manifest_xml, \u0026#39;\u0026lt;passe |\n\u002b--------------------------------------------------------------\u002b\n| 3                                                            |\n\u002b--------------------------------------------------------------\u002b\nsqlite\u0026gt; \n\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Now, let construct the query to get the number of passengers.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT\n    vehicle_id,\n    departure_time,\n    (\n        LENGTH(manifest_xml)\n        - LENGTH(REPLACE(manifest_xml, \u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;, \u0026#39;\u0026#39;))\n    ) \/ LENGTH(\u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;) AS passengers_in_manifest\nFROM travel_manifests\nWHERE vehicle_id LIKE \u0026#39;CARGO-%\u0026#39;;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;We need to wrap it in a CTE to grab and group by the vehicle_id I believe, as there are similar entries.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Also we need to group the records with the same departure time, so that we can combine the number of passengers for that vehicle.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;WITH passenger_counts AS (\n    SELECT\n        vehicle_id,\n        departure_time,\n        (\n            LENGTH(manifest_xml)\n            - LENGTH(REPLACE(manifest_xml, \u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;, \u0026#39;\u0026#39;))\n        ) \/ LENGTH(\u0026#39;\u0026lt;passenger\u0026gt;\u0026#39;) AS passengers_in_manifest\n    FROM travel_manifests\n    WHERE vehicle_id LIKE \u0026#39;CARGO-%\u0026#39;\n)\nSELECT\n    vehicle_id,\n    departure_time,\n    SUM(passengers_in_manifest) AS total_passengers\nFROM passenger_counts\nGROUP BY vehicle_id, departure_time\nHAVING SUM(passengers_in_manifest) \u0026gt; 20\nORDER BY departure_time;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;We count the number of passengers in the CTE and use it as a filter in the outer query as \u0026lt;code\u0026gt;SUM(passengers_in_manifest) \u0026amp;gt; 20\u0026lt;\/code\u0026gt; which will give the right condition for us to get the result. We have to use \u0026lt;code\u0026gt;HAVING\u0026lt;\/code\u0026gt; as we need to do that after grouping the same \u0026lt;code\u0026gt;vehicle_id\u0026lt;\/code\u0026gt; and records across same \u0026lt;code\u0026gt;departure_time\u0026lt;\/code\u0026gt;.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We also use the \u0026lt;code\u0026gt;vehicle_id LIKE \u0026#39;CARGO-%\u0026#39;\u0026lt;\/code\u0026gt; in the CTE to filter it right at the inner query to avoid looping in all the queries for computing the number of passengers.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;That solves this problem.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;That\u0026#39;s it from day 13 of Advent of SQL.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;There are other ways, but its the same parsing, We can use JOINs and stuff, but hey that was not the point of this.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Anyways! See you tomorrow for day 14!\u0026lt;\/p\u0026gt;\n"
    }
    </script>
    
    
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/code-block.css">
    <link rel="stylesheet" href="/post-navigation.css">
    
    <link rel="icon" href="/tbicon.png" type="image/png">
    <link rel="apple-touch-icon" href="/tbicon.png">
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link id="syntax-theme" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.13.0/sql-wasm.js"></script>
    <link rel="stylesheet" href="/sql-playground.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/monokai.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/sql/sql.min.js"></script>
    <script src="/sql-playground.js"></script>
    
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script>
    document.addEventListener("DOMContentLoaded", () => {
        const body = document.body;
        const stylesheet = document.getElementById("syntax-theme");
        const themeToggle = document.getElementById('theme-toggle');

        function setSyntaxTheme(theme) {
            if (theme === "secondary") {
                stylesheet.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css";
            } else {
                stylesheet.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css";
            }
        }

        
        document.querySelectorAll("pre code").forEach((block) => {
            hljs.highlightElement(block);
        });

        
        const currentTheme = localStorage.getItem("theme") || "default";
        if (currentTheme === "secondary") {
            body.classList.add("secondary-theme");
            if (themeToggle) themeToggle.checked = true;
        }
        setSyntaxTheme(currentTheme);

        
        if (themeToggle) {
            themeToggle.addEventListener('change', () => {
                const newTheme = themeToggle.checked ? 'secondary' : 'default';
                if (themeToggle.checked) {
                    body.classList.add('secondary-theme');
                } else {
                    body.classList.remove('secondary-theme');
                }
                localStorage.setItem('theme', newTheme);
                setSyntaxTheme(newTheme);
            });
        }
        
        
        const editBtn = document.getElementById('editor-edit');
        if (editBtn) {
            editBtn.addEventListener('click', async function () {
                const slug = "sqlog\/advent-of-sql-2025-day-13";
                const type = "sqlog";
                console.log("Editing post:", slug, type);
                const url = "https:\/\/devmeetgor.netlify.app/.netlify/functions/api?slug=" + slug + "&method=edit&type=" + type;
                
                try {
                    const res = await fetch(url);
                    if (!res.ok) throw new Error("Failed to fetch edit content");
                    const html = await res.text();
                    document.querySelector('.post-content').innerHTML = html;
                } catch (err) {
                    console.error(err);
                    alert("Error loading editor content");
                }
            });
        }
    });
    </script>
    
    
    <script src="/seasonal-effects.js" defer></script>
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EET2ZX4QY1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-EET2ZX4QY1');
    </script>
</head>
<body>
    <header class="header">
  <a class="site-title" href="/" aria-label="Meet Gor - Home">Meet Gor</a>
  <nav>
    <ul>
      <li><a href="/" aria-label="Home">Home</a></li>
      <li><a href="/posts" aria-label="Posts">Posts</a></li>
      <li><a href="/all-content" aria-label="All Content">All Content</a></li>
      <li><a href="/about" aria-label="About">About</a></li>
      <li><a href="/contact" aria-label="Contact">Contact</a></li>
    </ul>
  </nav>
  <div class="theme-switch">
    <input type="checkbox" id="theme-toggle" aria-label="Toggle Theme">
    <label for="theme-toggle"></label>
  </div>
  
    <button id="editor" onclick="location.href='/editor'" aria-label="Editor">
      Editor
    </button>
  
</header>
    
    <main class="container">
        <article class="blog-post">
            <h1>Advent of SQL 2025 Day 13: XML Travel Manifests</h1>
            
            <div class="post-meta">
                Published on  <time datetime="2025-12-27 20:30 &#43;0530">2025-12-27 20:30 &#43;0530</time>
            </div>
            
            <div class="post-meta">
                Type: <a href="/sqlog">sqlog</a>
            </div>
            
            <div class="post-meta tags">
                <span class="post-series-label"> Tags:</span>
                
                <a href="/tags/sqlite">#sqlite</a>
                
                <a href="/tags/sql">#sql</a>
                
                <a href="/tags/advent-of-sql">#advent-of-sql</a>
                
            </div>
            
            
            <div class="post-series">
                <span class="series-label">Part of the
                <span class="series-list">
                    
                    <a href="/series/advent-of-sql-2025" class="series-link"> advent-of-sql-2025</a>
                    
                </span></span>
                <span class="series-label">series</span>
            </div>
            
            
            
            <div class="post-meta admin-controls">
                <button id="editor-edit">Edit</button>
                <button id="editor-delete" 
                        onclick="location.href='/editor/?slug=sqlog\/advent-of-sql-2025-day-13&method=delete'">
                    Delete
                </button>
            </div>
            
            
            <hr>
            
            <div class="post-content">
                <h2 id="advent-of-sql---day-13-xml-travel-manifests">Advent of SQL - Day 13, XML Travel Manifests</h2>
<p>Its day 13 of Advent of SQL, we have some xml to parse, which I don't think SQL can handle, but string manipulation to the rescue.</p>
<p>Let's get the SQL for the day:</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">DROP TABLE IF EXISTS travel_manifests;

CREATE TABLE travel_manifests (
    manifest_id INT PRIMARY KEY,
    vehicle_id TEXT,
    departure_time TIMESTAMP,
    manifest_xml XML
);

INSERT INTO travel_manifests (manifest_id, vehicle_id, departure_time, manifest_xml) VALUES
  (1, 'SLEIGH-01', '2025-12-22 06:00:00', '<manifest><passengers><passenger><name>Nia Grant</name><ticket_class>overnight</ticket_class></passenger><passenger><name>Sofia Kim</name><ticket_class>overnight</ticket_class><engine_check>ignored</engine_check></passenger><passenger><name>Jonah Wolfe</name><ticket_class>standard</ticket_class><snack_inventory>ignored</snack_inventory></passenger></passengers></manifest>'),
  (2, 'SLEIGH-07', '2025-12-23 13:00:00', '<manifest><passengers><passenger><name>Ravi Patel</name><ticket_class>priority</ticket_class></passenger><passenger><name>Keiko Ito</name><ticket_class>standard</ticket_class></passenger><passenger><name>Anya Pavlov</name><ticket_class>standard</ticket_class></passenger><passenger><name>Nia Grant</name><ticket_class>priority</ticket_class><snack_inventory>ignored</snack_inventory></passenger><passenger><name>Carter Lewis</name><ticket_class>priority</ticket_class><engine_check>ignored</engine_check></passenger><passenger><name>Layla Brooks</name><ticket_class>standard</ticket_class><reindeer_mood>ignored</reindeer_mood></passenger></passengers></manifest>'),
  (3, 'FLIGHT-NP-9', '2025-12-22 18:00:00', '<manifest><passengers><passenger><name>Keiko Ito</name><ticket_class>overnight</ticket_class></passenger><passenger><name>Jonah Wolfe</name><ticket_class>priority</ticket_class></passenger><passenger><name>Diego Ramos</name><ticket_class>overnight</ticket_class><snack_inventory>ignored</snack_inventory></passenger><passenger><name>Priya Das</name><ticket_class>priority</ticket_class></passenger><passenger><name>Layla Brooks</name><ticket_class>standard</ticket_class></passenger></passengers></manifest>'),
  (4, 'TRAIN-ICE-3', '2025-12-22 18:00:00', '<manifest><reindeer_mood>low</reindeer_mood><passengers><passenger><name>Isla Torres</name><ticket_class>overnight</ticket_class></passenger><passenger><name>Ravi Patel</name><ticket_class>overnight</ticket_class></passenger><passenger><name>Hiro Tanaka</name><ticket_class>standard</ticket_class></passenger><passenger><name>Priya Das</name><ticket_class>priority</ticket_class></passenger></passengers></manifest>'),
  (5, 'FLIGHT-NP-9', '2025-12-22 17:00:00', '<manifest><passengers><passenger><name>Nia Grant</name><ticket_class>priority</ticket_class></passenger><passenger><name>Mateo Cruz</name><ticket_class>standard</ticket_class><snowfall_inches>ignored</snowfall_inches></passenger></passengers></manifest>'),
  (6, 'CARGO-12', '2025-12-22 15:00:00', '<manifest><passengers><passenger><name>Carter Lewis</name><ticket_class>overnight</ticket_class></passenger><passenger><name>Sofia Kim</name><ticket_class>priority</ticket_class></passenger><passenger><name>Hiro Tanaka</name><ticket_class>priority</ticket_class></passenger><passenger><name>Lucas Ford</name><ticket_class>priority</ticket_class><snack_inventory>ignored</snack_inventory></passenger><passenger><name>Nia Grant</name><ticket_class>overnight</ticket_class></passenger></passengers></manifest>'),
  (7, 'SLEIGH-01', '2025-12-22 11:00:00', '<manifest><snack_inventory>unknown</snack_inventory><passengers><passenger><name>Priya Das</name><ticket_class>standard</ticket_class></passenger><passenger><name>Diego Ramos</name><ticket_class>standard</ticket_class></passenger><passenger><name>Lucas Ford</name><ticket_class>overnight</ticket_class></passenger><passenger><name>Carter Lewis</name><ticket_class>overnight</ticket_class><reindeer_mood>ignored</reindeer_mood></passenger><passenger><name>Hiro Tanaka</name><ticket_class>priority</ticket_class><weather_note>ignored</weather_note></passenger><passenger><name>Zara Sheikh</name><ticket_class>overnight</ticket_class></passenger></passengers></manifest>'),
  (8, 'CARGO-12', '2025-12-23 13:00:00', '<manifest><passengers><passenger><name>Jonah Wolfe</name><ticket_class>standard</ticket_class></passenger><passenger><name>Layla Brooks</name><ticket_class>overnight</ticket_class></passenger><passenger><name>Leo Becker</name><ticket_class>overnight</ticket_class><weather_note>ignored</weather_note></passenger><passenger><name>Ravi Patel</name><ticket_class>standard</ticket_class></passenger><passenger><name>Sofia Kim</name><ticket_class>priority</ticket_class><snack_inventory>ignored</snack_inventory></passenger><passenger><name>Elena Morales</name><ticket_class>overnight</ticket_class></passenger></passengers></manifest>'),
  (9, 'SLEIGH-01', '2025-12-23 10:00:00', '<manifest><passengers><passenger><name>Sofia Kim</name><ticket_class>overnight</ticket_class></passenger><passenger><name>Bianca Pereira</name><ticket_class>standard</ticket_class></passenger><passenger><name>Zara Sheikh</name><ticket_class>overnight</ticket_class></passenger><passenger><name>Elena Morales</name><ticket_class>overnight</ticket_class><reindeer_mood>ignored</reindeer_mood></passenger><passenger><name>Hiro Tanaka</name><ticket_class>priority</ticket_class></passenger><passenger><name>Keiko Ito</name><ticket_class>priority</ticket_class><snack_inventory>ignored</snack_inventory></passenger></passengers></manifest>'),
  (10, 'SLEIGH-01', '2025-12-22 21:00:00', '<manifest><snowfall_inches>low</snowfall_inches><passengers><passenger><name>Nia Grant</name><ticket_class>standard</ticket_class></passenger><passenger><name>Ava Johnson</name><ticket_class>standard</ticket_class></passenger><passenger><name>Priya Das</name><ticket_class>priority</ticket_class></passenger><passenger><name>Mateo Cruz</name><ticket_class>standard</ticket_class></passenger><passenger><name>Bianca Pereira</name><ticket_class>overnight</ticket_class></passenger><passenger><name>Leo Becker</name><ticket_class>overnight</ticket_class></passenger></passengers></manifest>'),
  (11, 'SLEIGH-07', '2025-12-23 10:00:00', '<manifest><passengers><passenger><name>Jonah Wolfe</name><ticket_class>priority</ticket_class></passenger><passenger><name>Bianca Pereira</name><ticket_class>priority</ticket_class></passenger><passenger><name>Anya Pavlov</name><ticket_class>standard</ticket_class></passenger></passengers></manifest>'),
  (12, 'SLEIGH-01', '2025-12-22 08:00:00', '<manifest><reindeer_mood>ok</reindeer_mood><passengers><passenger><name>Ravi Patel</name><ticket_class>priority</ticket_class><snack_inventory>ignored</snack_inventory></passenger><passenger><name>Bianca Pereira</name><ticket_class>priority</ticket_class></passenger><passenger><name>Keiko Ito</name><ticket_class>standard</ticket_class></passenger></passengers></manifest>'),
  (13, 'FLIGHT-NP-9', '2025-12-22 11:00:00', '<manifest><snowfall_inches>ok</snowfall_inches><passengers><passenger><name>Nia Grant</name><ticket_class>priority</ticket_class></passenger><passenger><name>Elena Morales</name><ticket_class>standard</ticket_class></passenger></passengers></manifest>'),
  (14, 'SLEIGH-01', '2025-12-22 14:00:00', '<manifest><engine_check>high</engine_check><passengers><passenger><name>Layla Brooks</name><ticket_class>standard</ticket_class><weather_note>ignored</weather_note></passenger><passenger><name>Anya Pavlov</name><ticket_class>overnight</ticket_class></passenger><passenger><name>Keiko Ito</name><ticket_class>standard</ticket_class></passenger><passenger><name>Zara Sheikh</name><ticket_class>standard</ticket_class><engine_check>ignored</engine_check></passenger><passenger><name>Sofia Kim</name><ticket_class>overnight</ticket_class></passenger></passengers></manifest>'),
  (15, 'FLIGHT-NP-9', '2025-12-22 14:00:00', '<manifest><snowfall_inches>ok</snowfall_inches><passengers><passenger><name>Priya Das</name><ticket_class>priority</ticket_class><snowfall_inches>ignored</snowfall_inches></passenger><passenger><name>Bianca Pereira</name><ticket_class>standard</ticket_class></passenger><passenger><name>Nia Grant</name><ticket_class>standard</ticket_class></passenger></passengers></manifest>');
</code></pre><div class="output"></div></div><p>Just one table, with some wild XML.</p>
<p>Let's see what do we want to do in the problem statement.</p>
<h2 id="problem">Problem</h2>
<blockquote>
<p>Using the <code>travel_manifests</code> table, extract the passenger information from the XML data and produce a report that shows all of the departure times for &quot;CARGO&quot; vehicles that have more than 20 passengers booked. Include in the results:</p>
<ul>
<li>The vehicle_id</li>
<li>The departure_time</li>
<li>The total number of passengers on that departure</li>
<li>Order the results by departure_time.</li>
</ul>
</blockquote>
<p>Ok, so we need the number of passengers in the records which are of type <code>CARGO</code> and have more than 20 passengers booked.</p>
<p>Interesting!</p>
<p>Let's look at one record.</p>
<div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> .schema
CREATE TABLE travel_manifests (
    manifest_id INT PRIMARY KEY,
    vehicle_id TEXT,
    departure_time TIMESTAMP,
    manifest_xml XML
);
sqlite> SELECT * FROM travel_manifests WHERE id = 1;
Parse error: no such column: id
  SELECT * FROM travel_manifests WHERE id = 1;
                         error here ---^
sqlite> SELECT * FROM travel_manifests LIMIT 1;
+-------------+------------+---------------------+--------------------------------------------------------------+
| manifest_id | vehicle_id |   departure_time    |                         manifest_xml                         |
+-------------+------------+---------------------+--------------------------------------------------------------+
| 1           | SLEIGH-01  | 2025-12-22 06:00:00 | <manifest><passengers><passenger><name>Nia Grant</name><tick |
|             |            |                     | et_class>overnight</ticket_class></passenger><passenger><nam |
|             |            |                     | e>Sofia Kim</name><ticket_class>overnight</ticket_class><eng |
|             |            |                     | ine_check>ignored</engine_check></passenger><passenger><name |
|             |            |                     | >Jonah Wolfe</name><ticket_class>standard</ticket_class><sna |
|             |            |                     | ck_inventory>ignored</snack_inventory></passenger></passenge |
|             |            |                     | rs></manifest>                                               |
+-------------+------------+---------------------+--------------------------------------------------------------+
sqlite> 

</code></pre></div><p>So, we have the following columns</p>
<ul>
<li><code>vehicle_id</code> which is I think related to filtering <code>CARGO</code> related vehicles only</li>
<li><code>departure_time</code> which we just return as is</li>
<li><code>manifest_xml</code>, oh! This is xml and it has passenger details.</li>
</ul>
<p>If we look carefully, we can see the xml looks like this:</p>
<div class="code-block"><div class="code-header"><span class="language-name">xml</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-xml"><manifest>
    <passengers>
        <passenger>
            <name>Nia Grant</name> 
           <ticket_class>overnight</ticket_class>
        </passenger>
        <passenger>
            <name>Sofia Kim</name> 
           <ticket_class>overnight</ticket_class>
           <engine_check>ignored</engine_check>
       </passenger>
       <passenger>
           <name>Jonah Wolfe</name>
           <ticket_class>standard</ticket_class>
           <snack_inventory>ignored</snack_inventory>
       </passenger>
    </passengers>
</manifest>
</code></pre></div><p>We have <code>manifest</code> which has a property of <code>passengers</code> which is a list of <code>passenger</code> tags, inside of which, each element of <code>passenger</code> has its details like <code>name</code>, <code>ticket_class</code>, etc.</p>
<p>We only want the count of <code>passengers</code>, how can we get that? The dirtiest way to do is to count the occurances of <code>&lt;passenger&gt;</code> or <code>&lt;/passenger&gt;</code> in the xml string.</p>
<p>We can do that with counting the full length of the xml string, and then dividing by the number of times the string can be replaced(which is the dirty part, there could be hidden <code>&lt;passenger&gt;</code> string somewhere that might break this logic, but if it is a valid xml, it works). We count the number of characters left after we replace the string <code>&lt;passenger&gt;</code> with empty string <code>''</code> so that we can get the difference of the total number of character and the number of characters occupied by the string <code>&lt;passenger&gt;</code>. This difference if we divide by the length of <code>&lt;passenger&gt;</code> will give us the count of the number of times the <code>&lt;passenger&gt;</code> string is present in the xml string.</p>
<p>Let's take an example from the above. The length of the xml string is 374.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT LENGTH(manifest_xml) FROM travel_manifests LIMIT 1;
</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> SELECT LENGTH(manifest_xml) FROM travel_manifests LIMIT 1;
+----------------------+
| LENGTH(manifest_xml) |
+----------------------+
| 374                  |
+----------------------+
sqlite> 
</code></pre></div><p>Let's replace the occurances of <code>&lt;passenger&gt; with empty string in the </code>manifest_xml` string, like so:</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT REPLACE(manifest_xml, '<passenger>', '') FROM travel_manifests LIMIT 1;
</code></pre><div class="output"></div></div><p>Now, we can see the string <code>&lt;passenger&gt;</code> is gone from the returned result set. We can try getting its length now.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT 
    LENGTH(
        REPLACE(manifest_xml, '<passenger>', '')
    )
FROM travel_manifests LIMIT 1;
</code></pre><div class="output"></div></div><p>Now, it says <code>341</code> why? Because we removed (replaced with empty string) the occurences of <code>&lt;passenger&gt;</code>.</p>
<p>Let's get the length of <code>'&lt;passenger&gt;'</code> string, which should be <code>11</code> right?</p>
<p>Spell it <code>p-a-s-s-e-n-g-e-r</code> as <code>pass</code> + <code>enger</code> (4+5=9) and 2 for <code>&lt;&gt;</code> so 11. Sometimes I don't know how to do math, I use SQL.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT LENGTH('<passenger>');
</code></pre><div class="output"></div></div><p>There it is <code>11</code>.</p>
<p>Now, if you compute the difference of the actual length of XML with the removed parts of the <code>&lt;passenger&gt;</code> what do we get?</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT LENGTH(manifest_xml) - LENGTH(REPLACE(manifest_xml, '<passenger>', '')) FROM travel_manifests LIMIT 1;
</code></pre><div class="output"></div></div><p>WE got <code>33</code>, why would you ask because <code>11</code> times 3 is <code>33</code>. We found three instances of <code>&lt;passenger&gt;</code>,  so we just need to divide by the length of <code>&lt;passenger&gt;</code> or hard code it as <code>11</code> doesn't matter.</p>
<p>We would get the number of occurances of <code>&lt;passenger&gt;</code> which will give the number of passenger in the xml string.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT
    (
        LENGTH(manifest_xml) - LENGTH(REPLACE(manifest_xml, '<passenger>', ''))
    ) / LENGTH('<passenger>')
FROM travel_manifests LIMIT 1;
</code></pre><div class="output"></div></div><p>Phew, its <code>3</code>!</p>
<p>That was a lot for a simple stuff. But hey its fun!</p>
<div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> SELECT (manifest_xml) FROM travel_manifests LIMIT 1;
+--------------------------------------------------------------+
|                         manifest_xml                         |
+--------------------------------------------------------------+
| <manifest><passengers><passenger><name>Nia Grant</name><tick |
| et_class>overnight</ticket_class></passenger><passenger><nam |
| e>Sofia Kim</name><ticket_class>overnight</ticket_class><eng |
| ine_check>ignored</engine_check></passenger><passenger><name |
| >Jonah Wolfe</name><ticket_class>standard</ticket_class><sna |
| ck_inventory>ignored</snack_inventory></passenger></passenge |
| rs></manifest>                                               |
+--------------------------------------------------------------+

sqlite> SELECT REPLACE(manifest_xml, '<passenger>', '') FROM travel_manifests LIMIT 1;
+--------------------------------------------------------------+
|           REPLACE(manifest_xml, '<passenger>', '')           |
+--------------------------------------------------------------+
| <manifest><passengers><name>Nia Grant</name><ticket_class>ov |
| ernight</ticket_class></passenger><name>Sofia Kim</name><tic |
| ket_class>overnight</ticket_class><engine_check>ignored</eng |
| ine_check></passenger><name>Jonah Wolfe</name><ticket_class> |
| standard</ticket_class><snack_inventory>ignored</snack_inven |
| tory></passenger></passengers></manifest>                    |
+--------------------------------------------------------------+
sqlite> 
sqlite> SELECT LENGTH(REPLACE(manifest_xml, '<passenger>', '')) FROM travel_manifests LIMIT 1;
+--------------------------------------------------+
| LENGTH(REPLACE(manifest_xml, '<passenger>', '')) |
+--------------------------------------------------+
| 341                                              |
+--------------------------------------------------+
sqlite> SELECT LENGTH(manifest_xml) - LENGTH(REPLACE(manifest_xml, '<passenger>', '')) FROM travel_manifests LIMIT 1;
+--------------------------------------------------------------+
| LENGTH(manifest_xml) - LENGTH(REPLACE(manifest_xml, '<passen |
+--------------------------------------------------------------+
| 33                                                           |
+--------------------------------------------------------------+
sqlite> SELECT LENGTH('<passenger>') FROM travel_manifests LIMIT 1;
+-----------------------+
| LENGTH('<passenger>') |
+-----------------------+
| 11                    |
+-----------------------+

sqlite> SELECT (LENGTH(manifest_xml) - LENGTH(REPLACE(manifest_xml, '<passenger>', '')))/LENGTH('<passenger>') FROM travel_manifests LIMIT 1;
+--------------------------------------------------------------+
| (LENGTH(manifest_xml) - LENGTH(REPLACE(manifest_xml, '<passe |
+--------------------------------------------------------------+
| 3                                                            |
+--------------------------------------------------------------+
sqlite> 

</code></pre></div><p>Now, let construct the query to get the number of passengers.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT
    vehicle_id,
    departure_time,
    (
        LENGTH(manifest_xml)
        - LENGTH(REPLACE(manifest_xml, '<passenger>', ''))
    ) / LENGTH('<passenger>') AS passengers_in_manifest
FROM travel_manifests
WHERE vehicle_id LIKE 'CARGO-%';
</code></pre><div class="output"></div></div><p>We need to wrap it in a CTE to grab and group by the vehicle_id I believe, as there are similar entries.</p>
<p>Also we need to group the records with the same departure time, so that we can combine the number of passengers for that vehicle.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">WITH passenger_counts AS (
    SELECT
        vehicle_id,
        departure_time,
        (
            LENGTH(manifest_xml)
            - LENGTH(REPLACE(manifest_xml, '<passenger>', ''))
        ) / LENGTH('<passenger>') AS passengers_in_manifest
    FROM travel_manifests
    WHERE vehicle_id LIKE 'CARGO-%'
)
SELECT
    vehicle_id,
    departure_time,
    SUM(passengers_in_manifest) AS total_passengers
FROM passenger_counts
GROUP BY vehicle_id, departure_time
HAVING SUM(passengers_in_manifest) > 20
ORDER BY departure_time;
</code></pre><div class="output"></div></div><p>We count the number of passengers in the CTE and use it as a filter in the outer query as <code>SUM(passengers_in_manifest) &gt; 20</code> which will give the right condition for us to get the result. We have to use <code>HAVING</code> as we need to do that after grouping the same <code>vehicle_id</code> and records across same <code>departure_time</code>.</p>
<p>We also use the <code>vehicle_id LIKE 'CARGO-%'</code> in the CTE to filter it right at the inner query to avoid looping in all the queries for computing the number of passengers.</p>
<p>That solves this problem.</p>
<p>That's it from day 13 of Advent of SQL.</p>
<p>There are other ways, but its the same parsing, We can use JOINs and stuff, but hey that was not the point of this.</p>
<p>Anyways! See you tomorrow for day 14!</p>

            </div>
        </article>
        
        
        

<nav class="post-navigation" aria-label="Post Navigation">
    <div class="nav-container">
        
        
        <a href="/sqlog/advent-of-sql-2025-day-12" class="nav-link nav-prev" title="Previous Post">
            <span class="nav-arrow"></span>
            <span class="nav-label">Previous</span>
            <span class="nav-title">Advent of SQL 2025 Day 12: Archive Flight Records</span>
        </a>
        

        
        
        <a href="/sqlog/advent-of-sql-2025-day-14" class="nav-link nav-next" title="Next Post">
            <span class="nav-label">Next</span>
            <span class="nav-title">Advent of SQL 2025 Day 14: Ski Resort Paths</span>
            <span class="nav-arrow"></span>
        </a>
        
    </div>
</nav>


        
        
        


<aside class="related-reading" aria-labelledby="related-reading-title">
    <h3 id="related-reading-title" class="related-title"> Related Reading</h3>
    <ul class="related-list">
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-15" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 15: Confirmation Phrase Dispatches</span>
                <span class="related-post-date">2025-12-28 20:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-14" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 14: Ski Resort Paths</span>
                <span class="related-post-date">2025-12-28 15:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-12" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 12: Archive Flight Records</span>
                <span class="related-post-date">2025-12-27 15:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-11" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 11: Behavior Score</span>
                <span class="related-post-date">2025-12-26 15:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-10" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 10: Misdelivered Presents</span>
                <span class="related-post-date">2025-12-25 15:30 &#43;0530</span>
            </a>
        </li>
        
        
    </ul>
</aside>


    </main>
    
    <div id="comments">
        <script src="https://giscus.app/client.js"
            data-repo="Mr-Destructive/meetgor.com"
            data-repo-id="R_kgDOHZ6V_g"
            data-category="Q&A"
            data-category-id="DIC_kwDOHZ6V_s4CRfn4"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="bottom"
            data-theme="dark_high_contrast"
            data-lang="en"
            crossorigin="anonymous"
            async>
        </script>
    </div>
    
    <footer class="site-footer" role="contentinfo">
  <div class="footer-content">
    <p>&copy; Meet Gor. All rights reserved.</p>
    <div class="social-links">
      <a href="/contact" aria-label="Connect with me">Connect with me</a>
    </div>
  </div>
</footer>
    
</body>
</html>
