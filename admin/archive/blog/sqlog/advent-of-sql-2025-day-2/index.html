<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <title>Advent of SQL 2025 Day 2: Snowballs | Meet Gor</title>
    <meta name="title" content="Advent of SQL 2025 Day 2: Snowballs | Meet Gor">
    <meta name="description" content="">
    <meta name="author" content="Meet Gor">
    <meta name="keywords" content="sqlite, sql, advent-of-sql">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://meetgor.com/sqlog/advent-of-sql-2025-day-2">
    
    
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://meetgor.com/sqlog/advent-of-sql-2025-day-2">
    <meta property="og:title" content="Advent of SQL 2025 Day 2: Snowballs">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://meetgor.com/tbicon.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Advent of SQL 2025 Day 2: Snowballs">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Meet Gor">
    <meta property="article:published_time" content="2025-12-17 15:30 &#43;0530">
    <meta property="article:modified_time" content="2025-12-17 15:30 &#43;0530">
    <meta property="article:author" content="Meet Gor">
    
    <meta property="article:tag" content="sqlite">
    
    <meta property="article:tag" content="sql">
    
    <meta property="article:tag" content="advent-of-sql">
    
    
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@meetgor711">
    <meta name="twitter:creator" content="@meetgor711">
    <meta name="twitter:url" content="https://meetgor.com/sqlog/advent-of-sql-2025-day-2">
    <meta name="twitter:title" content="Advent of SQL 2025 Day 2: Snowballs">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="https://meetgor.com/tbicon.png">
    <meta name="twitter:image:alt" content="Advent of SQL 2025 Day 2: Snowballs">
    
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/meetgor.com/sqlog\/advent-of-sql-2025-day-2"
        },
        "headline": "Advent of SQL 2025 Day 2: Snowballs",
        "description": "",
        "datePublished": "2025-12-17 15:30 \u002b0530",
        "dateModified": "2025-12-17 15:30 \u002b0530",
        "author": {
            "@type": "Person",
            "name": "Meet Gor"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Meet Gor",
            "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/meetgor.com/tbicon.png"
            }
        },
        
        "keywords": "sqlite, sql, advent-of-sql",
        "articleBody": "\u0026lt;h2 id=\u0026#34;sqlog-advent-of-sql-day-2\u0026#34;\u0026gt;SQLog: Advent of SQL Day 2\u0026lt;\/h2\u0026gt;\n\u0026lt;p\u0026gt;Here we are on the day 2 of Advent of SQL\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;As I said in the previous day this is in SQLite so I won\u0026#39;t be doing it in the playground. So here is your SQLite playground :)\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT 1;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;From now on no setup straight to the problem!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s download the .sql file for today\u0026#39;s problem to see what data we are playing with.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;DROP TABLE IF EXISTS snowball_categories;\nDROP TABLE IF EXISTS snowball_inventory;\n\nCREATE TABLE snowball_categories (\n    id INT PRIMARY KEY,\n    official_category TEXT\n);\n\nCREATE TABLE snowball_inventory (\n    id INT PRIMARY KEY,\n    batch_id TEXT,\n    category_name TEXT,\n    quantity INT,\n    status TEXT\n);\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Well, neat and clean!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Straight pulling it in the sqlite shell.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;plaintext\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-plaintext\u0026#34;\u0026gt;$ sqlite3 \nSQLite version 3.45.1 2024-01-30 16:01:20\nEnter \u0026#34;.help\u0026#34; for usage hints.\nConnected to a transient in-memory database.\nUse \u0026#34;.open FILENAME\u0026#34; to reopen on a persistent database.\nsqlite\u0026gt; .read day2-inserts.sql\nsqlite\u0026gt; .schema\nCREATE TABLE snowball_categories (\n    id INT PRIMARY KEY,\n    official_category TEXT\n);\nCREATE TABLE snowball_inventory (\n    id INT PRIMARY KEY,\n    batch_id TEXT,\n    category_name TEXT,\n    quantity INT,\n    status TEXT\n);\nsqlite\u0026gt; \n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Worked right off the bat.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Straight to problem now.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;If you are working in the playground, do add this full code with inserts in order to get a sense of what the data looks like, note that this below statements is not all data, just sharing to get you a taste of the problem.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;DROP TABLE IF EXISTS snowball_categories;\nDROP TABLE IF EXISTS snowball_inventory;\n\nCREATE TABLE snowball_categories (\n    id INT PRIMARY KEY,\n    official_category TEXT\n);\n\nCREATE TABLE snowball_inventory (\n    id INT PRIMARY KEY,\n    batch_id TEXT,\n    category_name TEXT,\n    quantity INT,\n    status TEXT\n);\n\nINSERT INTO snowball_categories (id, official_category) VALUES\n    (1, \u0026#39;frost-flight deluxe\u0026#39;),\n    (2, \u0026#39;north ridge compact\u0026#39;),\n    (3, \u0026#39;glacier sphere (xl)\u0026#39;),\n    (4, \u0026#39;polar precision microball\u0026#39;),\n    (5, \u0026#39;everfrost training round\u0026#39;),\n    (6, \u0026#39;arctic blast premium\u0026#39;);\n\nINSERT INTO snowball_inventory (id, batch_id, category_name, quantity, status) VALUES\n    (1, \u0026#39;BATCH-35443-J\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, 19, NULL),\n    (2, \u0026#39;BATCH-59767-M\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, 41, \u0026#39;incomplete\u0026#39;),\n    (3, \u0026#39;BATCH-44795-B\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, 21, \u0026#39;ready\u0026#39;),\n    (4, \u0026#39;BATCH-23396-C\u0026#39;, \u0026#39;north ridge compact\u0026#39;, 0, \u0026#39;incomplete\u0026#39;),\n    (5, \u0026#39;BATCH-88907-A\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, -2, \u0026#39;incomplete\u0026#39;),\n    (6, \u0026#39;BATCH-42662-D\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, 47, \u0026#39;needs review\u0026#39;),\n    (7, \u0026#39;BATCH-37460-V\u0026#39;, \u0026#39;north ridge compact\u0026#39;, 43, \u0026#39;ready\u0026#39;),\n    (8, \u0026#39;BATCH-21395-S\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, -2, \u0026#39;ready\u0026#39;),\n    (9, \u0026#39;BATCH-36100-E\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, 46, \u0026#39;ready\u0026#39;),\n    (10, \u0026#39;BATCH-64987-H\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, 43, NULL),\n    (11, \u0026#39;BATCH-57576-Z\u0026#39;, \u0026#39;melty deluxe\u0026#39;, -5, \u0026#39;ready\u0026#39;),\n    (12, \u0026#39;BATCH-56025-U\u0026#39;, \u0026#39;snowball v2\u0026#39;, 11, \u0026#39;ready\u0026#39;),\n    (13, \u0026#39;BATCH-86556-W\u0026#39;, \u0026#39;snowball v2\u0026#39;, 12, \u0026#39;ready\u0026#39;),\n    (14, \u0026#39;BATCH-83385-N\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, 38, \u0026#39;incomplete\u0026#39;),\n    (15, \u0026#39;BATCH-85156-M\u0026#39;, \u0026#39;prototype x-12\u0026#39;, 28, \u0026#39;incomplete\u0026#39;),\n    (16, \u0026#39;BATCH-82135-F\u0026#39;, \u0026#39;north ridge compact\u0026#39;, 32, \u0026#39;incomplete\u0026#39;),\n    (17, \u0026#39;BATCH-10074-T\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, 49, \u0026#39;needs review\u0026#39;),\n    (18, \u0026#39;BATCH-22676-L\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, 16, \u0026#39;incomplete\u0026#39;),\n    (19, \u0026#39;BATCH-31174-R\u0026#39;, \u0026#39;north ridge compact\u0026#39;, 33, \u0026#39;incomplete\u0026#39;),\n    (20, \u0026#39;BATCH-41385-B\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, 4, \u0026#39;ready\u0026#39;),\n    (21, \u0026#39;BATCH-50404-L\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, -4, \u0026#39;needs review\u0026#39;),\n    (22, \u0026#39;BATCH-92240-F\u0026#39;, \u0026#39;north ridge compact\u0026#39;, 20, \u0026#39;ready\u0026#39;),\n    (23, \u0026#39;BATCH-29198-J\u0026#39;, \u0026#39;beta test sphere\u0026#39;, 0, \u0026#39;incomplete\u0026#39;),\n    (24, \u0026#39;BATCH-64987-H\u0026#39;, \u0026#39;glacier sphere (xl)\u0026#39;, 18, \u0026#39;needs review\u0026#39;),\n    (25, \u0026#39;BATCH-80008-A\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, 3, \u0026#39;incomplete\u0026#39;),\n    (26, \u0026#39;BATCH-88907-A\u0026#39;, \u0026#39;polar precision microball\u0026#39;, 48, \u0026#39;incomplete\u0026#39;),\n    (27, \u0026#39;BATCH-55830-J\u0026#39;, \u0026#39;north ridge compact\u0026#39;, 0, \u0026#39;needs review\u0026#39;),\n    (28, \u0026#39;BATCH-69470-A\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, -3, \u0026#39;incomplete\u0026#39;),\n    (29, \u0026#39;BATCH-46211-R\u0026#39;, \u0026#39;frost-flight deluxe\u0026#39;, -3, \u0026#39;ready\u0026#39;),\n    (30, \u0026#39;BATCH-18675-G\u0026#39;, \u0026#39;glacier sphere (xl)\u0026#39;, -1, \u0026#39;ready\u0026#39;);\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;h2 id=\u0026#34;problem\u0026#34;\u0026gt;Problem\u0026lt;\/h2\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s check the challenge of day 2\u0026lt;\/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Using the \u0026lt;code\u0026gt;snowball_inventory\u0026lt;\/code\u0026gt; and \u0026lt;code\u0026gt;snowball_categories\u0026lt;\/code\u0026gt; tables, write a query that returns valid snowball categories with the count of valid snowballs per category. Your final table should have the columns \u0026lt;code\u0026gt;official_category\u0026lt;\/code\u0026gt; and \u0026lt;code\u0026gt;total_usable_snowballs\u0026lt;\/code\u0026gt;. Sort the output from fewest to most \u0026lt;code\u0026gt;total_usable_snowballs\u0026lt;\/code\u0026gt;.\u0026lt;\/p\u0026gt;\n\u0026lt;\/blockquote\u0026gt;\n\u0026lt;p\u0026gt;So, we have two tables:\u0026lt;\/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\n\u0026lt;p\u0026gt;snowball categories\u0026lt;\/p\u0026gt;\n\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;\n\u0026lt;p\u0026gt;snowball inventory\u0026lt;\/p\u0026gt;\n\u0026lt;\/li\u0026gt;\n\u0026lt;\/ol\u0026gt;\n\u0026lt;p\u0026gt;The snowball categories looks a quite a small table with just the category name and the id which is not really the data, the name is.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT * FROM snowball_categories;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Just 6 entries with some names of the categories, the column is official categories.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;sqlite\u0026gt; SELECT * FROM snowball_categories;\n\u002b----\u002b---------------------------\u002b\n| id |     official_category     |\n\u002b----\u002b---------------------------\u002b\n| 1  | frost-flight deluxe       |\n| 2  | north ridge compact       |\n| 3  | glacier sphere (xl)       |\n| 4  | polar precision microball |\n| 5  | everfrost training round  |\n| 6  | arctic blast premium      |\n\u002b----\u002b---------------------------\u002b\nsqlite\u0026gt; \n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;And the other table has oddles of data:\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT * FROM snowball_inventory limit 10;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;So, we have quite a few columns,\u0026lt;\/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\n\u0026lt;p\u0026gt;batch_id\u0026lt;\/p\u0026gt;\n\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;\n\u0026lt;p\u0026gt;category_name\u0026lt;\/p\u0026gt;\n\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;\n\u0026lt;p\u0026gt;quantity\u0026lt;\/p\u0026gt;\n\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;\n\u0026lt;p\u0026gt;status\u0026lt;\/p\u0026gt;\n\u0026lt;\/li\u0026gt;\n\u0026lt;\/ol\u0026gt;\n\u0026lt;p\u0026gt;It has 200,000 rows, that\u0026#39;s quite a lot.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;plaintext\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-plaintext\u0026#34;\u0026gt;sqlite\u0026gt; SELECT count(*) FROM snowball_inventory;\n\u002b----------\u002b\n| count(*) |\n\u002b----------\u002b\n| 200000   |\n\u002b----------\u002b\n\nsqlite\u0026gt; SELECT * FROM snowball_inventory limit 10;\n\u002b----\u002b---------------\u002b---------------------\u002b----------\u002b--------------\u002b\n| id |   batch_id    |    category_name    | quantity |    status    |\n\u002b----\u002b---------------\u002b---------------------\u002b----------\u002b--------------\u002b\n| 1  | BATCH-35443-J | frost-flight deluxe | 19       |              |\n| 2  | BATCH-59767-M | frost-flight deluxe | 41       | incomplete   |\n| 3  | BATCH-44795-B | frost-flight deluxe | 21       | ready        |\n| 4  | BATCH-23396-C | north ridge compact | 0        | incomplete   |\n| 5  | BATCH-88907-A | frost-flight deluxe | -2       | incomplete   |\n| 6  | BATCH-42662-D | frost-flight deluxe | 47       | needs review |\n| 7  | BATCH-37460-V | north ridge compact | 43       | ready        |\n| 8  | BATCH-21395-S | frost-flight deluxe | -2       | ready        |\n| 9  | BATCH-36100-E | frost-flight deluxe | 46       | ready        |\n| 10 | BATCH-64987-H | frost-flight deluxe | 43       |              |\n\u002b----\u002b---------------\u002b---------------------\u002b----------\u002b--------------\u002b\nsqlite\u0026gt; \n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;What we have to do?\u0026lt;\/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;return valid snowball categories with the count of valid snowballs per category\u0026lt;\/p\u0026gt;\n\u0026lt;\/blockquote\u0026gt;\n\u0026lt;p\u0026gt;That\u0026#39;s a mouthful.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;The problem is trying to get at counting the number of inventory items per category I think.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Because there are quite less categories and tons of inventory records.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Also the \u0026lt;code\u0026gt;category_name\u0026lt;\/code\u0026gt; in the \u0026lt;code\u0026gt;snowball_inventory\u0026lt;\/code\u0026gt; table is not trustworthy.\u0026lt;\/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Santa hurried to the snowball storage board, but the situation only got stranger. Whole batches appeared twice. Some batches claimed they had negative snowballs (“a bookkeeping accident,” the elves muttered). Others had a quantity of zero but were still marked “Ready.” And many batches referenced categories that didn’t appear anywhere in the official Snowball Category Guide\u0026lt;\/p\u0026gt;\n\u0026lt;\/blockquote\u0026gt;\n\u0026lt;h2 id=\u0026#34;naive-approach\u0026#34;\u0026gt;Naive Approach\u0026lt;\/h2\u0026gt;\n\u0026lt;p\u0026gt;The first approach I see is scan through all the inventory records and check if the category is in the \u0026lt;code\u0026gt;snowball_category\u0026lt;\/code\u0026gt; table and its quantity is positive or more than 0, also I wonder if the status needs to be checked as \u0026lt;code\u0026gt;ready\u0026lt;\/code\u0026gt;.\u0026lt;\/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;“We need to know what we actually have left,” Santa said. “Not puddles. Not phantom batches. Real, usable, throw-ready snowballs.”\u0026lt;\/p\u0026gt;\n\u0026lt;\/blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Real, throw-ready snowballs\u0026lt;\/strong\u0026gt;\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s check how to do that with simple sub query.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT * FROM snowball_inventory\nWHERE\n   category_name IN (SELECT official_category FROM snowball_categories)\n   AND quantity \u0026gt; 0\n   AND status == \u0026#39;ready\u0026#39;;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;OK!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;What we did? Simply selected all the data from \u0026lt;code\u0026gt;snowball_inventory\u0026lt;\/code\u0026gt; table,\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;in which the category name is matching either of the 6 categories in the \u0026lt;code\u0026gt;snowball_categories\u0026lt;\/code\u0026gt; table.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Also the quantity is positive and not zero, also the status is set to be \u0026lt;code\u0026gt;ready\u0026lt;\/code\u0026gt;.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;This looks naive to me for using subquery because for each 200,000 records we will scan the \u0026lt;code\u0026gt;snowball_categories\u0026lt;\/code\u0026gt; . Ew!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Wait its done! We need the count of each category! We need to group by the \u0026lt;code\u0026gt;category_name\u0026lt;\/code\u0026gt;\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT * FROM snowball_inventory\nWHERE\n   category_name IN (SELECT official_category FROM snowball_categories)\n   AND quantity \u0026gt; 0\n   AND status == \u0026#39;ready\u0026#39;\nGROUP BY category_name;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;sqlite\u0026gt; SELECT * FROM snowball_inventory\nWHERE\n   category_name IN (SELECT official_category FROM snowball_categories)\n   AND quantity \u0026gt; 0\n   AND status == \u0026#39;ready\u0026#39;\nGROUP BY category_name;\n\u002b-----\u002b---------------\u002b---------------------------\u002b----------\u002b--------\u002b\n| id  |   batch_id    |       category_name       | quantity | status |\n\u002b-----\u002b---------------\u002b---------------------------\u002b----------\u002b--------\u002b\n| 240 | BATCH-55793-L | arctic blast premium      | 45       | ready  |\n| 163 | BATCH-75333-O | everfrost training round  | 23       | ready  |\n| 3   | BATCH-44795-B | frost-flight deluxe       | 21       | ready  |\n| 39  | BATCH-22704-V | glacier sphere (xl)       | 37       | ready  |\n| 7   | BATCH-37460-V | north ridge compact       | 43       | ready  |\n| 125 | BATCH-81987-E | polar precision microball | 47       | ready  |\n\u002b-----\u002b---------------\u002b---------------------------\u002b----------\u002b--------\u002b\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;That sort of looks wired right?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Why?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Because what happens to the quantity? Is that summed? averaged, or what just happened to the batch_id?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;No it takes one value out of the \u0026lt;code\u0026gt;200 000\u0026lt;\/code\u0026gt; rows for each category. That\u0026#39;s not what we want right?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We want this\u0026lt;\/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;return valid snowball categories with the count of valid snowballs per category\u0026lt;\/p\u0026gt;\n\u0026lt;\/blockquote\u0026gt;\n\u0026lt;p\u0026gt;So, we just want the category name and the count of those category. Basically count per category.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT category_name as official_category, sum(quantity) as total_usable_snowballs\nFROM snowball_inventory \nWHERE\n   category_name IN (SELECT official_category FROM snowball_categories)\n   AND quantity \u0026gt; 0\n   AND status == \u0026#39;ready\u0026#39;\nGROUP BY category_name;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Here we are only fetching the \u0026lt;code\u0026gt;category_name\u0026lt;\/code\u0026gt; and the \u0026lt;code\u0026gt;count\u0026lt;\/code\u0026gt; which will bundle up all the counts from the grouped of the category_name.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;plaintext\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-plaintext\u0026#34;\u0026gt;sqlite\u0026gt; SELECT category_name as official_category, sum(quantity) as total_usable_snowballs \nFROM snowball_inventory \nWHERE\n   category_name IN (SELECT official_category FROM snowball_categories)\n   AND quantity \u0026gt; 0\n   AND status == \u0026#39;ready\u0026#39;\nGROUP BY category_name;\n\u002b---------------------------\u002b------------------------\u002b\n|     official_category     | total_usable_snowballs |\n\u002b---------------------------\u002b------------------------\u002b\n| arctic blast premium      | 11470                  |\n| everfrost training round  | 24248                  |\n| frost-flight deluxe       | 952019                 |\n| glacier sphere (xl)       | 165158                 |\n| north ridge compact       | 594119                 |\n| polar precision microball | 70773                  |\n\u002b---------------------------\u002b------------------------\u002b\nsqlite\u0026gt; \n\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Not done yet!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We need to order by the count.\u0026lt;\/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Sort the output from fewest to most \u0026lt;code\u0026gt;total_usable_snowballs\u0026lt;\/code\u0026gt;.\u0026lt;\/p\u0026gt;\n\u0026lt;\/blockquote\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT category_name, sum(quantity)  as total_usable_snowballs\nFROM snowball_inventory\nWHERE\n   category_name IN (SELECT official_category FROM snowball_categories)\n   AND quantity \u0026gt; 0\n   AND status == \u0026#39;ready\u0026#39;\nGROUP BY category_name\nORDER BY total_usable_snowballs;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;We can provide \u0026lt;code\u0026gt;ORDER BY total_usable_snowballs ASC\u0026lt;\/code\u0026gt; but ascending is default. I prefer keeping things default, you can be explicit and mention it as \u0026lt;code\u0026gt;ASC\u0026lt;\/code\u0026gt; to make it clear and readable.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;plaintext\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-plaintext\u0026#34;\u0026gt;sqlite\u0026gt; SELECT category_name as official_category, sum(quantity) as total_usable_snowballs\nFROM snowball_inventory \nWHERE\n   category_name IN (SELECT official_category FROM snowball_categories)\n   AND quantity \u0026gt; 0\n   AND status == \u0026#39;ready\u0026#39;\nGROUP BY category_name\nORDER BY total_usable_snowballs;\n\u002b---------------------------\u002b------------------------\u002b\n|     official_category     | total_usable_snowballs |\n\u002b---------------------------\u002b------------------------\u002b\n| arctic blast premium      | 11470                  |\n| everfrost training round  | 24248                  |\n| polar precision microball | 70773                  |\n| glacier sphere (xl)       | 165158                 |\n| north ridge compact       | 594119                 |\n| frost-flight deluxe       | 952019                 |\n\u002b---------------------------\u002b------------------------\u002b\n\nsqlite\u0026gt; \n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;There it is!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;The solution to the day 2.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;But Santa, I am using subqueries. Is that fine?\u0026lt;\/p\u0026gt;\n\u0026lt;h2 id=\u0026#34;joins\u0026#34;\u0026gt;Joins?\u0026lt;\/h2\u0026gt;\n\u0026lt;p\u0026gt;We can use joins here, since we just require the count of each category.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Which JOIN though?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;LEFT, RIGHT, INNER?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;any really?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;You don\u0026#39;t choose the join based on the problem, you define your output columns and then choose the type of join that would give you the result.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;If the thing that is to be searched from left to right and then its a left join, i.e. join everything from the left. and so on.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Here,\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;I need all the \u0026lt;code\u0026gt;official_category\u0026lt;\/code\u0026gt; column right, which is in the \u0026lt;code\u0026gt;snowball_categories\u0026lt;\/code\u0026gt; table.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;If I assume the \u0026lt;code\u0026gt;snowball_categories\u0026lt;\/code\u0026gt; is on the left, I can join everything for that row in the left to match all the \u0026lt;code\u0026gt;category_name\u0026lt;\/code\u0026gt; rows in the \u0026lt;code\u0026gt;snowball_inventory\u0026lt;\/code\u0026gt; table which would be in the right. Like so.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT \n    snowball_categories.official_category as official_category,\n    SUM(snowball_inventory.quantity) as total_usable_snowballs\nFROM snowball_categories\nLEFT JOIN snowball_inventory\n     ON snowball_categories.official_category = snowball_inventory.category_name\n     AND snowball_inventory.quantity \u0026gt; 0\n     AND snowball_inventory.status == \u0026#39;ready\u0026#39;\nGROUP BY official_category\nORDER BY total_usable_snowballs;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;We JOIN on the condition of \u0026lt;code\u0026gt;snowball_categories.official_category = snowball_inventory.category_name\u0026lt;\/code\u0026gt; which is to say, the \u0026lt;code\u0026gt;category_name\u0026lt;\/code\u0026gt; in the \u0026lt;code\u0026gt;snowball_inventory\u0026lt;\/code\u0026gt; table should match the \u0026lt;code\u0026gt;official category\u0026lt;\/code\u0026gt; from the \u0026lt;code\u0026gt;snowball_categories\u0026lt;\/code\u0026gt; table. Also the other conditions like \u0026lt;code\u0026gt;quantity\u0026lt;\/code\u0026gt; should be more than \u0026lt;code\u0026gt;0\u0026lt;\/code\u0026gt; and the \u0026lt;code\u0026gt;status\u0026lt;\/code\u0026gt; should be \u0026lt;code\u0026gt;ready\u0026lt;\/code\u0026gt;.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We will still need to group by and order by as the joins will basically be the filtering criteria in which to select or reject the bad categories. However to group by the category name and obtain the count of each category we need to group by the name of the category.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;plaintext\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-plaintext\u0026#34;\u0026gt;sqlite\u0026gt; SELECT snowball_categories.official_category AS official_category, SUM(snowball_inventory.quantity) AS total_usable_snowballs\nFROM snowball_categories\nLEFT JOIN snowball_inventory\n     ON snowball_categories.official_category = snowball_inventory.category_name\n     AND snowball_inventory.quantity \u0026gt; 0\n     AND snowball_inventory.status == \u0026#39;ready\u0026#39;\nGROUP BY official_category\nORDER BY total_usable_snowballs;\n\u002b---------------------------\u002b------------------------\u002b\n|     official_category     | total_usable_snowballs |\n\u002b---------------------------\u002b------------------------\u002b\n| arctic blast premium      | 11470                  |\n| everfrost training round  | 24248                  |\n| polar precision microball | 70773                  |\n| glacier sphere (xl)       | 165158                 |\n| north ridge compact       | 594119                 |\n| frost-flight deluxe       | 952019                 |\n\u002b---------------------------\u002b------------------------\u002b\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;This is it! The same thing that we did for the subquery. Just the filtering part is different.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;How about INNER JOIN?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;INNER JOIN\u0026lt;\/code\u0026gt; is different from \u0026lt;code\u0026gt;LEFT JOIN\u0026lt;\/code\u0026gt; as it will by default take only rows that match the condition, whereas \u0026lt;code\u0026gt;LEFT JOIN\u0026lt;\/code\u0026gt; will include records\/rows from the \u0026lt;code\u0026gt;LEFT\u0026lt;\/code\u0026gt; table even if they are empty or \u0026lt;code\u0026gt;NULL\u0026lt;\/code\u0026gt; . Similar is \u0026lt;code\u0026gt;RIGHT JOIN\u0026lt;\/code\u0026gt;, it will include everything from the RIGHT table even if that is \u0026lt;code\u0026gt;NULL\u0026lt;\/code\u0026gt; so that all the records from the \u0026lt;code\u0026gt;RIGHT\u0026lt;\/code\u0026gt; table are in the result set.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;For INNER JOIN if we flip the tables end it won\u0026#39;t matter, as it only relies on the condition and not on the order of where the tables are placed (left or right).\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT\n  snowball_categories.official_category AS official_category,\n  SUM(snowball_inventory.quantity) AS total_usable_snowballs\nFROM snowball_inventory\nJOIN snowball_categories\n  ON snowball_categories.official_category = snowball_inventory.category_name\n  AND snowball_inventory.quantity \u0026gt; 0\n  AND snowball_inventory.status = \u0026#39;ready\u0026#39;\nGROUP BY official_category\nORDER BY total_usable_snowballs;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;This is with INNER JOIN nothing changed here? did it?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;except the word \u0026lt;code\u0026gt;LEFT\u0026lt;\/code\u0026gt; is no longer there, the default join is \u0026lt;code\u0026gt;INNER JOIN\u0026lt;\/code\u0026gt; .\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;In our case i don\u0026#39;t think we have \u0026lt;code\u0026gt;NULL\u0026lt;\/code\u0026gt; values in the \u0026lt;code\u0026gt;snowball_categories\u0026lt;\/code\u0026gt; table or \u0026lt;code\u0026gt;snowball_inventory\u0026lt;\/code\u0026gt; table with the category name columns. So LEFT AND INNER JOIN won\u0026#39;t be different in terms of the results.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;plaintext\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-plaintext\u0026#34;\u0026gt;sqlite\u0026gt; SELECT\n  snowball_categories.official_category AS official_category,\n  SUM(snowball_inventory.quantity) AS total_usable_snowballs\nFROM snowball_inventory\nJOIN snowball_categories\n  ON snowball_categories.official_category = snowball_inventory.category_name\n  AND snowball_inventory.quantity \u0026gt; 0\n  AND snowball_inventory.status = \u0026#39;ready\u0026#39;\nGROUP BY official_category\nORDER BY total_usable_snowballs;\n\u002b---------------------------\u002b------------------------\u002b\n|     official_category     | total_usable_snowballs |\n\u002b---------------------------\u002b------------------------\u002b\n| arctic blast premium      | 11470                  |\n| everfrost training round  | 24248                  |\n| polar precision microball | 70773                  |\n| glacier sphere (xl)       | 165158                 |\n| north ridge compact       | 594119                 |\n| frost-flight deluxe       | 952019                 |\n\u002b---------------------------\u002b------------------------\u002b\nsqlite\u0026gt; \n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;However if we decide to make the \u0026lt;code\u0026gt;snowball_inventory\u0026lt;\/code\u0026gt; table as the \u0026lt;code\u0026gt;Left\u0026lt;\/code\u0026gt; table then does it make a difference?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Well we don\u0026#39;t want that to be the left table if we are doing a \u0026lt;code\u0026gt;LEFT\u0026lt;\/code\u0026gt; JOIN as it might list all the wrong categories in the result list as well even if they are not in the \u0026lt;code\u0026gt;official_category\u0026lt;\/code\u0026gt; those will be 0 or NULL but that would make a mess.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We instead can do a RIGHT JOIN.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;With the tables order as\u0026lt;\/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\n\u0026lt;p\u0026gt;snowball_inventory\u0026lt;\/p\u0026gt;\n\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;\n\u0026lt;p\u0026gt;snowball_categories\u0026lt;\/p\u0026gt;\n\u0026lt;\/li\u0026gt;\n\u0026lt;\/ol\u0026gt;\n\u0026lt;p\u0026gt;And we will RIGHT JOIN that is select all the columns from the right to be in the result set even if the condition is not true. It will be NULL. But the case is not true for here, as there are only 6 non-NULL category names in the snowball_categories table.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;\nSELECT                                                       \n  snowball_categories.official_category AS official_category,\n  SUM(snowball_inventory.quantity) AS total_usable_snowballs\nFROM snowball_inventory\nRIGHT JOIN snowball_categories\n  ON snowball_categories.official_category = snowball_inventory.category_name\n  AND snowball_inventory.quantity \u0026gt; 0\n  AND snowball_inventory.status = \u0026#39;ready\u0026#39;\nGROUP BY official_category\nORDER BY total_usable_snowballs;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;plaintext\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-plaintext\u0026#34;\u0026gt;sqlite\u0026gt; SELECT                                                       \n  snowball_categories.official_category AS official_category,\n  SUM(snowball_inventory.quantity) AS total_usable_snowballs\nFROM snowball_inventory\nRIGHT JOIN snowball_categories\n  ON snowball_categories.official_category = snowball_inventory.category_name\n  AND snowball_inventory.quantity \u0026gt; 0\n  AND snowball_inventory.status = \u0026#39;ready\u0026#39;\nGROUP BY official_category\nORDER BY total_usable_snowballs;\n\u002b---------------------------\u002b------------------------\u002b\n|     official_category     | total_usable_snowballs |\n\u002b---------------------------\u002b------------------------\u002b\n| arctic blast premium      | 11470                  |\n| everfrost training round  | 24248                  |\n| polar precision microball | 70773                  |\n| glacier sphere (xl)       | 165158                 |\n| north ridge compact       | 594119                 |\n| frost-flight deluxe       | 952019                 |\n\u002b---------------------------\u002b------------------------\u002b\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;However if we try to use \u0026lt;code\u0026gt;LEFT JOIN\u0026lt;\/code\u0026gt; with \u0026lt;code\u0026gt;snowball_inventory\u0026lt;\/code\u0026gt; as the \u0026lt;code\u0026gt;LEFT\u0026lt;\/code\u0026gt; table, we might get something wired.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT                                                \n  snowball_categories.official_category AS official_category,\n  SUM(snowball_inventory.quantity) AS total_usable_snowballs\nFROM snowball_inventory\nLEFT JOIN snowball_categories\n  ON snowball_categories.official_category = snowball_inventory.category_name\n  AND snowball_inventory.quantity \u0026gt; 0\n  AND snowball_inventory.status = \u0026#39;ready\u0026#39;\nGROUP BY official_category\nORDER BY total_usable_snowballs;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;We have 6 and 1 more category as empty ?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;That category is for all the rows that didn\u0026#39;t met the criteria of JOIN but still as asked to \u0026lt;code\u0026gt;LEFT JOIN\u0026lt;\/code\u0026gt; it will try to show the results for all the rows in the left table which is the \u0026lt;code\u0026gt;snowball_inventory\u0026lt;\/code\u0026gt; table.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;plaintext\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-plaintext\u0026#34;\u0026gt;\nsqlite\u0026gt; SELECT                                                \n  snowball_categories.official_category AS official_category,\n  SUM(snowball_inventory.quantity) AS total_usable_snowballs\nFROM snowball_inventory\nLEFT JOIN snowball_categories\n  ON snowball_categories.official_category = snowball_inventory.category_name\n  AND snowball_inventory.quantity \u0026gt; 0\n  AND snowball_inventory.status = \u0026#39;ready\u0026#39;\nGROUP BY official_category\nORDER BY total_usable_snowballs;\n\u002b---------------------------\u002b------------------------\u002b\n|     official_category     | total_usable_snowballs |\n\u002b---------------------------\u002b------------------------\u002b\n| arctic blast premium      | 11470                  |\n| everfrost training round  | 24248                  |\n| polar precision microball | 70773                  |\n| glacier sphere (xl)       | 165158                 |\n| north ridge compact       | 594119                 |\n| frost-flight deluxe       | 952019                 |\n|                           | 1692814                |\n\u002b---------------------------\u002b------------------------\u002b\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;h2 id=\u0026#34;timer\u0026#34;\u0026gt;Timer\u0026lt;\/h2\u0026gt;\n\u0026lt;p\u0026gt;Phew! Let\u0026#39;s see which one of them is the best one\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s see the timings:\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;plaintext\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-plaintext\u0026#34;\u0026gt;.timer on\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;h3 id=\u0026#34;subquery\u0026#34;\u0026gt;SUBQUERY\u0026lt;\/h3\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;plaintext\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-plaintext\u0026#34;\u0026gt;sqlite\u0026gt; SELECT category_name, SUM(quantity)AS total_usable_snowballs\nFROM snowball_inventory\nWHERE\n   category_name IN (SELECT official_category FROM snowball_categories)\n   AND quantity \u0026gt; 0\n   AND status == \u0026#39;ready\u0026#39;\nGROUP BY category_name\nORDER BY total_usable_snowballs;\n\u002b---------------------------\u002b------------------------\u002b\n|       category_name       | total_usable_snowballs |\n\u002b---------------------------\u002b------------------------\u002b\n| arctic blast premium      | 11470                  |\n| everfrost training round  | 24248                  |\n| polar precision microball | 70773                  |\n| glacier sphere (xl)       | 165158                 |\n| north ridge compact       | 594119                 |\n| frost-flight deluxe       | 952019                 |\n\u002b---------------------------\u002b------------------------\u002b\nRun Time: real 0.077 user 0.073886 sys 0.002942\n\nsqlite\u0026gt; \n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;h3 id=\u0026#34;left-join\u0026#34;\u0026gt;LEFT JOIN\u0026lt;\/h3\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;plaintext\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-plaintext\u0026#34;\u0026gt;sqlite\u0026gt;  SELECT snowball_categories.official_category AS official_category, SUM(snowball_inventory.quantity) AS total_usable_snowballs\nFROM snowball_categories\nLEFT JOIN snowball_inventory\n     ON snowball_categories.official_category = snowball_inventory.category_name \n     AND snowball_inventory.quantity \u0026gt; 0\n     AND snowball_inventory.status == \u0026#39;ready\u0026#39;\nGROUP BY official_category\nORDER BY total_usable_snowballs;\n\u002b---------------------------\u002b------------------------\u002b\n|     official_category     | total_usable_snowballs |\n\u002b---------------------------\u002b------------------------\u002b\n| arctic blast premium      | 11470                  |\n| everfrost training round  | 24248                  |\n| polar precision microball | 70773                  |\n| glacier sphere (xl)       | 165158                 |\n| north ridge compact       | 594119                 |\n| frost-flight deluxe       | 952019                 |\n\u002b---------------------------\u002b------------------------\u002b\nRun Time: real 0.182 user 0.171433 sys 0.009907\nsqlite\u0026gt; \n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;h3 id=\u0026#34;inner-join\u0026#34;\u0026gt;INNER JOIN\u0026lt;\/h3\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;plaintext\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-plaintext\u0026#34;\u0026gt;sqlite\u0026gt;  SELECT\n  snowball_categories.official_category AS official_category,\n  SUM(snowball_inventory.quantity) AS total_usable_snowballs\nFROM snowball_inventory\nJOIN snowball_categories\n  ON snowball_categories.official_category = snowball_inventory.category_name\n  AND snowball_inventory.quantity \u0026gt; 0\n  AND snowball_inventory.status = \u0026#39;ready\u0026#39;\nGROUP BY official_category\nORDER BY total_usable_snowballs;\n\u002b---------------------------\u002b------------------------\u002b\n|     official_category     | total_usable_snowballs |\n\u002b---------------------------\u002b------------------------\u002b\n| arctic blast premium      | 11470                  |\n| everfrost training round  | 24248                  |\n| polar precision microball | 70773                  |\n| glacier sphere (xl)       | 165158                 |\n| north ridge compact       | 594119                 |\n| frost-flight deluxe       | 952019                 |\n\u002b---------------------------\u002b------------------------\u002b\nRun Time: real 0.072 user 0.069623 sys 0.001929\nsqlite\u0026gt; \n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;h3 id=\u0026#34;right-join\u0026#34;\u0026gt;RIGHT JOIN\u0026lt;\/h3\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;plaintext\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-plaintext\u0026#34;\u0026gt;sqlite\u0026gt; SELECT                                                       \n  snowball_categories.official_category AS official_category,\n  SUM(snowball_inventory.quantity) AS total_usable_snowballs\nFROM snowball_inventory\nRIGHT JOIN snowball_categories\n  ON snowball_categories.official_category = snowball_inventory.category_name\n  AND snowball_inventory.quantity \u0026gt; 0\n  AND snowball_inventory.status = \u0026#39;ready\u0026#39;\nGROUP BY official_category\nORDER BY total_usable_snowballs;\n\u002b---------------------------\u002b------------------------\u002b\n|     official_category     | total_usable_snowballs |\n\u002b---------------------------\u002b------------------------\u002b\n| arctic blast premium      | 11470                  |\n| everfrost training round  | 24248                  |\n| polar precision microball | 70773                  |\n| glacier sphere (xl)       | 165158                 |\n| north ridge compact       | 594119                 |\n| frost-flight deluxe       | 952019                 |\n\u002b---------------------------\u002b------------------------\u002b\nRun Time: real 0.151 user 0.149690 sys 0.001957\n\nsqlite\u0026gt; \n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Time wise ranking:\u0026lt;\/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\n\u0026lt;p\u0026gt;INNER JOIN\u0026lt;\/p\u0026gt;\n\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;\n\u0026lt;p\u0026gt;SUBQUERY\u0026lt;\/p\u0026gt;\n\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;\n\u0026lt;p\u0026gt;RIGHT JOIN\u0026lt;\/p\u0026gt;\n\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;\n\u0026lt;p\u0026gt;LEFT JOIN\u0026lt;\/p\u0026gt;\n\u0026lt;\/li\u0026gt;\n\u0026lt;\/ol\u0026gt;\n\u0026lt;p\u0026gt;That\u0026#39;s quite quick, not much can be measured here. I am sure there are other ways to do this. But stopping here for today. Explored JOINs a little.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;See you for the day 3\u0026lt;\/p\u0026gt;\n"
    }
    </script>
    
    
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/code-block.css">
    <link rel="stylesheet" href="/post-navigation.css">
    
    <link rel="icon" href="/tbicon.png" type="image/png">
    <link rel="apple-touch-icon" href="/tbicon.png">
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link id="syntax-theme" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.13.0/sql-wasm.js"></script>
    <link rel="stylesheet" href="/sql-playground.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/monokai.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/sql/sql.min.js"></script>
    <script src="/sql-playground.js"></script>
    
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script>
    document.addEventListener("DOMContentLoaded", () => {
        const body = document.body;
        const stylesheet = document.getElementById("syntax-theme");
        const themeToggle = document.getElementById('theme-toggle');

        function setSyntaxTheme(theme) {
            if (theme === "secondary") {
                stylesheet.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css";
            } else {
                stylesheet.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css";
            }
        }

        
        document.querySelectorAll("pre code").forEach((block) => {
            hljs.highlightElement(block);
        });

        
        const currentTheme = localStorage.getItem("theme") || "default";
        if (currentTheme === "secondary") {
            body.classList.add("secondary-theme");
            if (themeToggle) themeToggle.checked = true;
        }
        setSyntaxTheme(currentTheme);

        
        if (themeToggle) {
            themeToggle.addEventListener('change', () => {
                const newTheme = themeToggle.checked ? 'secondary' : 'default';
                if (themeToggle.checked) {
                    body.classList.add('secondary-theme');
                } else {
                    body.classList.remove('secondary-theme');
                }
                localStorage.setItem('theme', newTheme);
                setSyntaxTheme(newTheme);
            });
        }
        
        
        const editBtn = document.getElementById('editor-edit');
        if (editBtn) {
            editBtn.addEventListener('click', async function () {
                const slug = "sqlog\/advent-of-sql-2025-day-2";
                const type = "sqlog";
                console.log("Editing post:", slug, type);
                const url = "https:\/\/devmeetgor.netlify.app/.netlify/functions/api?slug=" + slug + "&method=edit&type=" + type;
                
                try {
                    const res = await fetch(url);
                    if (!res.ok) throw new Error("Failed to fetch edit content");
                    const html = await res.text();
                    document.querySelector('.post-content').innerHTML = html;
                } catch (err) {
                    console.error(err);
                    alert("Error loading editor content");
                }
            });
        }
    });
    </script>
    
    
    <script src="/seasonal-effects.js" defer></script>
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EET2ZX4QY1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-EET2ZX4QY1');
    </script>
</head>
<body>
    <header class="header">
  <a class="site-title" href="/" aria-label="Meet Gor - Home">Meet Gor</a>
  <nav>
    <ul>
      <li><a href="/" aria-label="Home">Home</a></li>
      <li><a href="/posts" aria-label="Posts">Posts</a></li>
      <li><a href="/all-content" aria-label="All Content">All Content</a></li>
      <li><a href="/about" aria-label="About">About</a></li>
      <li><a href="/contact" aria-label="Contact">Contact</a></li>
    </ul>
  </nav>
  <div class="theme-switch">
    <input type="checkbox" id="theme-toggle" aria-label="Toggle Theme">
    <label for="theme-toggle"></label>
  </div>
  
    <button id="editor" onclick="location.href='/editor'" aria-label="Editor">
      Editor
    </button>
  
</header>
    
    <main class="container">
        <article class="blog-post">
            <h1>Advent of SQL 2025 Day 2: Snowballs</h1>
            
            <div class="post-meta">
                Published on 📅 <time datetime="2025-12-17 15:30 &#43;0530">2025-12-17 15:30 &#43;0530</time>
            </div>
            
            <div class="post-meta">
                Type: <a href="/sqlog">sqlog</a>
            </div>
            
            <div class="post-meta tags">
                <span class="post-series-label">🏷️ Tags:</span>
                
                <a href="/tags/sqlite">#sqlite</a>
                
                <a href="/tags/sql">#sql</a>
                
                <a href="/tags/advent-of-sql">#advent-of-sql</a>
                
            </div>
            
            
            <div class="post-series">
                <span class="series-label">Part of the
                <span class="series-list">
                    
                    <a href="/series/advent-of-sql-2025" class="series-link">📖 advent-of-sql-2025</a>
                    
                </span></span>
                <span class="series-label">series</span>
            </div>
            
            
            
            <div class="post-meta admin-controls">
                <button id="editor-edit">Edit</button>
                <button id="editor-delete" 
                        onclick="location.href='/editor/?slug=sqlog\/advent-of-sql-2025-day-2&method=delete'">
                    Delete
                </button>
            </div>
            
            
            <hr>
            
            <div class="post-content">
                <h2 id="sqlog-advent-of-sql-day-2">SQLog: Advent of SQL Day 2</h2>
<p>Here we are on the day 2 of Advent of SQL</p>
<p>As I said in the previous day this is in SQLite so I won't be doing it in the playground. So here is your SQLite playground :)</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT 1;
</code></pre><div class="output"></div></div><p>From now on no setup straight to the problem!</p>
<p>Let's download the .sql file for today's problem to see what data we are playing with.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">DROP TABLE IF EXISTS snowball_categories;
DROP TABLE IF EXISTS snowball_inventory;

CREATE TABLE snowball_categories (
    id INT PRIMARY KEY,
    official_category TEXT
);

CREATE TABLE snowball_inventory (
    id INT PRIMARY KEY,
    batch_id TEXT,
    category_name TEXT,
    quantity INT,
    status TEXT
);
</code></pre><div class="output"></div></div><p>Well, neat and clean!</p>
<p>Straight pulling it in the sqlite shell.</p>
<div class="code-block"><div class="code-header"><span class="language-name">plaintext</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-plaintext">$ sqlite3 
SQLite version 3.45.1 2024-01-30 16:01:20
Enter ".help" for usage hints.
Connected to a transient in-memory database.
Use ".open FILENAME" to reopen on a persistent database.
sqlite> .read day2-inserts.sql
sqlite> .schema
CREATE TABLE snowball_categories (
    id INT PRIMARY KEY,
    official_category TEXT
);
CREATE TABLE snowball_inventory (
    id INT PRIMARY KEY,
    batch_id TEXT,
    category_name TEXT,
    quantity INT,
    status TEXT
);
sqlite> 
</code></pre></div><p>Worked right off the bat.</p>
<p>Straight to problem now.</p>
<p>If you are working in the playground, do add this full code with inserts in order to get a sense of what the data looks like, note that this below statements is not all data, just sharing to get you a taste of the problem.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">DROP TABLE IF EXISTS snowball_categories;
DROP TABLE IF EXISTS snowball_inventory;

CREATE TABLE snowball_categories (
    id INT PRIMARY KEY,
    official_category TEXT
);

CREATE TABLE snowball_inventory (
    id INT PRIMARY KEY,
    batch_id TEXT,
    category_name TEXT,
    quantity INT,
    status TEXT
);

INSERT INTO snowball_categories (id, official_category) VALUES
    (1, 'frost-flight deluxe'),
    (2, 'north ridge compact'),
    (3, 'glacier sphere (xl)'),
    (4, 'polar precision microball'),
    (5, 'everfrost training round'),
    (6, 'arctic blast premium');

INSERT INTO snowball_inventory (id, batch_id, category_name, quantity, status) VALUES
    (1, 'BATCH-35443-J', 'frost-flight deluxe', 19, NULL),
    (2, 'BATCH-59767-M', 'frost-flight deluxe', 41, 'incomplete'),
    (3, 'BATCH-44795-B', 'frost-flight deluxe', 21, 'ready'),
    (4, 'BATCH-23396-C', 'north ridge compact', 0, 'incomplete'),
    (5, 'BATCH-88907-A', 'frost-flight deluxe', -2, 'incomplete'),
    (6, 'BATCH-42662-D', 'frost-flight deluxe', 47, 'needs review'),
    (7, 'BATCH-37460-V', 'north ridge compact', 43, 'ready'),
    (8, 'BATCH-21395-S', 'frost-flight deluxe', -2, 'ready'),
    (9, 'BATCH-36100-E', 'frost-flight deluxe', 46, 'ready'),
    (10, 'BATCH-64987-H', 'frost-flight deluxe', 43, NULL),
    (11, 'BATCH-57576-Z', 'melty deluxe', -5, 'ready'),
    (12, 'BATCH-56025-U', 'snowball v2', 11, 'ready'),
    (13, 'BATCH-86556-W', 'snowball v2', 12, 'ready'),
    (14, 'BATCH-83385-N', 'frost-flight deluxe', 38, 'incomplete'),
    (15, 'BATCH-85156-M', 'prototype x-12', 28, 'incomplete'),
    (16, 'BATCH-82135-F', 'north ridge compact', 32, 'incomplete'),
    (17, 'BATCH-10074-T', 'frost-flight deluxe', 49, 'needs review'),
    (18, 'BATCH-22676-L', 'frost-flight deluxe', 16, 'incomplete'),
    (19, 'BATCH-31174-R', 'north ridge compact', 33, 'incomplete'),
    (20, 'BATCH-41385-B', 'frost-flight deluxe', 4, 'ready'),
    (21, 'BATCH-50404-L', 'frost-flight deluxe', -4, 'needs review'),
    (22, 'BATCH-92240-F', 'north ridge compact', 20, 'ready'),
    (23, 'BATCH-29198-J', 'beta test sphere', 0, 'incomplete'),
    (24, 'BATCH-64987-H', 'glacier sphere (xl)', 18, 'needs review'),
    (25, 'BATCH-80008-A', 'frost-flight deluxe', 3, 'incomplete'),
    (26, 'BATCH-88907-A', 'polar precision microball', 48, 'incomplete'),
    (27, 'BATCH-55830-J', 'north ridge compact', 0, 'needs review'),
    (28, 'BATCH-69470-A', 'frost-flight deluxe', -3, 'incomplete'),
    (29, 'BATCH-46211-R', 'frost-flight deluxe', -3, 'ready'),
    (30, 'BATCH-18675-G', 'glacier sphere (xl)', -1, 'ready');
</code></pre><div class="output"></div></div><h2 id="problem">Problem</h2>
<p>Let's check the challenge of day 2</p>
<blockquote>
<p>Using the <code>snowball_inventory</code> and <code>snowball_categories</code> tables, write a query that returns valid snowball categories with the count of valid snowballs per category. Your final table should have the columns <code>official_category</code> and <code>total_usable_snowballs</code>. Sort the output from fewest to most <code>total_usable_snowballs</code>.</p>
</blockquote>
<p>So, we have two tables:</p>
<ol>
<li>
<p>snowball categories</p>
</li>
<li>
<p>snowball inventory</p>
</li>
</ol>
<p>The snowball categories looks a quite a small table with just the category name and the id which is not really the data, the name is.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT * FROM snowball_categories;
</code></pre><div class="output"></div></div><p>Just 6 entries with some names of the categories, the column is official categories.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">sqlite> SELECT * FROM snowball_categories;
+----+---------------------------+
| id |     official_category     |
+----+---------------------------+
| 1  | frost-flight deluxe       |
| 2  | north ridge compact       |
| 3  | glacier sphere (xl)       |
| 4  | polar precision microball |
| 5  | everfrost training round  |
| 6  | arctic blast premium      |
+----+---------------------------+
sqlite> 
</code></pre><div class="output"></div></div><p>And the other table has oddles of data:</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT * FROM snowball_inventory limit 10;
</code></pre><div class="output"></div></div><p>So, we have quite a few columns,</p>
<ol>
<li>
<p>batch_id</p>
</li>
<li>
<p>category_name</p>
</li>
<li>
<p>quantity</p>
</li>
<li>
<p>status</p>
</li>
</ol>
<p>It has 200,000 rows, that's quite a lot.</p>
<div class="code-block"><div class="code-header"><span class="language-name">plaintext</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-plaintext">sqlite> SELECT count(*) FROM snowball_inventory;
+----------+
| count(*) |
+----------+
| 200000   |
+----------+

sqlite> SELECT * FROM snowball_inventory limit 10;
+----+---------------+---------------------+----------+--------------+
| id |   batch_id    |    category_name    | quantity |    status    |
+----+---------------+---------------------+----------+--------------+
| 1  | BATCH-35443-J | frost-flight deluxe | 19       |              |
| 2  | BATCH-59767-M | frost-flight deluxe | 41       | incomplete   |
| 3  | BATCH-44795-B | frost-flight deluxe | 21       | ready        |
| 4  | BATCH-23396-C | north ridge compact | 0        | incomplete   |
| 5  | BATCH-88907-A | frost-flight deluxe | -2       | incomplete   |
| 6  | BATCH-42662-D | frost-flight deluxe | 47       | needs review |
| 7  | BATCH-37460-V | north ridge compact | 43       | ready        |
| 8  | BATCH-21395-S | frost-flight deluxe | -2       | ready        |
| 9  | BATCH-36100-E | frost-flight deluxe | 46       | ready        |
| 10 | BATCH-64987-H | frost-flight deluxe | 43       |              |
+----+---------------+---------------------+----------+--------------+
sqlite> 
</code></pre></div><p>What we have to do?</p>
<blockquote>
<p>return valid snowball categories with the count of valid snowballs per category</p>
</blockquote>
<p>That's a mouthful.</p>
<p>The problem is trying to get at counting the number of inventory items per category I think.</p>
<p>Because there are quite less categories and tons of inventory records.</p>
<p>Also the <code>category_name</code> in the <code>snowball_inventory</code> table is not trustworthy.</p>
<blockquote>
<p>Santa hurried to the snowball storage board, but the situation only got stranger. Whole batches appeared twice. Some batches claimed they had negative snowballs (“a bookkeeping accident,” the elves muttered). Others had a quantity of zero but were still marked “Ready.” And many batches referenced categories that didn’t appear anywhere in the official Snowball Category Guide</p>
</blockquote>
<h2 id="naive-approach">Naive Approach</h2>
<p>The first approach I see is scan through all the inventory records and check if the category is in the <code>snowball_category</code> table and its quantity is positive or more than 0, also I wonder if the status needs to be checked as <code>ready</code>.</p>
<blockquote>
<p>“We need to know what we actually have left,” Santa said. “Not puddles. Not phantom batches. Real, usable, throw-ready snowballs.”</p>
</blockquote>
<p><strong>Real, throw-ready snowballs</strong></p>
<p>Let's check how to do that with simple sub query.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT * FROM snowball_inventory
WHERE
   category_name IN (SELECT official_category FROM snowball_categories)
   AND quantity > 0
   AND status == 'ready';
</code></pre><div class="output"></div></div><p>OK!</p>
<p>What we did? Simply selected all the data from <code>snowball_inventory</code> table,</p>
<p>in which the category name is matching either of the 6 categories in the <code>snowball_categories</code> table.</p>
<p>Also the quantity is positive and not zero, also the status is set to be <code>ready</code>.</p>
<p>This looks naive to me for using subquery because for each 200,000 records we will scan the <code>snowball_categories</code> . Ew!</p>
<p>Wait its done! We need the count of each category! We need to group by the <code>category_name</code></p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT * FROM snowball_inventory
WHERE
   category_name IN (SELECT official_category FROM snowball_categories)
   AND quantity > 0
   AND status == 'ready'
GROUP BY category_name;
</code></pre><div class="output"></div></div><div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">sqlite> SELECT * FROM snowball_inventory
WHERE
   category_name IN (SELECT official_category FROM snowball_categories)
   AND quantity > 0
   AND status == 'ready'
GROUP BY category_name;
+-----+---------------+---------------------------+----------+--------+
| id  |   batch_id    |       category_name       | quantity | status |
+-----+---------------+---------------------------+----------+--------+
| 240 | BATCH-55793-L | arctic blast premium      | 45       | ready  |
| 163 | BATCH-75333-O | everfrost training round  | 23       | ready  |
| 3   | BATCH-44795-B | frost-flight deluxe       | 21       | ready  |
| 39  | BATCH-22704-V | glacier sphere (xl)       | 37       | ready  |
| 7   | BATCH-37460-V | north ridge compact       | 43       | ready  |
| 125 | BATCH-81987-E | polar precision microball | 47       | ready  |
+-----+---------------+---------------------------+----------+--------+
</code></pre><div class="output"></div></div><p>That sort of looks wired right?</p>
<p>Why?</p>
<p>Because what happens to the quantity? Is that summed? averaged, or what just happened to the batch_id?</p>
<p>No it takes one value out of the <code>200 000</code> rows for each category. That's not what we want right?</p>
<p>We want this</p>
<blockquote>
<p>return valid snowball categories with the count of valid snowballs per category</p>
</blockquote>
<p>So, we just want the category name and the count of those category. Basically count per category.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT category_name as official_category, sum(quantity) as total_usable_snowballs
FROM snowball_inventory 
WHERE
   category_name IN (SELECT official_category FROM snowball_categories)
   AND quantity > 0
   AND status == 'ready'
GROUP BY category_name;
</code></pre><div class="output"></div></div><p>Here we are only fetching the <code>category_name</code> and the <code>count</code> which will bundle up all the counts from the grouped of the category_name.</p>
<div class="code-block"><div class="code-header"><span class="language-name">plaintext</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-plaintext">sqlite> SELECT category_name as official_category, sum(quantity) as total_usable_snowballs 
FROM snowball_inventory 
WHERE
   category_name IN (SELECT official_category FROM snowball_categories)
   AND quantity > 0
   AND status == 'ready'
GROUP BY category_name;
+---------------------------+------------------------+
|     official_category     | total_usable_snowballs |
+---------------------------+------------------------+
| arctic blast premium      | 11470                  |
| everfrost training round  | 24248                  |
| frost-flight deluxe       | 952019                 |
| glacier sphere (xl)       | 165158                 |
| north ridge compact       | 594119                 |
| polar precision microball | 70773                  |
+---------------------------+------------------------+
sqlite> 

</code></pre></div><p>Not done yet!</p>
<p>We need to order by the count.</p>
<blockquote>
<p>Sort the output from fewest to most <code>total_usable_snowballs</code>.</p>
</blockquote>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT category_name, sum(quantity)  as total_usable_snowballs
FROM snowball_inventory
WHERE
   category_name IN (SELECT official_category FROM snowball_categories)
   AND quantity > 0
   AND status == 'ready'
GROUP BY category_name
ORDER BY total_usable_snowballs;
</code></pre><div class="output"></div></div><p>We can provide <code>ORDER BY total_usable_snowballs ASC</code> but ascending is default. I prefer keeping things default, you can be explicit and mention it as <code>ASC</code> to make it clear and readable.</p>
<div class="code-block"><div class="code-header"><span class="language-name">plaintext</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-plaintext">sqlite> SELECT category_name as official_category, sum(quantity) as total_usable_snowballs
FROM snowball_inventory 
WHERE
   category_name IN (SELECT official_category FROM snowball_categories)
   AND quantity > 0
   AND status == 'ready'
GROUP BY category_name
ORDER BY total_usable_snowballs;
+---------------------------+------------------------+
|     official_category     | total_usable_snowballs |
+---------------------------+------------------------+
| arctic blast premium      | 11470                  |
| everfrost training round  | 24248                  |
| polar precision microball | 70773                  |
| glacier sphere (xl)       | 165158                 |
| north ridge compact       | 594119                 |
| frost-flight deluxe       | 952019                 |
+---------------------------+------------------------+

sqlite> 
</code></pre></div><p>There it is!</p>
<p>The solution to the day 2.</p>
<p>But Santa, I am using subqueries. Is that fine?</p>
<h2 id="joins">Joins?</h2>
<p>We can use joins here, since we just require the count of each category.</p>
<p>Which JOIN though?</p>
<p>LEFT, RIGHT, INNER?</p>
<p>any really?</p>
<p>You don't choose the join based on the problem, you define your output columns and then choose the type of join that would give you the result.</p>
<p>If the thing that is to be searched from left to right and then its a left join, i.e. join everything from the left. and so on.</p>
<p>Here,</p>
<p>I need all the <code>official_category</code> column right, which is in the <code>snowball_categories</code> table.</p>
<p>If I assume the <code>snowball_categories</code> is on the left, I can join everything for that row in the left to match all the <code>category_name</code> rows in the <code>snowball_inventory</code> table which would be in the right. Like so.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT 
    snowball_categories.official_category as official_category,
    SUM(snowball_inventory.quantity) as total_usable_snowballs
FROM snowball_categories
LEFT JOIN snowball_inventory
     ON snowball_categories.official_category = snowball_inventory.category_name
     AND snowball_inventory.quantity > 0
     AND snowball_inventory.status == 'ready'
GROUP BY official_category
ORDER BY total_usable_snowballs;
</code></pre><div class="output"></div></div><p>We JOIN on the condition of <code>snowball_categories.official_category = snowball_inventory.category_name</code> which is to say, the <code>category_name</code> in the <code>snowball_inventory</code> table should match the <code>official category</code> from the <code>snowball_categories</code> table. Also the other conditions like <code>quantity</code> should be more than <code>0</code> and the <code>status</code> should be <code>ready</code>.</p>
<p>We will still need to group by and order by as the joins will basically be the filtering criteria in which to select or reject the bad categories. However to group by the category name and obtain the count of each category we need to group by the name of the category.</p>
<div class="code-block"><div class="code-header"><span class="language-name">plaintext</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-plaintext">sqlite> SELECT snowball_categories.official_category AS official_category, SUM(snowball_inventory.quantity) AS total_usable_snowballs
FROM snowball_categories
LEFT JOIN snowball_inventory
     ON snowball_categories.official_category = snowball_inventory.category_name
     AND snowball_inventory.quantity > 0
     AND snowball_inventory.status == 'ready'
GROUP BY official_category
ORDER BY total_usable_snowballs;
+---------------------------+------------------------+
|     official_category     | total_usable_snowballs |
+---------------------------+------------------------+
| arctic blast premium      | 11470                  |
| everfrost training round  | 24248                  |
| polar precision microball | 70773                  |
| glacier sphere (xl)       | 165158                 |
| north ridge compact       | 594119                 |
| frost-flight deluxe       | 952019                 |
+---------------------------+------------------------+
</code></pre></div><p>This is it! The same thing that we did for the subquery. Just the filtering part is different.</p>
<p>How about INNER JOIN?</p>
<p><code>INNER JOIN</code> is different from <code>LEFT JOIN</code> as it will by default take only rows that match the condition, whereas <code>LEFT JOIN</code> will include records/rows from the <code>LEFT</code> table even if they are empty or <code>NULL</code> . Similar is <code>RIGHT JOIN</code>, it will include everything from the RIGHT table even if that is <code>NULL</code> so that all the records from the <code>RIGHT</code> table are in the result set.</p>
<p>For INNER JOIN if we flip the tables end it won't matter, as it only relies on the condition and not on the order of where the tables are placed (left or right).</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT
  snowball_categories.official_category AS official_category,
  SUM(snowball_inventory.quantity) AS total_usable_snowballs
FROM snowball_inventory
JOIN snowball_categories
  ON snowball_categories.official_category = snowball_inventory.category_name
  AND snowball_inventory.quantity > 0
  AND snowball_inventory.status = 'ready'
GROUP BY official_category
ORDER BY total_usable_snowballs;
</code></pre><div class="output"></div></div><p>This is with INNER JOIN nothing changed here? did it?</p>
<p>except the word <code>LEFT</code> is no longer there, the default join is <code>INNER JOIN</code> .</p>
<p>In our case i don't think we have <code>NULL</code> values in the <code>snowball_categories</code> table or <code>snowball_inventory</code> table with the category name columns. So LEFT AND INNER JOIN won't be different in terms of the results.</p>
<div class="code-block"><div class="code-header"><span class="language-name">plaintext</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-plaintext">sqlite> SELECT
  snowball_categories.official_category AS official_category,
  SUM(snowball_inventory.quantity) AS total_usable_snowballs
FROM snowball_inventory
JOIN snowball_categories
  ON snowball_categories.official_category = snowball_inventory.category_name
  AND snowball_inventory.quantity > 0
  AND snowball_inventory.status = 'ready'
GROUP BY official_category
ORDER BY total_usable_snowballs;
+---------------------------+------------------------+
|     official_category     | total_usable_snowballs |
+---------------------------+------------------------+
| arctic blast premium      | 11470                  |
| everfrost training round  | 24248                  |
| polar precision microball | 70773                  |
| glacier sphere (xl)       | 165158                 |
| north ridge compact       | 594119                 |
| frost-flight deluxe       | 952019                 |
+---------------------------+------------------------+
sqlite> 
</code></pre></div><p>However if we decide to make the <code>snowball_inventory</code> table as the <code>Left</code> table then does it make a difference?</p>
<p>Well we don't want that to be the left table if we are doing a <code>LEFT</code> JOIN as it might list all the wrong categories in the result list as well even if they are not in the <code>official_category</code> those will be 0 or NULL but that would make a mess.</p>
<p>We instead can do a RIGHT JOIN.</p>
<p>With the tables order as</p>
<ol>
<li>
<p>snowball_inventory</p>
</li>
<li>
<p>snowball_categories</p>
</li>
</ol>
<p>And we will RIGHT JOIN that is select all the columns from the right to be in the result set even if the condition is not true. It will be NULL. But the case is not true for here, as there are only 6 non-NULL category names in the snowball_categories table.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">
SELECT                                                       
  snowball_categories.official_category AS official_category,
  SUM(snowball_inventory.quantity) AS total_usable_snowballs
FROM snowball_inventory
RIGHT JOIN snowball_categories
  ON snowball_categories.official_category = snowball_inventory.category_name
  AND snowball_inventory.quantity > 0
  AND snowball_inventory.status = 'ready'
GROUP BY official_category
ORDER BY total_usable_snowballs;
</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name">plaintext</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-plaintext">sqlite> SELECT                                                       
  snowball_categories.official_category AS official_category,
  SUM(snowball_inventory.quantity) AS total_usable_snowballs
FROM snowball_inventory
RIGHT JOIN snowball_categories
  ON snowball_categories.official_category = snowball_inventory.category_name
  AND snowball_inventory.quantity > 0
  AND snowball_inventory.status = 'ready'
GROUP BY official_category
ORDER BY total_usable_snowballs;
+---------------------------+------------------------+
|     official_category     | total_usable_snowballs |
+---------------------------+------------------------+
| arctic blast premium      | 11470                  |
| everfrost training round  | 24248                  |
| polar precision microball | 70773                  |
| glacier sphere (xl)       | 165158                 |
| north ridge compact       | 594119                 |
| frost-flight deluxe       | 952019                 |
+---------------------------+------------------------+
</code></pre></div><p>However if we try to use <code>LEFT JOIN</code> with <code>snowball_inventory</code> as the <code>LEFT</code> table, we might get something wired.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT                                                
  snowball_categories.official_category AS official_category,
  SUM(snowball_inventory.quantity) AS total_usable_snowballs
FROM snowball_inventory
LEFT JOIN snowball_categories
  ON snowball_categories.official_category = snowball_inventory.category_name
  AND snowball_inventory.quantity > 0
  AND snowball_inventory.status = 'ready'
GROUP BY official_category
ORDER BY total_usable_snowballs;
</code></pre><div class="output"></div></div><p>We have 6 and 1 more category as empty ?</p>
<p>That category is for all the rows that didn't met the criteria of JOIN but still as asked to <code>LEFT JOIN</code> it will try to show the results for all the rows in the left table which is the <code>snowball_inventory</code> table.</p>
<div class="code-block"><div class="code-header"><span class="language-name">plaintext</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-plaintext">
sqlite> SELECT                                                
  snowball_categories.official_category AS official_category,
  SUM(snowball_inventory.quantity) AS total_usable_snowballs
FROM snowball_inventory
LEFT JOIN snowball_categories
  ON snowball_categories.official_category = snowball_inventory.category_name
  AND snowball_inventory.quantity > 0
  AND snowball_inventory.status = 'ready'
GROUP BY official_category
ORDER BY total_usable_snowballs;
+---------------------------+------------------------+
|     official_category     | total_usable_snowballs |
+---------------------------+------------------------+
| arctic blast premium      | 11470                  |
| everfrost training round  | 24248                  |
| polar precision microball | 70773                  |
| glacier sphere (xl)       | 165158                 |
| north ridge compact       | 594119                 |
| frost-flight deluxe       | 952019                 |
|                           | 1692814                |
+---------------------------+------------------------+
</code></pre></div><h2 id="timer">Timer</h2>
<p>Phew! Let's see which one of them is the best one</p>
<p>Let's see the timings:</p>
<div class="code-block"><div class="code-header"><span class="language-name">plaintext</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-plaintext">.timer on
</code></pre></div><h3 id="subquery">SUBQUERY</h3>
<div class="code-block"><div class="code-header"><span class="language-name">plaintext</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-plaintext">sqlite> SELECT category_name, SUM(quantity)AS total_usable_snowballs
FROM snowball_inventory
WHERE
   category_name IN (SELECT official_category FROM snowball_categories)
   AND quantity > 0
   AND status == 'ready'
GROUP BY category_name
ORDER BY total_usable_snowballs;
+---------------------------+------------------------+
|       category_name       | total_usable_snowballs |
+---------------------------+------------------------+
| arctic blast premium      | 11470                  |
| everfrost training round  | 24248                  |
| polar precision microball | 70773                  |
| glacier sphere (xl)       | 165158                 |
| north ridge compact       | 594119                 |
| frost-flight deluxe       | 952019                 |
+---------------------------+------------------------+
Run Time: real 0.077 user 0.073886 sys 0.002942

sqlite> 
</code></pre></div><h3 id="left-join">LEFT JOIN</h3>
<div class="code-block"><div class="code-header"><span class="language-name">plaintext</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-plaintext">sqlite>  SELECT snowball_categories.official_category AS official_category, SUM(snowball_inventory.quantity) AS total_usable_snowballs
FROM snowball_categories
LEFT JOIN snowball_inventory
     ON snowball_categories.official_category = snowball_inventory.category_name 
     AND snowball_inventory.quantity > 0
     AND snowball_inventory.status == 'ready'
GROUP BY official_category
ORDER BY total_usable_snowballs;
+---------------------------+------------------------+
|     official_category     | total_usable_snowballs |
+---------------------------+------------------------+
| arctic blast premium      | 11470                  |
| everfrost training round  | 24248                  |
| polar precision microball | 70773                  |
| glacier sphere (xl)       | 165158                 |
| north ridge compact       | 594119                 |
| frost-flight deluxe       | 952019                 |
+---------------------------+------------------------+
Run Time: real 0.182 user 0.171433 sys 0.009907
sqlite> 
</code></pre></div><h3 id="inner-join">INNER JOIN</h3>
<div class="code-block"><div class="code-header"><span class="language-name">plaintext</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-plaintext">sqlite>  SELECT
  snowball_categories.official_category AS official_category,
  SUM(snowball_inventory.quantity) AS total_usable_snowballs
FROM snowball_inventory
JOIN snowball_categories
  ON snowball_categories.official_category = snowball_inventory.category_name
  AND snowball_inventory.quantity > 0
  AND snowball_inventory.status = 'ready'
GROUP BY official_category
ORDER BY total_usable_snowballs;
+---------------------------+------------------------+
|     official_category     | total_usable_snowballs |
+---------------------------+------------------------+
| arctic blast premium      | 11470                  |
| everfrost training round  | 24248                  |
| polar precision microball | 70773                  |
| glacier sphere (xl)       | 165158                 |
| north ridge compact       | 594119                 |
| frost-flight deluxe       | 952019                 |
+---------------------------+------------------------+
Run Time: real 0.072 user 0.069623 sys 0.001929
sqlite> 
</code></pre></div><h3 id="right-join">RIGHT JOIN</h3>
<div class="code-block"><div class="code-header"><span class="language-name">plaintext</span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code class="language-plaintext">sqlite> SELECT                                                       
  snowball_categories.official_category AS official_category,
  SUM(snowball_inventory.quantity) AS total_usable_snowballs
FROM snowball_inventory
RIGHT JOIN snowball_categories
  ON snowball_categories.official_category = snowball_inventory.category_name
  AND snowball_inventory.quantity > 0
  AND snowball_inventory.status = 'ready'
GROUP BY official_category
ORDER BY total_usable_snowballs;
+---------------------------+------------------------+
|     official_category     | total_usable_snowballs |
+---------------------------+------------------------+
| arctic blast premium      | 11470                  |
| everfrost training round  | 24248                  |
| polar precision microball | 70773                  |
| glacier sphere (xl)       | 165158                 |
| north ridge compact       | 594119                 |
| frost-flight deluxe       | 952019                 |
+---------------------------+------------------------+
Run Time: real 0.151 user 0.149690 sys 0.001957

sqlite> 
</code></pre></div><p>Time wise ranking:</p>
<ol>
<li>
<p>INNER JOIN</p>
</li>
<li>
<p>SUBQUERY</p>
</li>
<li>
<p>RIGHT JOIN</p>
</li>
<li>
<p>LEFT JOIN</p>
</li>
</ol>
<p>That's quite quick, not much can be measured here. I am sure there are other ways to do this. But stopping here for today. Explored JOINs a little.</p>
<p>See you for the day 3</p>

            </div>
        </article>
        
        
        

<nav class="post-navigation" aria-label="Post Navigation">
    <div class="nav-container">
        
        
        <a href="/sqlog/advent-of-sql-2025-day-1" class="nav-link nav-prev" title="Previous Post">
            <span class="nav-arrow">←</span>
            <span class="nav-label">Previous</span>
            <span class="nav-title">Advent of SQL 2025: Wish List</span>
        </a>
        

        
        
        <a href="/sqlog/advent-of-sql-2025-day-3" class="nav-link nav-next" title="Next Post">
            <span class="nav-label">Next</span>
            <span class="nav-title">Advent of SQL 2025 Day 3: Hotline Messages</span>
            <span class="nav-arrow">→</span>
        </a>
        
    </div>
</nav>


        
        
        


<aside class="related-reading" aria-labelledby="related-reading-title">
    <h3 id="related-reading-title" class="related-title">📚 Related Reading</h3>
    <ul class="related-list">
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-15" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 15: Confirmation Phrase Dispatches</span>
                <span class="related-post-date">2025-12-28 20:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-14" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 14: Ski Resort Paths</span>
                <span class="related-post-date">2025-12-28 15:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-13" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 13: XML Travel Manifests</span>
                <span class="related-post-date">2025-12-27 20:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-12" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 12: Archive Flight Records</span>
                <span class="related-post-date">2025-12-27 15:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-11" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 11: Behavior Score</span>
                <span class="related-post-date">2025-12-26 15:30 &#43;0530</span>
            </a>
        </li>
        
        
    </ul>
</aside>


    </main>
    
    <div id="comments">
        <script src="https://giscus.app/client.js"
            data-repo="Mr-Destructive/meetgor.com"
            data-repo-id="R_kgDOHZ6V_g"
            data-category="Q&A"
            data-category-id="DIC_kwDOHZ6V_s4CRfn4"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="bottom"
            data-theme="dark_high_contrast"
            data-lang="en"
            crossorigin="anonymous"
            async>
        </script>
    </div>
    
    <footer class="site-footer" role="contentinfo">
  <div class="footer-content">
    <p>&copy; Meet Gor. All rights reserved.</p>
    <div class="social-links">
      <a href="/contact" aria-label="Connect with me">Connect with me</a>
    </div>
  </div>
</footer>
    
</body>
</html>
