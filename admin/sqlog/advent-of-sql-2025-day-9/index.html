<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <title>Advent of SQL 2025 Day 9: Evergreen Market Orders | Meet Gor</title>
    <meta name="title" content="Advent of SQL 2025 Day 9: Evergreen Market Orders | Meet Gor">
    <meta name="description" content="">
    <meta name="author" content="Meet Gor">
    <meta name="keywords" content="sqlite, sql, advent-of-sql">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://meetgor.com/sqlog/advent-of-sql-2025-day-9">
    
    
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://meetgor.com/sqlog/advent-of-sql-2025-day-9">
    <meta property="og:title" content="Advent of SQL 2025 Day 9: Evergreen Market Orders">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://meetgor.com/tbicon.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Advent of SQL 2025 Day 9: Evergreen Market Orders">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Meet Gor">
    <meta property="article:published_time" content="2025-12-24 15:30 &#43;0530">
    <meta property="article:modified_time" content="2025-12-24 15:30 &#43;0530">
    <meta property="article:author" content="Meet Gor">
    
    <meta property="article:tag" content="sqlite">
    
    <meta property="article:tag" content="sql">
    
    <meta property="article:tag" content="advent-of-sql">
    
    
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@meetgor711">
    <meta name="twitter:creator" content="@meetgor711">
    <meta name="twitter:url" content="https://meetgor.com/sqlog/advent-of-sql-2025-day-9">
    <meta name="twitter:title" content="Advent of SQL 2025 Day 9: Evergreen Market Orders">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="https://meetgor.com/tbicon.png">
    <meta name="twitter:image:alt" content="Advent of SQL 2025 Day 9: Evergreen Market Orders">
    
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/meetgor.com/sqlog\/advent-of-sql-2025-day-9"
        },
        "headline": "Advent of SQL 2025 Day 9: Evergreen Market Orders",
        "description": "",
        "datePublished": "2025-12-24 15:30 \u002b0530",
        "dateModified": "2025-12-24 15:30 \u002b0530",
        "author": {
            "@type": "Person",
            "name": "Meet Gor"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Meet Gor",
            "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/meetgor.com/tbicon.png"
            }
        },
        
        "keywords": "sqlite, sql, advent-of-sql",
        "articleBody": "\u0026lt;h2 id=\u0026#34;advent-of-sql-day-9---evergreen-market-orders\u0026#34;\u0026gt;Advent of SQL, Day 9 - Evergreen Market Orders\u0026lt;\/h2\u0026gt;\n\u0026lt;p\u0026gt;We are on day 9 of advent of SQL, and I feel good so far.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s see what we learn today?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s get the inserts for the day.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; .read day9-inserts.sql\nsqlite\u0026gt; .schema\nCREATE TABLE orders (\n    id           INT PRIMARY KEY,\n    customer_id  INT,\n    created_at   TIMESTAMP,\n    order_data   JSONB\n);\nsqlite\u0026gt; .mode table\nsqlite\u0026gt; SELECT * FROM orders limit 10;\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b\n| id | customer_id |     created_at      |                          order_data                          |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b\n| 1  | 1           | 2025-11-21 13:08:22 | {\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: tru |\n|    |             |                     | e}}                                                          |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b\n| 2  | 1           | 2025-11-21 18:42:58 | {\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;overnight\u0026#34;}, \u0026#34;risk\u0026#34;: {\u0026#34;flag\u0026#34;: \u0026#34;high |\n|    |             |                     | \u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: false}}                              |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b\n| 3  | 1           | 2025-11-21 21:01:46 | {\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: fal |\n|    |             |                     | se}}                                                         |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b\n| 4  | 1           | 2025-11-24 13:17:27 | {\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: tru |\n|    |             |                     | e}}                                                          |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b\n| 5  | 1           | 2025-11-24 21:09:46 | {\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;overnight\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: fa |\n|    |             |                     | lse}}                                                        |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b\n| 6  | 1           | 2025-11-25 07:24:55 | {\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;risk\u0026#34;: {\u0026#34;flag\u0026#34;: \u0026#34;mediu |\n|    |             |                     | m\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: true}}                              |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b\n| 7  | 1           | 2025-11-25 17:42:36 | {\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: fal |\n|    |             |                     | se}}                                                         |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b\n| 8  | 1           | 2025-11-27 02:34:24 | {\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;express\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: true |\n|    |             |                     | }}                                                           |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b\n| 9  | 1           | 2025-11-30 22:43:54 | {\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;overnight\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: tr |\n|    |             |                     | ue}}                                                         |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b\n| 10 | 1           | 2025-12-01 04:03:33 | {\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;express\u0026#34;}, \u0026#34;risk\u0026#34;: {\u0026#34;flag\u0026#34;: \u0026#34;medium |\n|    |             |                     | \u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: false}}                              |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b\nsqlite\u0026gt; \n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Looks like we will deal with JSON today, seems exciting. I haven\u0026#39;t dealt with JSON in SQLite yet, today will break it.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s get some sample inserts for you to play in the browser.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;LIMITING TO 20, there are more than 400 rows!\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;DROP TABLE IF EXISTS orders;\n\nCREATE TABLE orders (\n    id           INT PRIMARY KEY,\n    customer_id  INT,\n    created_at   TIMESTAMP,\n    order_data   JSONB\n);\n\nINSERT INTO orders (id, customer_id, created_at, order_data) VALUES\n    (1, 1, \u0026#39;2025-11-21 13:08:22\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: true}}\u0026#39;),\n    (2, 1, \u0026#39;2025-11-21 18:42:58\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;overnight\u0026#34;}, \u0026#34;risk\u0026#34;: {\u0026#34;flag\u0026#34;: \u0026#34;high\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: false}}\u0026#39;),\n    (3, 1, \u0026#39;2025-11-21 21:01:46\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: false}}\u0026#39;),\n    (4, 1, \u0026#39;2025-11-24 13:17:27\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: true}}\u0026#39;),\n    (5, 1, \u0026#39;2025-11-24 21:09:46\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;overnight\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: false}}\u0026#39;),\n    (6, 1, \u0026#39;2025-11-25 07:24:55\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;risk\u0026#34;: {\u0026#34;flag\u0026#34;: \u0026#34;medium\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: true}}\u0026#39;),\n    (7, 1, \u0026#39;2025-11-25 17:42:36\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: false}}\u0026#39;),\n    (8, 1, \u0026#39;2025-11-27 02:34:24\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;express\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: true}}\u0026#39;),\n    (9, 1, \u0026#39;2025-11-30 22:43:54\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;overnight\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: true}}\u0026#39;),\n    (10, 1, \u0026#39;2025-12-01 04:03:33\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;express\u0026#34;}, \u0026#34;risk\u0026#34;: {\u0026#34;flag\u0026#34;: \u0026#34;medium\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: false}}\u0026#39;),\n    (11, 1, \u0026#39;2025-12-02 05:19:10\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;overnight\u0026#34;}, \u0026#34;risk\u0026#34;: {\u0026#34;flag\u0026#34;: \u0026#34;low\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: true}}\u0026#39;),\n    (12, 1, \u0026#39;2025-12-03 16:25:56\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;overnight\u0026#34;}, \u0026#34;risk\u0026#34;: {\u0026#34;flag\u0026#34;: \u0026#34;medium\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: true}}\u0026#39;),\n    (13, 1, \u0026#39;2025-12-10 19:34:28\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: false}}\u0026#39;),\n    (14, 1, \u0026#39;2025-12-16 19:23:53\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;express\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: false}}\u0026#39;),\n    (15, 2, \u0026#39;2025-11-23 19:11:23\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;overnight\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: true}}\u0026#39;),\n    (16, 2, \u0026#39;2025-11-28 15:23:27\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;express\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: true}}\u0026#39;),\n    (17, 2, \u0026#39;2025-11-30 12:05:36\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;overnight\u0026#34;}, \u0026#34;risk\u0026#34;: {\u0026#34;flag\u0026#34;: \u0026#34;low\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: true}}\u0026#39;),\n    (18, 2, \u0026#39;2025-12-03 07:03:06\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: false}}\u0026#39;),\n    (19, 2, \u0026#39;2025-12-07 13:55:13\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;express\u0026#34;}, \u0026#34;risk\u0026#34;: {\u0026#34;flag\u0026#34;: \u0026#34;high\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: false}}\u0026#39;),\n    (20, 2, \u0026#39;2025-12-08 07:17:31\u0026#39;, \u0026#39;{\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: false}}\u0026#39;);\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT * FROM orders;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Let\u0026#39;s get to the problem now.\u0026lt;\/p\u0026gt;\n\u0026lt;h2 id=\u0026#34;problem\u0026#34;\u0026gt;Problem\u0026lt;\/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Build a report using the orders table that shows the latest order for each customer, along with their requested shipping method, gift wrap choice (as true or false), and the risk flag in separate columns.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Order the report by the most recent order first so Evergreen Market can reach out to them ASAP.\u0026lt;\/p\u0026gt;\n\u0026lt;\/blockquote\u0026gt;\n\u0026lt;p\u0026gt;Ok, so we need for each customer the latest order with the following details:\u0026lt;\/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;shipping method\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;gift wrap choice\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;risk flag\u0026lt;\/li\u0026gt;\n\u0026lt;\/ul\u0026gt;\n\u0026lt;p\u0026gt;These all I think are in the same column as a JSON string or blob. We need to extract those out from the column.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s first check the \u0026lt;code\u0026gt;orders\u0026lt;\/code\u0026gt; table.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;It has a few columns:\u0026lt;\/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;id\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;customer_id\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;created_at\u0026lt;\/li\u0026gt;\n\u0026lt;li\u0026gt;order_data\u0026lt;\/li\u0026gt;\n\u0026lt;\/ul\u0026gt;\n\u0026lt;p\u0026gt;We do require the \u0026lt;code\u0026gt;order_data\u0026lt;\/code\u0026gt; as that is the column that has JSON.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Also the problem said to give the most recent order, so we need to order by \u0026lt;code\u0026gt;created_at\u0026lt;\/code\u0026gt; in a reverse way, the latest first. Also we need it per customer, so we need to group by \u0026lt;code\u0026gt;customer_id\u0026lt;\/code\u0026gt;.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s see how to get the data inside JSON in SQLite.\u0026lt;\/p\u0026gt;\n\u0026lt;h3 id=\u0026#34;json-extract\u0026#34;\u0026gt;JSON Extract\u0026lt;\/h3\u0026gt;\n\u0026lt;p\u0026gt;Well we have \u0026lt;a href=\u0026#34;https:\/\/sqlite.org\/json1.html#jex\u0026#34;\u0026gt;json_extract\u0026lt;\/a\u0026gt; which can give us the value of the key from the given json data string.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;The function takes in the column name from the table which would be the column containing the json data and then the second parameter is the path to the key, in this case if we want to get the \u0026lt;code\u0026gt;method\u0026lt;\/code\u0026gt; from the \u0026lt;code\u0026gt;shipping\u0026lt;\/code\u0026gt; key, we can use \u0026lt;code\u0026gt;$.shipping.method\u0026lt;\/code\u0026gt; which means from the root \u0026lt;code\u0026gt;$\u0026lt;\/code\u0026gt; get the \u0026lt;code\u0026gt;shipping\u0026lt;\/code\u0026gt; key, and inside that (\u0026lt;code\u0026gt;shipping\u0026lt;\/code\u0026gt; key) give the value inside the \u0026lt;code\u0026gt;method\u0026lt;\/code\u0026gt; key.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;If the path is not present, in our case the \u0026lt;code\u0026gt;risk\u0026lt;\/code\u0026gt;  key is very rarely present in the actual original json data, the function skips the further key lookup, it returns \u0026lt;code\u0026gt;NULL\u0026lt;\/code\u0026gt;.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT json_extract(orders.order_data, \u0026#39;$.shipping.method\u0026#39;) FROM orders LIMIT 5;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; select json_extract(orders.order_data, \u0026#39;$.shipping.method\u0026#39;) FROM orders LIMIT 5;\n\u002b------------------------------------------------------\u002b\n| json_extract(orders.order_data, \u0026#39;$.shipping.method\u0026#39;) |\n\u002b------------------------------------------------------\u002b\n| standard                                             |\n| overnight                                            |\n| standard                                             |\n| standard                                             |\n| overnight                                            |\n\u002b------------------------------------------------------\u002b\nsqlite\u0026gt; select *, json_extract(orders.order_data, \u0026#39;$.shipping.method\u0026#39;) FROM orders LIMIT 5;\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b------------------------------------------------------\u002b\n| id | customer_id |     created_at      |                          order_data                          | json_extract(orders.order_data, \u0026#39;$.shipping.method\u0026#39;) |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b------------------------------------------------------\u002b\n| 1  | 1           | 2025-11-21 13:08:22 | {\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: tru | standard                                             |\n|    |             |                     | e}}                                                          |                                                      |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b------------------------------------------------------\u002b\n| 2  | 1           | 2025-11-21 18:42:58 | {\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;overnight\u0026#34;}, \u0026#34;risk\u0026#34;: {\u0026#34;flag\u0026#34;: \u0026#34;high | overnight                                            |\n|    |             |                     | \u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: false}}                              |                                                      |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b------------------------------------------------------\u002b\n| 3  | 1           | 2025-11-21 21:01:46 | {\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: fal | standard                                             |\n|    |             |                     | se}}                                                         |                                                      |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b------------------------------------------------------\u002b\n| 4  | 1           | 2025-11-24 13:17:27 | {\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;standard\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: tru | standard                                             |\n|    |             |                     | e}}                                                          |                                                      |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b------------------------------------------------------\u002b\n| 5  | 1           | 2025-11-24 21:09:46 | {\u0026#34;shipping\u0026#34;: {\u0026#34;method\u0026#34;: \u0026#34;overnight\u0026#34;}, \u0026#34;gift\u0026#34;: {\u0026#34;wrapped\u0026#34;: fa | overnight                                            |\n|    |             |                     | lse}}                                                        |                                                      |\n\u002b----\u002b-------------\u002b---------------------\u002b--------------------------------------------------------------\u002b------------------------------------------------------\u002b\nsqlite\u0026gt; \n\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Let\u0026#39;s grab the other two.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT\n    json_extract(order_data, \u0026#39;$.shipping.method\u0026#39;),\n    json_extract(order_data, \u0026#39;$.gift.wrapped\u0026#39;),\n    json_extract(order_data, \u0026#39;$.risk.flag\u0026#39;) \nFROM orders;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; select json_extract(order_data, \u0026#39;$.shipping.method\u0026#39;), json_extract(order_data, \u0026#39;$.gift.wrapped\u0026#39;), json_extract(order_data, \u0026#39;$.risk.flag\u0026#39;) FROM orders LIMIT 5;\n\u002b-----------------------------------------------\u002b--------------------------------------------\u002b-----------------------------------------\u002b\n| json_extract(order_data, \u0026#39;$.shipping.method\u0026#39;) | json_extract(order_data, \u0026#39;$.gift.wrapped\u0026#39;) | json_extract(order_data, \u0026#39;$.risk.flag\u0026#39;) |\n\u002b-----------------------------------------------\u002b--------------------------------------------\u002b-----------------------------------------\u002b\n| standard                                      | 1                                          |                                         |\n| overnight                                     | 0                                          | high                                    |\n| standard                                      | 0                                          |                                         |\n| standard                                      | 1                                          |                                         |\n| overnight                                     | 0                                          |                                         |\n\u002b-----------------------------------------------\u002b--------------------------------------------\u002b-----------------------------------------\u002b\nsqlite\u0026gt; \n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Hmm, interesting, it automatically converted \u0026lt;code\u0026gt;false\u0026lt;\/code\u0026gt; to \u0026lt;code\u0026gt;0\u0026lt;\/code\u0026gt;, and \u0026lt;code\u0026gt;true\u0026lt;\/code\u0026gt; to \u0026lt;code\u0026gt;1\u0026lt;\/code\u0026gt; as you can see in the actual json data it was \u0026lt;code\u0026gt;true\u0026lt;\/code\u0026gt; and \u0026lt;code\u0026gt;false\u0026lt;\/code\u0026gt;. Nice, but could go the other way as well, if you were checking for true or false instead of 0 and 1. Both are same in SQLite, they are treated as truth and false values.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We have all the things we need, now?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Well, let\u0026#39;s group by the \u0026lt;code\u0026gt;customer_id\u0026lt;\/code\u0026gt; and order by the \u0026lt;code\u0026gt;created_at\u0026lt;\/code\u0026gt; to get the info about each customer with its latest order.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT *, json_extract(order_data, \u0026#39;$.shipping.method\u0026#39;), json_extract(order_data, \u0026#39;$.gift.wrapped\u0026#39;), json_extract(order_data, \u0026#39;$.risk.flag\u0026#39;) FROM orders GROUP BY customer_id ORDER by created_at LIMIT 5;\n\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;But there I see the problem, how can we group by customer_id and find the latest order for that customer! The order by will only work after the grouping has been done, so its not necessarily the per order for each customer.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Hmm!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;We need to make a subquery to get the latest order for each customer it seems.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT \n    orders.customer_id,\n    orders.created_at,\n    json_extract(orders.order_data, \u0026#39;$.shipping.method\u0026#39;) AS shipping_method,\n    json_extract(orders.order_data, \u0026#39;$.gift.wrapped\u0026#39;) AS gift_wrap,\n    json_extract(orders.order_data, \u0026#39;$.risk.flag\u0026#39;) AS risk_flag\nFROM orders\nWHERE orders.created_at = (\n    SELECT MAX(created_at)\n    FROM orders AS latest_order\n    WHERE orders.customer_id = latest_order.customer_id\n)\nORDER BY orders.created_at DESC;\n\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;We just added this\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;WHERE orders.created_at = (\n    SELECT MAX(created_at)\n    FROM orders AS latest_order\n    WHERE orders.customer_id = latest_order.customer_id\n)\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;This will filter only the latest created order for each customer and then we can grab the details from json in each row per customer after this isolates the row with the latest created at time.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; SELECT \n    orders.customer_id,\n    orders.created_at,\n    json_extract(orders.order_data, \u0026#39;$.shipping.method\u0026#39;) AS shipping_method,\n    json_extract(orders.order_data, \u0026#39;$.gift.wrapped\u0026#39;) AS gift_wrap,\n    json_extract(orders.order_data, \u0026#39;$.risk.flag\u0026#39;) AS risk_flag\nFROM orders\nWHERE orders.created_at = (\n    SELECT MAX(created_at)\n    FROM orders AS latest_order\n    WHERE orders.customer_id = latest_order.customer_id\n)\nORDER BY orders.created_at DESC;\n\n\u002b-------------\u002b---------------------\u002b-----------------\u002b-----------\u002b-----------\u002b\n| customer_id |     created_at      | shipping_method | gift_wrap | risk_flag |\n\u002b-------------\u002b---------------------\u002b-----------------\u002b-----------\u002b-----------\u002b\n| 32          | 2025-12-17 21:17:39 | overnight       | 0         |           |\n| 15          | 2025-12-17 19:21:33 | express         | 0         | medium    |\n| 50          | 2025-12-17 14:47:54 | express         | 1         | low       |\n| 43          | 2025-12-17 14:23:46 | express         | 1         |           |\n| 27          | 2025-12-17 14:05:13 | standard        | 1         |           |\n| 3           | 2025-12-17 14:02:28 | standard        | 1         | high      |\n| 49          | 2025-12-17 13:28:49 | express         | 1         | high      |\n| 36          | 2025-12-17 11:11:29 | overnight       | 1         |           |\n| 31          | 2025-12-17 08:05:46 | express         | 0         |           |\n| 16          | 2025-12-17 07:32:36 | express         | 0         |           |\n| 38          | 2025-12-17 06:05:12 | standard        | 1         |           |\n| 44          | 2025-12-17 05:28:54 | standard        | 1         |           |\n| 9           | 2025-12-17 04:33:08 | express         | 1         |           |\n| 23          | 2025-12-17 03:01:49 | express         | 0         |           |\n| 21          | 2025-12-16 23:53:14 | overnight       | 1         |           |\n| 25          | 2025-12-16 20:49:58 | overnight       | 1         | high      |\n| 46          | 2025-12-16 19:38:37 | standard        | 0         |           |\n| 1           | 2025-12-16 19:23:53 | express         | 0         |           |\n| 28          | 2025-12-16 18:20:55 | standard        | 0         | low       |\n| 40          | 2025-12-16 17:54:05 | express         | 0         |           |\n| 13          | 2025-12-16 16:11:16 | standard        | 1         |           |\n| 24          | 2025-12-16 14:19:45 | overnight       | 0         |           |\n| 11          | 2025-12-16 11:20:31 | standard        | 1         | medium    |\n| 17          | 2025-12-16 08:19:36 | standard        | 0         |           |\n| 4           | 2025-12-16 04:38:51 | express         | 0         |           |\n| 34          | 2025-12-16 02:11:57 | express         | 0         |           |\n| 30          | 2025-12-15 15:32:04 | overnight       | 0         | medium    |\n| 48          | 2025-12-15 13:03:59 | standard        | 1         |           |\n| 41          | 2025-12-15 13:00:00 | standard        | 0         | high      |\n| 45          | 2025-12-15 11:37:57 | standard        | 0         |           |\n| 7           | 2025-12-14 23:39:47 | express         | 0         |           |\n| 35          | 2025-12-14 22:46:36 | express         | 1         | high      |\n| 47          | 2025-12-14 20:53:07 | standard        | 0         |           |\n| 22          | 2025-12-14 12:38:58 | standard        | 0         | medium    |\n| 12          | 2025-12-14 07:59:28 | standard        | 1         | medium    |\n| 18          | 2025-12-14 04:55:34 | overnight       | 0         | low       |\n| 20          | 2025-12-14 04:54:07 | overnight       | 0         |           |\n| 14          | 2025-12-13 07:44:19 | standard        | 1         |           |\n| 6           | 2025-12-13 07:03:12 | overnight       | 1         |           |\n| 10          | 2025-12-13 04:23:37 | standard        | 0         | medium    |\n| 19          | 2025-12-13 03:29:15 | standard        | 0         |           |\n| 8           | 2025-12-12 12:42:18 | overnight       | 0         |           |\n| 26          | 2025-12-11 17:35:46 | standard        | 0         | low       |\n| 37          | 2025-12-11 13:55:35 | overnight       | 1         |           |\n| 33          | 2025-12-09 12:30:54 | express         | 1         |           |\n| 2           | 2025-12-08 07:17:31 | standard        | 0         |           |\n| 42          | 2025-12-08 02:48:12 | overnight       | 0         | medium    |\n| 5           | 2025-12-06 17:53:53 | overnight       | 1         |           |\n| 39          | 2025-12-06 14:38:29 | overnight       | 1         |           |\n| 29          | 2025-12-03 05:10:32 | overnight       | 1         | high      |\n\u002b-------------\u002b---------------------\u002b-----------------\u002b-----------\u002b-----------\u002b\nsqlite\u0026gt; \n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Now, that is it! I guess, a quick solution for getting this data sorted.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;However there is one more way without needing the subquery.\u0026lt;\/p\u0026gt;\n\u0026lt;h3 id=\u0026#34;row-number---window-function\u0026#34;\u0026gt;ROW NUMBER - Window Function\u0026lt;\/h3\u0026gt;\n\u0026lt;p\u0026gt;We can create partition for each customer with the \u0026lt;code\u0026gt;customer_id\u0026lt;\/code\u0026gt; and then sort by the \u0026lt;code\u0026gt;created_at\u0026lt;\/code\u0026gt; date in a latest first order (descending) and simply take the first row for extraction. This is kind of the same thing, but a kind of \u0026#39;gives a good feel to me\u0026#39; solution. Elite Mindset!\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;WITH ranked_orders AS (\n    SELECT \n        orders.customer_id,\n        orders.created_at,\n        json_extract(orders.order_data, \u0026#39;$.shipping.method\u0026#39;) AS shipping_method,\n        json_extract(orders.order_data, \u0026#39;$.gift.wrapped\u0026#39;) AS gift_wrap,\n        json_extract(orders.order_data, \u0026#39;$.risk.flag\u0026#39;) AS risk_flag,\n        ROW_NUMBER() OVER (PARTITION BY orders.customer_id ORDER BY orders.created_at DESC) AS row_num\n    FROM orders\n)\nSELECT \n    customer_id,\n    created_at,\n    shipping_method,\n    gift_wrap,\n    risk_flag\nFROM ranked_orders\nWHERE row_num = 1\nORDER BY created_at DESC;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;We are just doing the same thing as explained.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;This thing\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;ROW_NUMBER() OVER (PARTITION BY orders.customer_id ORDER BY orders.created_at DESC) AS row_num\u0026lt;\/code\u0026gt;\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;It will partition the table \u0026lt;code\u0026gt;orders\u0026lt;\/code\u0026gt; with \u0026lt;code\u0026gt;customer_id\u0026lt;\/code\u0026gt; and order by \u0026lt;code\u0026gt;created_at\u0026lt;\/code\u0026gt; latest first. And we assign each row as the \u0026lt;code\u0026gt;row_number\u0026lt;\/code\u0026gt; and grab the 1st row per customer to grab the latest order (filter with WHERE when calling the cte, or querying.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;However we created the CTE \u0026lt;code\u0026gt;ranked_orders\u0026lt;\/code\u0026gt; or you can call it \u0026lt;code\u0026gt;latest_orders\u0026lt;\/code\u0026gt;, to get the \u0026lt;code\u0026gt;row_num\u0026lt;\/code\u0026gt; filter to only the first \u0026lt;code\u0026gt;1\u0026lt;\/code\u0026gt; and for that we grab the already extracted json data as well the other columns.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Simple!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;That is it!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Day 9 was easy peasy!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Onwards day 10! Catch you tomorrow!\u0026lt;\/p\u0026gt;\n"
    }
    </script>
    
    
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/code-block.css">
    <link rel="stylesheet" href="/post-navigation.css">
    
    <link rel="icon" href="/tbicon.png" type="image/png">
    <link rel="apple-touch-icon" href="/tbicon.png">
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link id="syntax-theme" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.13.0/sql-wasm.js"></script>
    <link rel="stylesheet" href="/sql-playground.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/monokai.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/sql/sql.min.js"></script>
    <script src="/sql-playground.js"></script>
    
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script>
    document.addEventListener("DOMContentLoaded", () => {
        const body = document.body;
        const stylesheet = document.getElementById("syntax-theme");
        const themeToggle = document.getElementById('theme-toggle');

        function setSyntaxTheme(theme) {
            if (theme === "secondary") {
                stylesheet.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css";
            } else {
                stylesheet.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css";
            }
        }

        
        document.querySelectorAll("pre code").forEach((block) => {
            hljs.highlightElement(block);
        });

        
        const currentTheme = localStorage.getItem("theme") || "default";
        if (currentTheme === "secondary") {
            body.classList.add("secondary-theme");
            if (themeToggle) themeToggle.checked = true;
        }
        setSyntaxTheme(currentTheme);

        
        if (themeToggle) {
            themeToggle.addEventListener('change', () => {
                const newTheme = themeToggle.checked ? 'secondary' : 'default';
                if (themeToggle.checked) {
                    body.classList.add('secondary-theme');
                } else {
                    body.classList.remove('secondary-theme');
                }
                localStorage.setItem('theme', newTheme);
                setSyntaxTheme(newTheme);
            });
        }
        
        
        const editBtn = document.getElementById('editor-edit');
        if (editBtn) {
            editBtn.addEventListener('click', async function () {
                const slug = "sqlog\/advent-of-sql-2025-day-9";
                const type = "sqlog";
                console.log("Editing post:", slug, type);
                const url = "https:\/\/devmeetgor.netlify.app/.netlify/functions/api?slug=" + slug + "&method=edit&type=" + type;
                
                try {
                    const res = await fetch(url);
                    if (!res.ok) throw new Error("Failed to fetch edit content");
                    const html = await res.text();
                    document.querySelector('.post-content').innerHTML = html;
                } catch (err) {
                    console.error(err);
                    alert("Error loading editor content");
                }
            });
        }
    });
    </script>
    
    
    <script src="/seasonal-effects.js" defer></script>
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EET2ZX4QY1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-EET2ZX4QY1');
    </script>
</head>
<body>
    <header class="header">
  <a class="site-title" href="/" aria-label="Meet Gor - Home">Meet Gor</a>
  <nav>
    <ul>
      <li><a href="/" aria-label="Home">Home</a></li>
      <li><a href="/posts" aria-label="Posts">Posts</a></li>
      <li><a href="/all-content" aria-label="All Content">All Content</a></li>
      <li><a href="/about" aria-label="About">About</a></li>
      <li><a href="/contact" aria-label="Contact">Contact</a></li>
    </ul>
  </nav>
  <div class="theme-switch">
    <input type="checkbox" id="theme-toggle" aria-label="Toggle Theme">
    <label for="theme-toggle"></label>
  </div>
  
    <button id="editor" onclick="location.href='/editor'" aria-label="Editor">
      Editor
    </button>
  
</header>
    
    <main class="container">
        <article class="blog-post">
            <h1>Advent of SQL 2025 Day 9: Evergreen Market Orders</h1>
            
            <div class="post-meta">
                Published on  <time datetime="2025-12-24 15:30 &#43;0530">2025-12-24 15:30 &#43;0530</time>
            </div>
            
            <div class="post-meta">
                Type: <a href="/sqlog">sqlog</a>
            </div>
            
            <div class="post-meta tags">
                <span class="post-series-label"> Tags:</span>
                
                <a href="/tags/sqlite">#sqlite</a>
                
                <a href="/tags/sql">#sql</a>
                
                <a href="/tags/advent-of-sql">#advent-of-sql</a>
                
            </div>
            
            
            <div class="post-series">
                <span class="series-label">Part of the
                <span class="series-list">
                    
                    <a href="/series/advent-of-sql-2025" class="series-link"> advent-of-sql-2025</a>
                    
                </span></span>
                <span class="series-label">series</span>
            </div>
            
            
            
            <div class="post-meta admin-controls">
                <button id="editor-edit">Edit</button>
                <button id="editor-delete" 
                        onclick="location.href='/editor/?slug=sqlog\/advent-of-sql-2025-day-9&method=delete'">
                    Delete
                </button>
            </div>
            
            
            <hr>
            
            <div class="post-content">
                <h2 id="advent-of-sql-day-9---evergreen-market-orders">Advent of SQL, Day 9 - Evergreen Market Orders</h2>
<p>We are on day 9 of advent of SQL, and I feel good so far.</p>
<p>Let's see what we learn today?</p>
<p>Let's get the inserts for the day.</p>
<div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> .read day9-inserts.sql
sqlite> .schema
CREATE TABLE orders (
    id           INT PRIMARY KEY,
    customer_id  INT,
    created_at   TIMESTAMP,
    order_data   JSONB
);
sqlite> .mode table
sqlite> SELECT * FROM orders limit 10;
+----+-------------+---------------------+--------------------------------------------------------------+
| id | customer_id |     created_at      |                          order_data                          |
+----+-------------+---------------------+--------------------------------------------------------------+
| 1  | 1           | 2025-11-21 13:08:22 | {"shipping": {"method": "standard"}, "gift": {"wrapped": tru |
|    |             |                     | e}}                                                          |
+----+-------------+---------------------+--------------------------------------------------------------+
| 2  | 1           | 2025-11-21 18:42:58 | {"shipping": {"method": "overnight"}, "risk": {"flag": "high |
|    |             |                     | "}, "gift": {"wrapped": false}}                              |
+----+-------------+---------------------+--------------------------------------------------------------+
| 3  | 1           | 2025-11-21 21:01:46 | {"shipping": {"method": "standard"}, "gift": {"wrapped": fal |
|    |             |                     | se}}                                                         |
+----+-------------+---------------------+--------------------------------------------------------------+
| 4  | 1           | 2025-11-24 13:17:27 | {"shipping": {"method": "standard"}, "gift": {"wrapped": tru |
|    |             |                     | e}}                                                          |
+----+-------------+---------------------+--------------------------------------------------------------+
| 5  | 1           | 2025-11-24 21:09:46 | {"shipping": {"method": "overnight"}, "gift": {"wrapped": fa |
|    |             |                     | lse}}                                                        |
+----+-------------+---------------------+--------------------------------------------------------------+
| 6  | 1           | 2025-11-25 07:24:55 | {"shipping": {"method": "standard"}, "risk": {"flag": "mediu |
|    |             |                     | m"}, "gift": {"wrapped": true}}                              |
+----+-------------+---------------------+--------------------------------------------------------------+
| 7  | 1           | 2025-11-25 17:42:36 | {"shipping": {"method": "standard"}, "gift": {"wrapped": fal |
|    |             |                     | se}}                                                         |
+----+-------------+---------------------+--------------------------------------------------------------+
| 8  | 1           | 2025-11-27 02:34:24 | {"shipping": {"method": "express"}, "gift": {"wrapped": true |
|    |             |                     | }}                                                           |
+----+-------------+---------------------+--------------------------------------------------------------+
| 9  | 1           | 2025-11-30 22:43:54 | {"shipping": {"method": "overnight"}, "gift": {"wrapped": tr |
|    |             |                     | ue}}                                                         |
+----+-------------+---------------------+--------------------------------------------------------------+
| 10 | 1           | 2025-12-01 04:03:33 | {"shipping": {"method": "express"}, "risk": {"flag": "medium |
|    |             |                     | "}, "gift": {"wrapped": false}}                              |
+----+-------------+---------------------+--------------------------------------------------------------+
sqlite> 
</code></pre></div><p>Looks like we will deal with JSON today, seems exciting. I haven't dealt with JSON in SQLite yet, today will break it.</p>
<p>Let's get some sample inserts for you to play in the browser.</p>
<p>LIMITING TO 20, there are more than 400 rows!</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">DROP TABLE IF EXISTS orders;

CREATE TABLE orders (
    id           INT PRIMARY KEY,
    customer_id  INT,
    created_at   TIMESTAMP,
    order_data   JSONB
);

INSERT INTO orders (id, customer_id, created_at, order_data) VALUES
    (1, 1, '2025-11-21 13:08:22', '{"shipping": {"method": "standard"}, "gift": {"wrapped": true}}'),
    (2, 1, '2025-11-21 18:42:58', '{"shipping": {"method": "overnight"}, "risk": {"flag": "high"}, "gift": {"wrapped": false}}'),
    (3, 1, '2025-11-21 21:01:46', '{"shipping": {"method": "standard"}, "gift": {"wrapped": false}}'),
    (4, 1, '2025-11-24 13:17:27', '{"shipping": {"method": "standard"}, "gift": {"wrapped": true}}'),
    (5, 1, '2025-11-24 21:09:46', '{"shipping": {"method": "overnight"}, "gift": {"wrapped": false}}'),
    (6, 1, '2025-11-25 07:24:55', '{"shipping": {"method": "standard"}, "risk": {"flag": "medium"}, "gift": {"wrapped": true}}'),
    (7, 1, '2025-11-25 17:42:36', '{"shipping": {"method": "standard"}, "gift": {"wrapped": false}}'),
    (8, 1, '2025-11-27 02:34:24', '{"shipping": {"method": "express"}, "gift": {"wrapped": true}}'),
    (9, 1, '2025-11-30 22:43:54', '{"shipping": {"method": "overnight"}, "gift": {"wrapped": true}}'),
    (10, 1, '2025-12-01 04:03:33', '{"shipping": {"method": "express"}, "risk": {"flag": "medium"}, "gift": {"wrapped": false}}'),
    (11, 1, '2025-12-02 05:19:10', '{"shipping": {"method": "overnight"}, "risk": {"flag": "low"}, "gift": {"wrapped": true}}'),
    (12, 1, '2025-12-03 16:25:56', '{"shipping": {"method": "overnight"}, "risk": {"flag": "medium"}, "gift": {"wrapped": true}}'),
    (13, 1, '2025-12-10 19:34:28', '{"shipping": {"method": "standard"}, "gift": {"wrapped": false}}'),
    (14, 1, '2025-12-16 19:23:53', '{"shipping": {"method": "express"}, "gift": {"wrapped": false}}'),
    (15, 2, '2025-11-23 19:11:23', '{"shipping": {"method": "overnight"}, "gift": {"wrapped": true}}'),
    (16, 2, '2025-11-28 15:23:27', '{"shipping": {"method": "express"}, "gift": {"wrapped": true}}'),
    (17, 2, '2025-11-30 12:05:36', '{"shipping": {"method": "overnight"}, "risk": {"flag": "low"}, "gift": {"wrapped": true}}'),
    (18, 2, '2025-12-03 07:03:06', '{"shipping": {"method": "standard"}, "gift": {"wrapped": false}}'),
    (19, 2, '2025-12-07 13:55:13', '{"shipping": {"method": "express"}, "risk": {"flag": "high"}, "gift": {"wrapped": false}}'),
    (20, 2, '2025-12-08 07:17:31', '{"shipping": {"method": "standard"}, "gift": {"wrapped": false}}');
</code></pre><div class="output"></div></div><div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT * FROM orders;
</code></pre><div class="output"></div></div><p>Let's get to the problem now.</p>
<h2 id="problem">Problem</h2>
<blockquote>
<p>Build a report using the orders table that shows the latest order for each customer, along with their requested shipping method, gift wrap choice (as true or false), and the risk flag in separate columns.</p>
<p>Order the report by the most recent order first so Evergreen Market can reach out to them ASAP.</p>
</blockquote>
<p>Ok, so we need for each customer the latest order with the following details:</p>
<ul>
<li>shipping method</li>
<li>gift wrap choice</li>
<li>risk flag</li>
</ul>
<p>These all I think are in the same column as a JSON string or blob. We need to extract those out from the column.</p>
<p>Let's first check the <code>orders</code> table.</p>
<p>It has a few columns:</p>
<ul>
<li>id</li>
<li>customer_id</li>
<li>created_at</li>
<li>order_data</li>
</ul>
<p>We do require the <code>order_data</code> as that is the column that has JSON.</p>
<p>Also the problem said to give the most recent order, so we need to order by <code>created_at</code> in a reverse way, the latest first. Also we need it per customer, so we need to group by <code>customer_id</code>.</p>
<p>Let's see how to get the data inside JSON in SQLite.</p>
<h3 id="json-extract">JSON Extract</h3>
<p>Well we have <a href="https://sqlite.org/json1.html#jex">json_extract</a> which can give us the value of the key from the given json data string.</p>
<p>The function takes in the column name from the table which would be the column containing the json data and then the second parameter is the path to the key, in this case if we want to get the <code>method</code> from the <code>shipping</code> key, we can use <code>$.shipping.method</code> which means from the root <code>$</code> get the <code>shipping</code> key, and inside that (<code>shipping</code> key) give the value inside the <code>method</code> key.</p>
<p>If the path is not present, in our case the <code>risk</code>  key is very rarely present in the actual original json data, the function skips the further key lookup, it returns <code>NULL</code>.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT json_extract(orders.order_data, '$.shipping.method') FROM orders LIMIT 5;
</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> select json_extract(orders.order_data, '$.shipping.method') FROM orders LIMIT 5;
+------------------------------------------------------+
| json_extract(orders.order_data, '$.shipping.method') |
+------------------------------------------------------+
| standard                                             |
| overnight                                            |
| standard                                             |
| standard                                             |
| overnight                                            |
+------------------------------------------------------+
sqlite> select *, json_extract(orders.order_data, '$.shipping.method') FROM orders LIMIT 5;
+----+-------------+---------------------+--------------------------------------------------------------+------------------------------------------------------+
| id | customer_id |     created_at      |                          order_data                          | json_extract(orders.order_data, '$.shipping.method') |
+----+-------------+---------------------+--------------------------------------------------------------+------------------------------------------------------+
| 1  | 1           | 2025-11-21 13:08:22 | {"shipping": {"method": "standard"}, "gift": {"wrapped": tru | standard                                             |
|    |             |                     | e}}                                                          |                                                      |
+----+-------------+---------------------+--------------------------------------------------------------+------------------------------------------------------+
| 2  | 1           | 2025-11-21 18:42:58 | {"shipping": {"method": "overnight"}, "risk": {"flag": "high | overnight                                            |
|    |             |                     | "}, "gift": {"wrapped": false}}                              |                                                      |
+----+-------------+---------------------+--------------------------------------------------------------+------------------------------------------------------+
| 3  | 1           | 2025-11-21 21:01:46 | {"shipping": {"method": "standard"}, "gift": {"wrapped": fal | standard                                             |
|    |             |                     | se}}                                                         |                                                      |
+----+-------------+---------------------+--------------------------------------------------------------+------------------------------------------------------+
| 4  | 1           | 2025-11-24 13:17:27 | {"shipping": {"method": "standard"}, "gift": {"wrapped": tru | standard                                             |
|    |             |                     | e}}                                                          |                                                      |
+----+-------------+---------------------+--------------------------------------------------------------+------------------------------------------------------+
| 5  | 1           | 2025-11-24 21:09:46 | {"shipping": {"method": "overnight"}, "gift": {"wrapped": fa | overnight                                            |
|    |             |                     | lse}}                                                        |                                                      |
+----+-------------+---------------------+--------------------------------------------------------------+------------------------------------------------------+
sqlite> 

</code></pre></div><p>Let's grab the other two.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT
    json_extract(order_data, '$.shipping.method'),
    json_extract(order_data, '$.gift.wrapped'),
    json_extract(order_data, '$.risk.flag') 
FROM orders;
</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> select json_extract(order_data, '$.shipping.method'), json_extract(order_data, '$.gift.wrapped'), json_extract(order_data, '$.risk.flag') FROM orders LIMIT 5;
+-----------------------------------------------+--------------------------------------------+-----------------------------------------+
| json_extract(order_data, '$.shipping.method') | json_extract(order_data, '$.gift.wrapped') | json_extract(order_data, '$.risk.flag') |
+-----------------------------------------------+--------------------------------------------+-----------------------------------------+
| standard                                      | 1                                          |                                         |
| overnight                                     | 0                                          | high                                    |
| standard                                      | 0                                          |                                         |
| standard                                      | 1                                          |                                         |
| overnight                                     | 0                                          |                                         |
+-----------------------------------------------+--------------------------------------------+-----------------------------------------+
sqlite> 
</code></pre></div><p>Hmm, interesting, it automatically converted <code>false</code> to <code>0</code>, and <code>true</code> to <code>1</code> as you can see in the actual json data it was <code>true</code> and <code>false</code>. Nice, but could go the other way as well, if you were checking for true or false instead of 0 and 1. Both are same in SQLite, they are treated as truth and false values.</p>
<p>We have all the things we need, now?</p>
<p>Well, let's group by the <code>customer_id</code> and order by the <code>created_at</code> to get the info about each customer with its latest order.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT *, json_extract(order_data, '$.shipping.method'), json_extract(order_data, '$.gift.wrapped'), json_extract(order_data, '$.risk.flag') FROM orders GROUP BY customer_id ORDER by created_at LIMIT 5;

</code></pre><div class="output"></div></div><p>But there I see the problem, how can we group by customer_id and find the latest order for that customer! The order by will only work after the grouping has been done, so its not necessarily the per order for each customer.</p>
<p>Hmm!</p>
<p>We need to make a subquery to get the latest order for each customer it seems.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT 
    orders.customer_id,
    orders.created_at,
    json_extract(orders.order_data, '$.shipping.method') AS shipping_method,
    json_extract(orders.order_data, '$.gift.wrapped') AS gift_wrap,
    json_extract(orders.order_data, '$.risk.flag') AS risk_flag
FROM orders
WHERE orders.created_at = (
    SELECT MAX(created_at)
    FROM orders AS latest_order
    WHERE orders.customer_id = latest_order.customer_id
)
ORDER BY orders.created_at DESC;

</code></pre><div class="output"></div></div><p>We just added this</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">WHERE orders.created_at = (
    SELECT MAX(created_at)
    FROM orders AS latest_order
    WHERE orders.customer_id = latest_order.customer_id
)
</code></pre><div class="output"></div></div><p>This will filter only the latest created order for each customer and then we can grab the details from json in each row per customer after this isolates the row with the latest created at time.</p>
<div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> SELECT 
    orders.customer_id,
    orders.created_at,
    json_extract(orders.order_data, '$.shipping.method') AS shipping_method,
    json_extract(orders.order_data, '$.gift.wrapped') AS gift_wrap,
    json_extract(orders.order_data, '$.risk.flag') AS risk_flag
FROM orders
WHERE orders.created_at = (
    SELECT MAX(created_at)
    FROM orders AS latest_order
    WHERE orders.customer_id = latest_order.customer_id
)
ORDER BY orders.created_at DESC;

+-------------+---------------------+-----------------+-----------+-----------+
| customer_id |     created_at      | shipping_method | gift_wrap | risk_flag |
+-------------+---------------------+-----------------+-----------+-----------+
| 32          | 2025-12-17 21:17:39 | overnight       | 0         |           |
| 15          | 2025-12-17 19:21:33 | express         | 0         | medium    |
| 50          | 2025-12-17 14:47:54 | express         | 1         | low       |
| 43          | 2025-12-17 14:23:46 | express         | 1         |           |
| 27          | 2025-12-17 14:05:13 | standard        | 1         |           |
| 3           | 2025-12-17 14:02:28 | standard        | 1         | high      |
| 49          | 2025-12-17 13:28:49 | express         | 1         | high      |
| 36          | 2025-12-17 11:11:29 | overnight       | 1         |           |
| 31          | 2025-12-17 08:05:46 | express         | 0         |           |
| 16          | 2025-12-17 07:32:36 | express         | 0         |           |
| 38          | 2025-12-17 06:05:12 | standard        | 1         |           |
| 44          | 2025-12-17 05:28:54 | standard        | 1         |           |
| 9           | 2025-12-17 04:33:08 | express         | 1         |           |
| 23          | 2025-12-17 03:01:49 | express         | 0         |           |
| 21          | 2025-12-16 23:53:14 | overnight       | 1         |           |
| 25          | 2025-12-16 20:49:58 | overnight       | 1         | high      |
| 46          | 2025-12-16 19:38:37 | standard        | 0         |           |
| 1           | 2025-12-16 19:23:53 | express         | 0         |           |
| 28          | 2025-12-16 18:20:55 | standard        | 0         | low       |
| 40          | 2025-12-16 17:54:05 | express         | 0         |           |
| 13          | 2025-12-16 16:11:16 | standard        | 1         |           |
| 24          | 2025-12-16 14:19:45 | overnight       | 0         |           |
| 11          | 2025-12-16 11:20:31 | standard        | 1         | medium    |
| 17          | 2025-12-16 08:19:36 | standard        | 0         |           |
| 4           | 2025-12-16 04:38:51 | express         | 0         |           |
| 34          | 2025-12-16 02:11:57 | express         | 0         |           |
| 30          | 2025-12-15 15:32:04 | overnight       | 0         | medium    |
| 48          | 2025-12-15 13:03:59 | standard        | 1         |           |
| 41          | 2025-12-15 13:00:00 | standard        | 0         | high      |
| 45          | 2025-12-15 11:37:57 | standard        | 0         |           |
| 7           | 2025-12-14 23:39:47 | express         | 0         |           |
| 35          | 2025-12-14 22:46:36 | express         | 1         | high      |
| 47          | 2025-12-14 20:53:07 | standard        | 0         |           |
| 22          | 2025-12-14 12:38:58 | standard        | 0         | medium    |
| 12          | 2025-12-14 07:59:28 | standard        | 1         | medium    |
| 18          | 2025-12-14 04:55:34 | overnight       | 0         | low       |
| 20          | 2025-12-14 04:54:07 | overnight       | 0         |           |
| 14          | 2025-12-13 07:44:19 | standard        | 1         |           |
| 6           | 2025-12-13 07:03:12 | overnight       | 1         |           |
| 10          | 2025-12-13 04:23:37 | standard        | 0         | medium    |
| 19          | 2025-12-13 03:29:15 | standard        | 0         |           |
| 8           | 2025-12-12 12:42:18 | overnight       | 0         |           |
| 26          | 2025-12-11 17:35:46 | standard        | 0         | low       |
| 37          | 2025-12-11 13:55:35 | overnight       | 1         |           |
| 33          | 2025-12-09 12:30:54 | express         | 1         |           |
| 2           | 2025-12-08 07:17:31 | standard        | 0         |           |
| 42          | 2025-12-08 02:48:12 | overnight       | 0         | medium    |
| 5           | 2025-12-06 17:53:53 | overnight       | 1         |           |
| 39          | 2025-12-06 14:38:29 | overnight       | 1         |           |
| 29          | 2025-12-03 05:10:32 | overnight       | 1         | high      |
+-------------+---------------------+-----------------+-----------+-----------+
sqlite> 
</code></pre></div><p>Now, that is it! I guess, a quick solution for getting this data sorted.</p>
<p>However there is one more way without needing the subquery.</p>
<h3 id="row-number---window-function">ROW NUMBER - Window Function</h3>
<p>We can create partition for each customer with the <code>customer_id</code> and then sort by the <code>created_at</code> date in a latest first order (descending) and simply take the first row for extraction. This is kind of the same thing, but a kind of 'gives a good feel to me' solution. Elite Mindset!</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">WITH ranked_orders AS (
    SELECT 
        orders.customer_id,
        orders.created_at,
        json_extract(orders.order_data, '$.shipping.method') AS shipping_method,
        json_extract(orders.order_data, '$.gift.wrapped') AS gift_wrap,
        json_extract(orders.order_data, '$.risk.flag') AS risk_flag,
        ROW_NUMBER() OVER (PARTITION BY orders.customer_id ORDER BY orders.created_at DESC) AS row_num
    FROM orders
)
SELECT 
    customer_id,
    created_at,
    shipping_method,
    gift_wrap,
    risk_flag
FROM ranked_orders
WHERE row_num = 1
ORDER BY created_at DESC;
</code></pre><div class="output"></div></div><p>We are just doing the same thing as explained.</p>
<p>This thing</p>
<p><code>ROW_NUMBER() OVER (PARTITION BY orders.customer_id ORDER BY orders.created_at DESC) AS row_num</code></p>
<p>It will partition the table <code>orders</code> with <code>customer_id</code> and order by <code>created_at</code> latest first. And we assign each row as the <code>row_number</code> and grab the 1st row per customer to grab the latest order (filter with WHERE when calling the cte, or querying.</p>
<p>However we created the CTE <code>ranked_orders</code> or you can call it <code>latest_orders</code>, to get the <code>row_num</code> filter to only the first <code>1</code> and for that we grab the already extracted json data as well the other columns.</p>
<p>Simple!</p>
<p>That is it!</p>
<p>Day 9 was easy peasy!</p>
<p>Onwards day 10! Catch you tomorrow!</p>

            </div>
        </article>
        
        
        

<nav class="post-navigation" aria-label="Post Navigation">
    <div class="nav-container">
        
        
        <a href="/sqlog/advent-of-sql-2025-day-8" class="nav-link nav-prev" title="Previous Post">
            <span class="nav-arrow"></span>
            <span class="nav-label">Previous</span>
            <span class="nav-title">Advent of SQL 2025 Day 8: Product Catalog</span>
        </a>
        

        
        
        <a href="/sqlog/advent-of-sql-2025-day-10" class="nav-link nav-next" title="Next Post">
            <span class="nav-label">Next</span>
            <span class="nav-title">Advent of SQL 2025 Day 10: Misdelivered Presents</span>
            <span class="nav-arrow"></span>
        </a>
        
    </div>
</nav>


        
        
        


<aside class="related-reading" aria-labelledby="related-reading-title">
    <h3 id="related-reading-title" class="related-title"> Related Reading</h3>
    <ul class="related-list">
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-15" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 15: Confirmation Phrase Dispatches</span>
                <span class="related-post-date">2025-12-28 20:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-14" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 14: Ski Resort Paths</span>
                <span class="related-post-date">2025-12-28 15:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-13" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 13: XML Travel Manifests</span>
                <span class="related-post-date">2025-12-27 20:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-12" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 12: Archive Flight Records</span>
                <span class="related-post-date">2025-12-27 15:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-11" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 11: Behavior Score</span>
                <span class="related-post-date">2025-12-26 15:30 &#43;0530</span>
            </a>
        </li>
        
        
    </ul>
</aside>


    </main>
    
    <div id="comments">
        <script src="https://giscus.app/client.js"
            data-repo="Mr-Destructive/meetgor.com"
            data-repo-id="R_kgDOHZ6V_g"
            data-category="Q&A"
            data-category-id="DIC_kwDOHZ6V_s4CRfn4"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="bottom"
            data-theme="dark_high_contrast"
            data-lang="en"
            crossorigin="anonymous"
            async>
        </script>
    </div>
    
    <footer class="site-footer" role="contentinfo">
  <div class="footer-content">
    <p>&copy; Meet Gor. All rights reserved.</p>
    <div class="social-links">
      <a href="/contact" aria-label="Connect with me">Connect with me</a>
    </div>
  </div>
</footer>
    
</body>
</html>
