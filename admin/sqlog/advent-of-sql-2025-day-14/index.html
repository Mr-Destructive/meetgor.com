<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <title>Advent of SQL 2025 Day 14: Ski Resort Paths | Meet Gor</title>
    <meta name="title" content="Advent of SQL 2025 Day 14: Ski Resort Paths | Meet Gor">
    <meta name="description" content="">
    <meta name="author" content="Meet Gor">
    <meta name="keywords" content="sqlite, sql, advent-of-sql">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://meetgor.com/sqlog/advent-of-sql-2025-day-14">
    
    
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://meetgor.com/sqlog/advent-of-sql-2025-day-14">
    <meta property="og:title" content="Advent of SQL 2025 Day 14: Ski Resort Paths">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://meetgor.com/tbicon.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Advent of SQL 2025 Day 14: Ski Resort Paths">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Meet Gor">
    <meta property="article:published_time" content="2025-12-28 15:30 &#43;0530">
    <meta property="article:modified_time" content="2025-12-28 15:30 &#43;0530">
    <meta property="article:author" content="Meet Gor">
    
    <meta property="article:tag" content="sqlite">
    
    <meta property="article:tag" content="sql">
    
    <meta property="article:tag" content="advent-of-sql">
    
    
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@meetgor711">
    <meta name="twitter:creator" content="@meetgor711">
    <meta name="twitter:url" content="https://meetgor.com/sqlog/advent-of-sql-2025-day-14">
    <meta name="twitter:title" content="Advent of SQL 2025 Day 14: Ski Resort Paths">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="https://meetgor.com/tbicon.png">
    <meta name="twitter:image:alt" content="Advent of SQL 2025 Day 14: Ski Resort Paths">
    
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/meetgor.com/sqlog\/advent-of-sql-2025-day-14"
        },
        "headline": "Advent of SQL 2025 Day 14: Ski Resort Paths",
        "description": "",
        "datePublished": "2025-12-28 15:30 \u002b0530",
        "dateModified": "2025-12-28 15:30 \u002b0530",
        "author": {
            "@type": "Person",
            "name": "Meet Gor"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Meet Gor",
            "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/meetgor.com/tbicon.png"
            }
        },
        
        "keywords": "sqlite, sql, advent-of-sql",
        "articleBody": "\u0026lt;h2 id=\u0026#34;advent-of-sql-day-14---ski-resort-paths\u0026#34;\u0026gt;Advent of SQL, Day 14 - Ski Resort Paths\u0026lt;\/h2\u0026gt;\n\u0026lt;p\u0026gt;Ok, almost to the penultimate day in the series. It is day 14 of Advent of SQL.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s grab the SQL for the day.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;DROP TABLE IF EXISTS mountain_network;\n\n\nCREATE TABLE mountain_network (\n    id INTEGER PRIMARY KEY,\n    from_node TEXT,\n    to_node TEXT,\n    node_type TEXT,    -- \u0026#39;Lift\u0026#39; or \u0026#39;Trail\u0026#39;\n    difficulty TEXT    -- Only applicable for trails: \u0026#39;green\u0026#39;, \u0026#39;blue\u0026#39;, \u0026#39;black\u0026#39;, \u0026#39;double_black\u0026#39;\n);\n\nINSERT INTO mountain_network (id, from_node, to_node, node_type, difficulty) VALUES\n(1, \u0026#39;Outlaw Express\u0026#39;, \u0026#39;Stairway Lift\u0026#39;, \u0026#39;Lift\u0026#39;, NULL),\n(2, \u0026#39;Outlaw Express\u0026#39;, \u0026#39;Top Gun Bowl\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;black\u0026#39;),\n(3, \u0026#39;Top Gun Bowl\u0026#39;, \u0026#39;Top Gun\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;black\u0026#39;),\n(4, \u0026#39;Top Gun\u0026#39;, \u0026#39;Montoya\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;blue\u0026#39;),\n(5, \u0026#39;Montoya\u0026#39;, \u0026#39;Center Aisle\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;green\u0026#39;),\n(6, \u0026#39;Center Aisle\u0026#39;, \u0026#39;Lower Stampede\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;green\u0026#39;),\n(7, \u0026#39;Stairway Lift\u0026#39;, \u0026#39;Red\u0026#39;\u0026#39;s Lift\u0026#39;, \u0026#39;Lift\u0026#39;, NULL),\n(8, \u0026#39;Stairway Lift\u0026#39;, \u0026#39;Broadway\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;green\u0026#39;),\n(9, \u0026#39;Red\u0026#39;\u0026#39;s Lift\u0026#39;, \u0026#39;Bearclaw\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;blue\u0026#39;),\n(10, \u0026#39;Bearclaw\u0026#39;, \u0026#39;Last Chance\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;blue\u0026#39;),\n(11, \u0026#39;Last Chance\u0026#39;, \u0026#39;Diamondback\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;blue\u0026#39;),\n(12, \u0026#39;Diamondback\u0026#39;, \u0026#39;Broadway\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;green\u0026#39;),\n(13, \u0026#39;Red\u0026#39;\u0026#39;s Lift\u0026#39;, \u0026#39;Bishop\u0026#39;\u0026#39;s Bowl\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;black\u0026#39;),\n(14, \u0026#39;Red\u0026#39;\u0026#39;s Lift\u0026#39;, \u0026#39;Amy\u0026#39;\u0026#39;s Ridge\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;blue\u0026#39;),\n(15, \u0026#39;Amy\u0026#39;\u0026#39;s Ridge\u0026#39;, \u0026#39;Grizzly Bowl\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;black\u0026#39;),\n(16, \u0026#39;Flathead Lift\u0026#39;, \u0026#39;Amy\u0026#39;\u0026#39;s Ridge\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;blue\u0026#39;),\n(17, \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39;, \u0026#39;Wildwood Lift\u0026#39;, \u0026#39;Lift\u0026#39;, NULL),\n(18, \u0026#39;Wildwood Lift\u0026#39;, \u0026#39;Sidewinder\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;green\u0026#39;),\n(19, \u0026#39;Wildwood Lift\u0026#39;, \u0026#39;Brightside\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;blue\u0026#39;),\n(20, \u0026#39;Brightside\u0026#39;, \u0026#39;Moonrise\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;green\u0026#39;),\n(21, \u0026#39;Moonrise\u0026#39;, \u0026#39;Draw\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;green\u0026#39;),\n(22, \u0026#39;Moonrise\u0026#39;, \u0026#39;Lone Pine\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;blue\u0026#39;),\n(23, \u0026#39;Draw\u0026#39;, \u0026#39;Maverick\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;blue\u0026#39;),\n(24, \u0026#39;Draw\u0026#39;, \u0026#39;Broadway\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;green\u0026#39;),\n(25, \u0026#39;Broadway\u0026#39;, \u0026#39;Outlaw Trail\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;green\u0026#39;),\n(26, \u0026#39;Outlaw Trail\u0026#39;, \u0026#39;Center Aisle\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;green\u0026#39;),\n(27, \u0026#39;Center Aisle\u0026#39;, \u0026#39;Bandit\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;green\u0026#39;),\n(28, \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39;, \u0026#39;Maverick\u0026#39;, \u0026#39;Trail\u0026#39;, \u0026#39;blue\u0026#39;);\n\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;That\u0026#39;s it, we just have 1 table called \u0026lt;code\u0026gt;mountain_network\u0026lt;\/code\u0026gt; and it has \u0026lt;code\u0026gt;28\u0026lt;\/code\u0026gt; records.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s look at the problem statement to check what we need to do to make sense of those 28 rows.\u0026lt;\/p\u0026gt;\n\u0026lt;h2 id=\u0026#34;problem\u0026#34;\u0026gt;Problem\u0026lt;\/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Find all the possible routes from Jake\u0026#39;s Lift to Maverick. None of the possible routes will take more than 12 connections.\u0026lt;\/p\u0026gt;\n\u0026lt;\/blockquote\u0026gt;\n\u0026lt;p\u0026gt;Oh! This is a graph like or network like problem.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Ouch!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Relational databases looks like they would be a good fit for these stuff, but if the data is just in the single table, there\u0026#39;s not really much help.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s see how we can think about it.\u0026lt;\/p\u0026gt;\n\u0026lt;h3 id=\u0026#34;joins-and-unions\u0026#34;\u0026gt;JOINs and UNIONS\u0026lt;\/h3\u0026gt;\n\u0026lt;p\u0026gt;We need to find all the routes from a start node(record) i.e. \u0026lt;code\u0026gt;Jake\u0026#39;s Lift\u0026lt;\/code\u0026gt; and find all ways that lead to the node(record) i.e. \u0026lt;code\u0026gt;Maverick\u0026lt;\/code\u0026gt;. The table gives a list of edges i.e. from which node to which node there is a way or a trail or lift.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;So, we can do a simple select to check if the \u0026lt;code\u0026gt;from_node\u0026lt;\/code\u0026gt; has \u0026lt;code\u0026gt;Jake\u0026#39;s Lift\u0026lt;\/code\u0026gt; and the \u0026lt;code\u0026gt;to_node\u0026lt;\/code\u0026gt; has \u0026lt;code\u0026gt;Maverick\u0026lt;\/code\u0026gt; right?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;But that would make it too long.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Like we would have to look for 12 consecutive edges and branch off at each direction.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;For the first level it would look simple like this:\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT \n    mountain_network.from_node || \u0026#39; -\u0026gt; \u0026#39; || mountain_network.to_node AS path, \n    1 AS connections\nFROM mountain_network\nWHERE \n    mountain_network.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39;\n    AND mountain_network.to_node = \u0026#39;Maverick\u0026#39;;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; SELECT mountain_network.from_node || \u0026#39; -\u0026gt; \u0026#39; || mountain_network.to_node AS path, 1 AS connections\nFROM mountain_network\nWHERE mountain_network.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39; AND mountain_network.to_node = \u0026#39;Maverick\u0026#39;\n   ...\u0026gt; ;\n\u002b-------------------------\u002b-------------\u002b\n|          path           | connections |\n\u002b-------------------------\u002b-------------\u002b\n| Jake\u0026#39;s Lift -\u0026gt; Maverick | 1           |\n\u002b-------------------------\u002b-------------\u002b\nsqlite\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Luckily, we have one route directly from \u0026lt;code\u0026gt;Jake\u0026#39;s Lift\u0026lt;\/code\u0026gt; to \u0026lt;code\u0026gt;Maverick\u0026lt;\/code\u0026gt;. But that might not be for all levels. Like we need to check then, from each of the start nodes that begin at \u0026lt;code\u0026gt;Jake\u0026#39;s Lift\u0026lt;\/code\u0026gt;, then for all the nodes that begin at that then it branches of further till we have a dead end only at \u0026lt;code\u0026gt;Maverick\u0026lt;\/code\u0026gt;.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Phew that\u0026#39;s going to be a long one.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node, 2                     FROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nWHERE \n    T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39;\n    AND T2.to_node = \u0026#39;Maverick\u0026#39;;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;That is the first branch off from \u0026lt;code\u0026gt;Jake\u0026#39;s Lift\u0026lt;\/code\u0026gt;. If we remove the \u0026lt;code\u0026gt;T2.to_node = \u0026#39;Maverick\u0026#39;\u0026lt;\/code\u0026gt; you would see all nodes from the \u0026lt;code\u0026gt;Jake\u0026#39;s Lift\u0026lt;\/code\u0026gt;, not necessarily ending at \u0026lt;code\u0026gt;Maverick\u0026lt;\/code\u0026gt;\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node as path,\n 2 as connections\nFROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39;;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; SELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node as path,\n 2 as connections\nFROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39;;\n\u002b--------------------------------------------\u002b-------------\u002b\n|                    path                    | connections |\n\u002b--------------------------------------------\u002b-------------\u002b\n| Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Brightside | 2           |\n| Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Sidewinder | 2           |\n\u002b--------------------------------------------\u002b-------------\u002b\nsqlite\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Similarly we can do it for 3 and 4, and till 12 connections.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT \n    T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node || \u0026#39; -\u0026gt; \u0026#39; || T3.to_node as path,\n    3 as connections\nFROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nJOIN mountain_network T3 ON T2.to_node = T3.from_node\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39;;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; SELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node || \u0026#39; -\u0026gt; \u0026#39; || T3.to_node as path, 3 as connections\nFROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nJOIN mountain_network T3 ON T2.to_node = T3.from_node\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39;\n   ...\u0026gt; ;\n\u002b--------------------------------------------------------\u002b-------------\u002b\n|                          path                          | connections |\n\u002b--------------------------------------------------------\u002b-------------\u002b\n| Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Brightside -\u0026gt; Moonrise | 3           |\n\u002b--------------------------------------------------------\u002b-------------\u002b\nsqlite\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Yikes.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;That gives a long long query. I cannot write.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;SELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node AS path, 1 AS connections\nFROM mountain_network T1\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39; AND T1.to_node = \u0026#39;Maverick\u0026#39;\n\nUNION ALL\n\nSELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node, 2\nFROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39; AND T2.to_node = \u0026#39;Maverick\u0026#39;\n\nUNION ALL\n\nSELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node || \u0026#39; -\u0026gt; \u0026#39; || T3.to_node, 3\nFROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nJOIN mountain_network T3 ON T2.to_node = T3.from_node\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39; AND T3.to_node = \u0026#39;Maverick\u0026#39;\n\nUNION ALL\n\nSELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node || \u0026#39; -\u0026gt; \u0026#39; || T3.to_node || \u0026#39; -\u0026gt; \u0026#39; || T4.to_node, 4\nFROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nJOIN mountain_network T3 ON T2.to_node = T3.from_node\nJOIN mountain_network T4 ON T3.to_node = T4.from_node\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39; AND T4.to_node = \u0026#39;Maverick\u0026#39;\n\nUNION ALL\n\nSELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node || \u0026#39; -\u0026gt; \u0026#39; || T3.to_node || \u0026#39; -\u0026gt; \u0026#39; || T4.to_node || \u0026#39; -\u0026gt; \u0026#39; || T5.to_node, 5\nFROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nJOIN mountain_network T3 ON T2.to_node = T3.from_node\nJOIN mountain_network T4 ON T3.to_node = T4.from_node\nJOIN mountain_network T5 ON T4.to_node = T5.from_node\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39; AND T5.to_node = \u0026#39;Maverick\u0026#39;\n\nUNION ALL\n\nSELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node || \u0026#39; -\u0026gt; \u0026#39; || T3.to_node || \u0026#39; -\u0026gt; \u0026#39; || T4.to_node || \u0026#39; -\u0026gt; \u0026#39; || T5.to_node || \u0026#39; -\u0026gt; \u0026#39; || T6.to_node, 6\nFROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nJOIN mountain_network T3 ON T2.to_node = T3.from_node\nJOIN mountain_network T4 ON T3.to_node = T4.from_node\nJOIN mountain_network T5 ON T4.to_node = T5.from_node\nJOIN mountain_network T6 ON T5.to_node = T6.from_node\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39; AND T6.to_node = \u0026#39;Maverick\u0026#39;\n\n\nUNION ALL\n\nSELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node || \u0026#39; -\u0026gt; \u0026#39; || T3.to_node || \u0026#39; -\u0026gt; \u0026#39; || T4.to_node || \u0026#39; -\u0026gt; \u0026#39; || T5.to_node || \u0026#39; -\u0026gt; \u0026#39; || T6.to_node || \u0026#39; -\u0026gt; \u0026#39; || T7.to_node, 7\nFROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nJOIN mountain_network T3 ON T2.to_node = T3.from_node\nJOIN mountain_network T4 ON T3.to_node = T4.from_node\nJOIN mountain_network T5 ON T4.to_node = T5.from_node\nJOIN mountain_network T6 ON T5.to_node = T6.from_node\nJOIN mountain_network T7 ON T6.to_node = T7.from_node\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39; AND T7.to_node = \u0026#39;Maverick\u0026#39;\n\nUNION ALL\n\nSELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node || \u0026#39; -\u0026gt; \u0026#39; || T3.to_node || \u0026#39; -\u0026gt; \u0026#39; || T4.to_node || \u0026#39; -\u0026gt; \u0026#39; || T5.to_node || \u0026#39; -\u0026gt; \u0026#39; || T6.to_node || \u0026#39; -\u0026gt; \u0026#39; || T7.to_node || \u0026#39; -\u0026gt; \u0026#39; || T8.to_node, 8\nFROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nJOIN mountain_network T3 ON T2.to_node = T3.from_node\nJOIN mountain_network T4 ON T3.to_node = T4.from_node\nJOIN mountain_network T5 ON T4.to_node = T5.from_node\nJOIN mountain_network T6 ON T5.to_node = T6.from_node\nJOIN mountain_network T7 ON T6.to_node = T7.from_node\nJOIN mountain_network T8 ON T7.to_node = T8.from_node\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39; AND T8.to_node = \u0026#39;Maverick\u0026#39;\n\nUNION ALL\n\nSELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node || \u0026#39; -\u0026gt; \u0026#39; || T3.to_node || \u0026#39; -\u0026gt; \u0026#39; || T4.to_node || \u0026#39; -\u0026gt; \u0026#39; || T5.to_node || \u0026#39; -\u0026gt; \u0026#39; || T6.to_node || \u0026#39; -\u0026gt; \u0026#39; || T7.to_node || \u0026#39; -\u0026gt; \u0026#39; || T8.to_node || \u0026#39; -\u0026gt; \u0026#39; || T9.to_node, 9\nFROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nJOIN mountain_network T3 ON T2.to_node = T3.from_node\nJOIN mountain_network T4 ON T3.to_node = T4.from_node\nJOIN mountain_network T5 ON T4.to_node = T5.from_node\nJOIN mountain_network T6 ON T5.to_node = T6.from_node\nJOIN mountain_network T7 ON T6.to_node = T7.from_node\nJOIN mountain_network T8 ON T7.to_node = T8.from_node\nJOIN mountain_network T9 ON T8.to_node = T9.from_node\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39; AND T9.to_node = \u0026#39;Maverick\u0026#39;\n\nUNION ALL\n\nSELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node || \u0026#39; -\u0026gt; \u0026#39; || T3.to_node || \u0026#39; -\u0026gt; \u0026#39; || T4.to_node || \u0026#39; -\u0026gt; \u0026#39; || T5.to_node || \u0026#39; -\u0026gt; \u0026#39; || T6.to_node || \u0026#39; -\u0026gt; \u0026#39; || T7.to_node || \u0026#39; -\u0026gt; \u0026#39; || T8.to_node || \u0026#39; -\u0026gt; \u0026#39; || T9.to_node || \u0026#39; -\u0026gt; \u0026#39; || T10.to_node, 10\nFROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nJOIN mountain_network T3 ON T2.to_node = T3.from_node\nJOIN mountain_network T4 ON T3.to_node = T4.from_node\nJOIN mountain_network T5 ON T4.to_node = T5.from_node\nJOIN mountain_network T6 ON T5.to_node = T6.from_node\nJOIN mountain_network T7 ON T6.to_node = T7.from_node\nJOIN mountain_network T8 ON T7.to_node = T8.from_node\nJOIN mountain_network T9 ON T8.to_node = T9.from_node\nJOIN mountain_network T10 ON T9.to_node = T10.from_node\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39; AND T10.to_node = \u0026#39;Maverick\u0026#39;\n\nUNION ALL\n\nSELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node || \u0026#39; -\u0026gt; \u0026#39; || T3.to_node || \u0026#39; -\u0026gt; \u0026#39; || T4.to_node || \u0026#39; -\u0026gt; \u0026#39; || T5.to_node || \u0026#39; -\u0026gt; \u0026#39; || T6.to_node || \u0026#39; -\u0026gt; \u0026#39; || T7.to_node || \u0026#39; -\u0026gt; \u0026#39; || T8.to_node || \u0026#39; -\u0026gt; \u0026#39; || T9.to_node || \u0026#39; -\u0026gt; \u0026#39; || T10.to_node || \u0026#39; -\u0026gt; \u0026#39; || T11.to_node, 11\nFROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nJOIN mountain_network T3 ON T2.to_node = T3.from_node\nJOIN mountain_network T4 ON T3.to_node = T4.from_node\nJOIN mountain_network T5 ON T4.to_node = T5.from_node\nJOIN mountain_network T6 ON T5.to_node = T6.from_node\nJOIN mountain_network T7 ON T6.to_node = T7.from_node\nJOIN mountain_network T8 ON T7.to_node = T8.from_node\nJOIN mountain_network T9 ON T8.to_node = T9.from_node\nJOIN mountain_network T10 ON T9.to_node = T10.from_node\nJOIN mountain_network T11 ON T10.to_node = T11.from_node\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39; AND T11.to_node = \u0026#39;Maverick\u0026#39;\n\nUNION ALL\n\nSELECT T1.from_node || \u0026#39; -\u0026gt; \u0026#39; || T1.to_node || \u0026#39; -\u0026gt; \u0026#39; || T2.to_node || \u0026#39; -\u0026gt; \u0026#39; || T3.to_node || \u0026#39; -\u0026gt; \u0026#39; || T4.to_node || \u0026#39; -\u0026gt; \u0026#39; || T5.to_node || \u0026#39; -\u0026gt; \u0026#39; || T6.to_node || \u0026#39; -\u0026gt; \u0026#39; || T7.to_node || \u0026#39; -\u0026gt; \u0026#39; || T8.to_node || \u0026#39; -\u0026gt; \u0026#39; || T9.to_node || \u0026#39; -\u0026gt; \u0026#39; || T10.to_node || \u0026#39; -\u0026gt; \u0026#39; || T11.to_node || \u0026#39; -\u0026gt; \u0026#39; || T12.to_node, 12\nFROM mountain_network T1\nJOIN mountain_network T2 ON T1.to_node = T2.from_node\nJOIN mountain_network T3 ON T2.to_node = T3.from_node\nJOIN mountain_network T4 ON T3.to_node = T4.from_node\nJOIN mountain_network T5 ON T4.to_node = T5.from_node\nJOIN mountain_network T6 ON T5.to_node = T6.from_node\nJOIN mountain_network T7 ON T6.to_node = T7.from_node\nJOIN mountain_network T8 ON T7.to_node = T8.from_node\nJOIN mountain_network T9 ON T8.to_node = T9.from_node\nJOIN mountain_network T10 ON T9.to_node = T10.from_node\nJOIN mountain_network T11 ON T10.to_node = T11.from_node\nJOIN mountain_network T12 ON T11.to_node = T12.from_node\nWHERE T1.from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39; AND T12.to_node = \u0026#39;Maverick\u0026#39;;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;\u002b--------------------------------------------------------------\u002b-------------\u002b\n|                             path                             | connections |\n\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Jake\u0026#39;s Lift -\u0026gt; Maverick                                      | 1           |\n\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Brightside -\u0026gt; Moonrise -\u0026gt; Dr | 5           |\n| aw -\u0026gt; Maverick                                               |             |\n\u002b--------------------------------------------------------------\u002b-------------\u002b\nsqlite\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Ok, we get the result, but that looks like a terrifying query.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Can we do better?\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;I looked at the tutorial and we have something like \u0026lt;code\u0026gt;RECURSIVE CTE\u0026lt;\/code\u0026gt;\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Wow!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;This is quite challenging to explain.\u0026lt;\/p\u0026gt;\n\u0026lt;h3 id=\u0026#34;recursive-cte\u0026#34;\u0026gt;Recursive CTE\u0026lt;\/h3\u0026gt;\n\u0026lt;p\u0026gt;We can create a recursive CTE that draws the path until we have not found the stop node that is, \u0026lt;code\u0026gt;Maverick\u0026lt;\/code\u0026gt; and the number of connections is not more than \u0026lt;code\u0026gt;12\u0026lt;\/code\u0026gt;.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;So here\u0026#39;s how it goes.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;WITH RECURSIVE ski_paths AS (\n    SELECT\n        from_node,\n        to_node,\n        CAST(from_node || \u0026#39; -\u0026gt; \u0026#39; || to_node AS TEXT) AS full_path,\n        1 AS connections\n    FROM mountain_network\n    WHERE from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39;\n\n    UNION ALL\n\n    SELECT\n        mn.from_node,\n        mn.to_node,\n        sp.full_path || \u0026#39; -\u0026gt; \u0026#39; || mn.to_node,\n        sp.connections \u002b 1\n    FROM ski_paths sp\n    JOIN mountain_network mn ON sp.to_node = mn.from_node\n    WHERE sp.connections \u0026lt; 12\n      AND sp.to_node != \u0026#39;Maverick\u0026#39;\n)\nSELECT full_path, connections\nFROM ski_paths\nWHERE to_node = \u0026#39;Maverick\u0026#39;\nORDER BY connections ASC;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;We first define the base case i.e. what to select first. We get the first row where we start, the \u0026lt;code\u0026gt;Jake\u0026#39;s Lift\u0026lt;\/code\u0026gt; and from there on we create a recursive select statement by referencing the CTE within it.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;The recursive bit is this one\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt; SELECT\n        mn.from_node,\n        mn.to_node,\n        sp.full_path || \u0026#39; -\u0026gt; \u0026#39; || mn.to_node,\n        sp.connections \u002b 1\n    FROM ski_paths sp\n    JOIN mountain_network mn ON sp.to_node = mn.from_node\n    WHERE sp.connections \u0026lt; 12\n      AND sp.to_node != \u0026#39;Maverick\u0026#39;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;We are referencing the CTE (table) within it as the recursive condition to select from the nodes where the end node or the \u0026lt;code\u0026gt;to_node\u0026lt;\/code\u0026gt; is not Maverick and connections haven\u0026#39;t gone beyond \u0026lt;code\u0026gt;12\u0026lt;\/code\u0026gt;, we try to find the path.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;This would give us all the nodes.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026#39;s see first, by checking the CTE as is.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;sql-playground\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;controls\u0026#34;\u0026gt;\u0026lt;button class=\u0026#34;run-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-play\u0026#34;\u0026gt;\u0026lt;polygon points=\u0026#34;5 3 19 12 5 21 5 3\u0026#34;\u0026gt;\u0026lt;\/polygon\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;edit-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-edit\u0026#34;\u0026gt;\u0026lt;path d=\u0026#34;M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;path d=\u0026#34;M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;button class=\u0026#34;reset-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-refresh-cw\u0026#34;\u0026gt;\u0026lt;polyline points=\u0026#34;23 4 23 10 17 10\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;polyline points=\u0026#34;1 20 1 14 7 14\u0026#34;\u0026gt;\u0026lt;\/polyline\u0026gt;\u0026lt;path d=\u0026#34;M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code class=\u0026#34;language-sql\u0026#34;\u0026gt;WITH RECURSIVE ski_paths AS (\n    SELECT\n        from_node,\n        to_node,\n        CAST(from_node || \u0026#39; -\u0026gt; \u0026#39; || to_node AS TEXT) AS full_path,\n        1 AS connections\n    FROM mountain_network\n    WHERE from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39;\n\n    UNION ALL\n\n    SELECT\n        mn.from_node,\n        mn.to_node,\n        sp.full_path || \u0026#39; -\u0026gt; \u0026#39; || mn.to_node,\n        sp.connections \u002b 1\n    FROM ski_paths sp\n    JOIN mountain_network mn ON sp.to_node = mn.from_node\n    WHERE sp.connections \u0026lt; 12\n      AND sp.to_node != \u0026#39;Maverick\u0026#39;\n)\nSELECT * from ski_paths;\n\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; WITH RECURSIVE ski_paths AS (\n    SELECT\n        from_node,\n        to_node,\n        CAST(from_node || \u0026#39; -\u0026gt; \u0026#39; || to_node AS TEXT) AS full_path,\n        1 AS connections\n    FROM mountain_network\n    WHERE from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39;\n\n    UNION ALL\n\n    SELECT\n        mn.from_node,\n        mn.to_node,\n        sp.full_path || \u0026#39; -\u0026gt; \u0026#39; || mn.to_node,\n        sp.connections \u002b 1\n    FROM ski_paths sp\n    JOIN mountain_network mn ON sp.to_node = mn.from_node\n    WHERE sp.connections \u0026lt; 12\n      AND sp.to_node != \u0026#39;Maverick\u0026#39;\n)\nSELECT * from ski_paths;\n\u002b---------------\u002b----------------\u002b--------------------------------------------------------------\u002b-------------\u002b\n|   from_node   |    to_node     |                          full_path                           | connections |\n\u002b---------------\u002b----------------\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Jake\u0026#39;s Lift   | Wildwood Lift  | Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift                                 | 1           |\n\u002b---------------\u002b----------------\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Jake\u0026#39;s Lift   | Maverick       | Jake\u0026#39;s Lift -\u0026gt; Maverick                                      | 1           |\n\u002b---------------\u002b----------------\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Wildwood Lift | Brightside     | Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Brightside                   | 2           |\n\u002b---------------\u002b----------------\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Wildwood Lift | Sidewinder     | Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Sidewinder                   | 2           |\n\u002b---------------\u002b----------------\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Brightside    | Moonrise       | Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Brightside -\u0026gt; Moonrise       | 3           |\n\u002b---------------\u002b----------------\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Moonrise      | Draw           | Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Brightside -\u0026gt; Moonrise -\u0026gt; Dr | 4           |\n|               |                | aw                                                           |             |\n\u002b---------------\u002b----------------\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Moonrise      | Lone Pine      | Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Brightside -\u0026gt; Moonrise -\u0026gt; Lo | 4           |\n|               |                | ne Pine                                                      |             |\n\u002b---------------\u002b----------------\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Draw          | Broadway       | Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Brightside -\u0026gt; Moonrise -\u0026gt; Dr | 5           |\n|               |                | aw -\u0026gt; Broadway                                               |             |\n\u002b---------------\u002b----------------\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Draw          | Maverick       | Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Brightside -\u0026gt; Moonrise -\u0026gt; Dr | 5           |\n|               |                | aw -\u0026gt; Maverick                                               |             |\n\u002b---------------\u002b----------------\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Broadway      | Outlaw Trail   | Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Brightside -\u0026gt; Moonrise -\u0026gt; Dr | 6           |\n|               |                | aw -\u0026gt; Broadway -\u0026gt; Outlaw Trail                               |             |\n\u002b---------------\u002b----------------\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Outlaw Trail  | Center Aisle   | Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Brightside -\u0026gt; Moonrise -\u0026gt; Dr | 7           |\n|               |                | aw -\u0026gt; Broadway -\u0026gt; Outlaw Trail -\u0026gt; Center Aisle               |             |\n\u002b---------------\u002b----------------\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Center Aisle  | Bandit         | Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Brightside -\u0026gt; Moonrise -\u0026gt; Dr | 8           |\n|               |                | aw -\u0026gt; Broadway -\u0026gt; Outlaw Trail -\u0026gt; Center Aisle -\u0026gt; Bandit     |             |\n\u002b---------------\u002b----------------\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Center Aisle  | Lower Stampede | Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Brightside -\u0026gt; Moonrise -\u0026gt; Dr | 8           |\n|               |                | aw -\u0026gt; Broadway -\u0026gt; Outlaw Trail -\u0026gt; Center Aisle -\u0026gt; Lower Stam |             |\n|               |                | pede                                                         |             |\n\u002b---------------\u002b----------------\u002b--------------------------------------------------------------\u002b-------------\u002b\nsqlite\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;You can see we have got quite a lot of paths, this are all the paths that start from \u0026lt;code\u0026gt;Jake\u0026#39;s Lift\u0026lt;\/code\u0026gt; and have less than \u0026lt;code\u0026gt;12\u0026lt;\/code\u0026gt; connections.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;So, now we can simply filter with the \u0026lt;code\u0026gt;WHERE\u0026lt;\/code\u0026gt; clause in the case where the \u0026lt;code\u0026gt;to_node = \u0026#39;Maverick\u0026#39;\u0026lt;\/code\u0026gt; and we would get the result.\u0026lt;\/p\u0026gt;\n\u0026lt;div class=\u0026#34;code-block\u0026#34;\u0026gt;\u0026lt;div class=\u0026#34;code-header\u0026#34;\u0026gt;\u0026lt;span class=\u0026#34;language-name\u0026#34;\u0026gt;\u0026lt;\/span\u0026gt;\u0026lt;button class=\u0026#34;copy-button\u0026#34;\u0026gt;\u0026lt;svg xmlns=\u0026#34;http:\/\/www.w3.org\/2000\/svg\u0026#34; width=\u0026#34;24\u0026#34; height=\u0026#34;24\u0026#34; viewBox=\u0026#34;0 0 24 24\u0026#34; fill=\u0026#34;none\u0026#34; stroke=\u0026#34;currentColor\u0026#34; stroke-width=\u0026#34;2\u0026#34; stroke-linecap=\u0026#34;round\u0026#34; stroke-linejoin=\u0026#34;round\u0026#34; class=\u0026#34;feather feather-copy\u0026#34;\u0026gt;\u0026lt;rect x=\u0026#34;9\u0026#34; y=\u0026#34;9\u0026#34; width=\u0026#34;13\u0026#34; height=\u0026#34;13\u0026#34; rx=\u0026#34;2\u0026#34; ry=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;\/rect\u0026gt;\u0026lt;path d=\u0026#34;M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\u0026#34;\u0026gt;\u0026lt;\/path\u0026gt;\u0026lt;\/svg\u0026gt;\u0026lt;\/button\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;sqlite\u0026gt; WITH RECURSIVE ski_paths AS (\n    SELECT\n        from_node,\n        to_node,\n        CAST(from_node || \u0026#39; -\u0026gt; \u0026#39; || to_node AS TEXT) AS full_path,\n        1 AS connections\n    FROM mountain_network\n    WHERE from_node = \u0026#39;Jake\u0026#39;\u0026#39;s Lift\u0026#39;\n\n    UNION ALL\n\n    SELECT\n        mn.from_node,\n        mn.to_node,\n        sp.full_path || \u0026#39; -\u0026gt; \u0026#39; || mn.to_node,\n        sp.connections \u002b 1\n    FROM ski_paths sp\n    JOIN mountain_network mn ON sp.to_node = mn.from_node\n    WHERE sp.connections \u0026lt; 12\n      AND sp.to_node != \u0026#39;Maverick\u0026#39;\n)\nSELECT full_path, connections\nFROM ski_paths\nWHERE to_node = \u0026#39;Maverick\u0026#39;\nORDER BY connections ASC;\n\u002b--------------------------------------------------------------\u002b-------------\u002b\n|                          full_path                           | connections |\n\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Jake\u0026#39;s Lift -\u0026gt; Maverick                                      | 1           |\n\u002b--------------------------------------------------------------\u002b-------------\u002b\n| Jake\u0026#39;s Lift -\u0026gt; Wildwood Lift -\u0026gt; Brightside -\u0026gt; Moonrise -\u0026gt; Dr | 5           |\n| aw -\u0026gt; Maverick                                               |             |\n\u002b--------------------------------------------------------------\u002b-------------\u002b\nsqlite\u0026gt;\n\u0026lt;\/code\u0026gt;\u0026lt;\/pre\u0026gt;\u0026lt;\/div\u0026gt;\u0026lt;p\u0026gt;Ok, that gave the result correctly.\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;And this is it!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Sweet problem to learn about Recursive CTE!\u0026lt;\/p\u0026gt;\n\u0026lt;p\u0026gt;Off to the final day of advent of SQL 2025!\u0026lt;\/p\u0026gt;\n"
    }
    </script>
    
    
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/code-block.css">
    <link rel="stylesheet" href="/post-navigation.css">
    
    <link rel="icon" href="/tbicon.png" type="image/png">
    <link rel="apple-touch-icon" href="/tbicon.png">
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link id="syntax-theme" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.13.0/sql-wasm.js"></script>
    <link rel="stylesheet" href="/sql-playground.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/monokai.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/sql/sql.min.js"></script>
    <script src="/sql-playground.js"></script>
    
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script>
    document.addEventListener("DOMContentLoaded", () => {
        const body = document.body;
        const stylesheet = document.getElementById("syntax-theme");
        const themeToggle = document.getElementById('theme-toggle');

        function setSyntaxTheme(theme) {
            if (theme === "secondary") {
                stylesheet.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css";
            } else {
                stylesheet.href = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css";
            }
        }

        
        document.querySelectorAll("pre code").forEach((block) => {
            hljs.highlightElement(block);
        });

        
        const currentTheme = localStorage.getItem("theme") || "default";
        if (currentTheme === "secondary") {
            body.classList.add("secondary-theme");
            if (themeToggle) themeToggle.checked = true;
        }
        setSyntaxTheme(currentTheme);

        
        if (themeToggle) {
            themeToggle.addEventListener('change', () => {
                const newTheme = themeToggle.checked ? 'secondary' : 'default';
                if (themeToggle.checked) {
                    body.classList.add('secondary-theme');
                } else {
                    body.classList.remove('secondary-theme');
                }
                localStorage.setItem('theme', newTheme);
                setSyntaxTheme(newTheme);
            });
        }
        
        
        const editBtn = document.getElementById('editor-edit');
        if (editBtn) {
            editBtn.addEventListener('click', async function () {
                const slug = "sqlog\/advent-of-sql-2025-day-14";
                const type = "sqlog";
                console.log("Editing post:", slug, type);
                const url = "https:\/\/devmeetgor.netlify.app/.netlify/functions/api?slug=" + slug + "&method=edit&type=" + type;
                
                try {
                    const res = await fetch(url);
                    if (!res.ok) throw new Error("Failed to fetch edit content");
                    const html = await res.text();
                    document.querySelector('.post-content').innerHTML = html;
                } catch (err) {
                    console.error(err);
                    alert("Error loading editor content");
                }
            });
        }
    });
    </script>
    
    
    <script src="/seasonal-effects.js" defer></script>
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EET2ZX4QY1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-EET2ZX4QY1');
    </script>
</head>
<body>
    <header class="header">
  <a class="site-title" href="/" aria-label="Meet Gor - Home">Meet Gor</a>
  <nav>
    <ul>
      <li><a href="/" aria-label="Home">Home</a></li>
      <li><a href="/posts" aria-label="Posts">Posts</a></li>
      <li><a href="/all-content" aria-label="All Content">All Content</a></li>
      <li><a href="/about" aria-label="About">About</a></li>
      <li><a href="/contact" aria-label="Contact">Contact</a></li>
    </ul>
  </nav>
  <div class="theme-switch">
    <input type="checkbox" id="theme-toggle" aria-label="Toggle Theme">
    <label for="theme-toggle"></label>
  </div>
  
    <button id="editor" onclick="location.href='/editor'" aria-label="Editor">
      Editor
    </button>
  
</header>
    
    <main class="container">
        <article class="blog-post">
            <h1>Advent of SQL 2025 Day 14: Ski Resort Paths</h1>
            
            <div class="post-meta">
                Published on  <time datetime="2025-12-28 15:30 &#43;0530">2025-12-28 15:30 &#43;0530</time>
            </div>
            
            <div class="post-meta">
                Type: <a href="/sqlog">sqlog</a>
            </div>
            
            <div class="post-meta tags">
                <span class="post-series-label"> Tags:</span>
                
                <a href="/tags/sqlite">#sqlite</a>
                
                <a href="/tags/sql">#sql</a>
                
                <a href="/tags/advent-of-sql">#advent-of-sql</a>
                
            </div>
            
            
            <div class="post-series">
                <span class="series-label">Part of the
                <span class="series-list">
                    
                    <a href="/series/advent-of-sql-2025" class="series-link"> advent-of-sql-2025</a>
                    
                </span></span>
                <span class="series-label">series</span>
            </div>
            
            
            
            <div class="post-meta admin-controls">
                <button id="editor-edit">Edit</button>
                <button id="editor-delete" 
                        onclick="location.href='/editor/?slug=sqlog\/advent-of-sql-2025-day-14&method=delete'">
                    Delete
                </button>
            </div>
            
            
            <hr>
            
            <div class="post-content">
                <h2 id="advent-of-sql-day-14---ski-resort-paths">Advent of SQL, Day 14 - Ski Resort Paths</h2>
<p>Ok, almost to the penultimate day in the series. It is day 14 of Advent of SQL.</p>
<p>Let's grab the SQL for the day.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">DROP TABLE IF EXISTS mountain_network;


CREATE TABLE mountain_network (
    id INTEGER PRIMARY KEY,
    from_node TEXT,
    to_node TEXT,
    node_type TEXT,    -- 'Lift' or 'Trail'
    difficulty TEXT    -- Only applicable for trails: 'green', 'blue', 'black', 'double_black'
);

INSERT INTO mountain_network (id, from_node, to_node, node_type, difficulty) VALUES
(1, 'Outlaw Express', 'Stairway Lift', 'Lift', NULL),
(2, 'Outlaw Express', 'Top Gun Bowl', 'Trail', 'black'),
(3, 'Top Gun Bowl', 'Top Gun', 'Trail', 'black'),
(4, 'Top Gun', 'Montoya', 'Trail', 'blue'),
(5, 'Montoya', 'Center Aisle', 'Trail', 'green'),
(6, 'Center Aisle', 'Lower Stampede', 'Trail', 'green'),
(7, 'Stairway Lift', 'Red''s Lift', 'Lift', NULL),
(8, 'Stairway Lift', 'Broadway', 'Trail', 'green'),
(9, 'Red''s Lift', 'Bearclaw', 'Trail', 'blue'),
(10, 'Bearclaw', 'Last Chance', 'Trail', 'blue'),
(11, 'Last Chance', 'Diamondback', 'Trail', 'blue'),
(12, 'Diamondback', 'Broadway', 'Trail', 'green'),
(13, 'Red''s Lift', 'Bishop''s Bowl', 'Trail', 'black'),
(14, 'Red''s Lift', 'Amy''s Ridge', 'Trail', 'blue'),
(15, 'Amy''s Ridge', 'Grizzly Bowl', 'Trail', 'black'),
(16, 'Flathead Lift', 'Amy''s Ridge', 'Trail', 'blue'),
(17, 'Jake''s Lift', 'Wildwood Lift', 'Lift', NULL),
(18, 'Wildwood Lift', 'Sidewinder', 'Trail', 'green'),
(19, 'Wildwood Lift', 'Brightside', 'Trail', 'blue'),
(20, 'Brightside', 'Moonrise', 'Trail', 'green'),
(21, 'Moonrise', 'Draw', 'Trail', 'green'),
(22, 'Moonrise', 'Lone Pine', 'Trail', 'blue'),
(23, 'Draw', 'Maverick', 'Trail', 'blue'),
(24, 'Draw', 'Broadway', 'Trail', 'green'),
(25, 'Broadway', 'Outlaw Trail', 'Trail', 'green'),
(26, 'Outlaw Trail', 'Center Aisle', 'Trail', 'green'),
(27, 'Center Aisle', 'Bandit', 'Trail', 'green'),
(28, 'Jake''s Lift', 'Maverick', 'Trail', 'blue');

</code></pre><div class="output"></div></div><p>That's it, we just have 1 table called <code>mountain_network</code> and it has <code>28</code> records.</p>
<p>Let's look at the problem statement to check what we need to do to make sense of those 28 rows.</p>
<h2 id="problem">Problem</h2>
<blockquote>
<p>Find all the possible routes from Jake's Lift to Maverick. None of the possible routes will take more than 12 connections.</p>
</blockquote>
<p>Oh! This is a graph like or network like problem.</p>
<p>Ouch!</p>
<p>Relational databases looks like they would be a good fit for these stuff, but if the data is just in the single table, there's not really much help.</p>
<p>Let's see how we can think about it.</p>
<h3 id="joins-and-unions">JOINs and UNIONS</h3>
<p>We need to find all the routes from a start node(record) i.e. <code>Jake's Lift</code> and find all ways that lead to the node(record) i.e. <code>Maverick</code>. The table gives a list of edges i.e. from which node to which node there is a way or a trail or lift.</p>
<p>So, we can do a simple select to check if the <code>from_node</code> has <code>Jake's Lift</code> and the <code>to_node</code> has <code>Maverick</code> right?</p>
<p>But that would make it too long.</p>
<p>Like we would have to look for 12 consecutive edges and branch off at each direction.</p>
<p>For the first level it would look simple like this:</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT 
    mountain_network.from_node || ' -> ' || mountain_network.to_node AS path, 
    1 AS connections
FROM mountain_network
WHERE 
    mountain_network.from_node = 'Jake''s Lift'
    AND mountain_network.to_node = 'Maverick';
</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> SELECT mountain_network.from_node || ' -> ' || mountain_network.to_node AS path, 1 AS connections
FROM mountain_network
WHERE mountain_network.from_node = 'Jake''s Lift' AND mountain_network.to_node = 'Maverick'
   ...> ;
+-------------------------+-------------+
|          path           | connections |
+-------------------------+-------------+
| Jake's Lift -> Maverick | 1           |
+-------------------------+-------------+
sqlite>
</code></pre></div><p>Luckily, we have one route directly from <code>Jake's Lift</code> to <code>Maverick</code>. But that might not be for all levels. Like we need to check then, from each of the start nodes that begin at <code>Jake's Lift</code>, then for all the nodes that begin at that then it branches of further till we have a dead end only at <code>Maverick</code>.</p>
<p>Phew that's going to be a long one.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node, 2                     FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
WHERE 
    T1.from_node = 'Jake''s Lift'
    AND T2.to_node = 'Maverick';
</code></pre><div class="output"></div></div><p>That is the first branch off from <code>Jake's Lift</code>. If we remove the <code>T2.to_node = 'Maverick'</code> you would see all nodes from the <code>Jake's Lift</code>, not necessarily ending at <code>Maverick</code></p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node as path,
 2 as connections
FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
WHERE T1.from_node = 'Jake''s Lift';
</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> SELECT T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node as path,
 2 as connections
FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
WHERE T1.from_node = 'Jake''s Lift';
+--------------------------------------------+-------------+
|                    path                    | connections |
+--------------------------------------------+-------------+
| Jake's Lift -> Wildwood Lift -> Brightside | 2           |
| Jake's Lift -> Wildwood Lift -> Sidewinder | 2           |
+--------------------------------------------+-------------+
sqlite>
</code></pre></div><p>Similarly we can do it for 3 and 4, and till 12 connections.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT 
    T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node || ' -> ' || T3.to_node as path,
    3 as connections
FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
JOIN mountain_network T3 ON T2.to_node = T3.from_node
WHERE T1.from_node = 'Jake''s Lift';
</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> SELECT T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node || ' -> ' || T3.to_node as path, 3 as connections
FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
JOIN mountain_network T3 ON T2.to_node = T3.from_node
WHERE T1.from_node = 'Jake''s Lift'
   ...> ;
+--------------------------------------------------------+-------------+
|                          path                          | connections |
+--------------------------------------------------------+-------------+
| Jake's Lift -> Wildwood Lift -> Brightside -> Moonrise | 3           |
+--------------------------------------------------------+-------------+
sqlite>
</code></pre></div><p>Yikes.</p>
<p>That gives a long long query. I cannot write.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">SELECT T1.from_node || ' -> ' || T1.to_node AS path, 1 AS connections
FROM mountain_network T1
WHERE T1.from_node = 'Jake''s Lift' AND T1.to_node = 'Maverick'

UNION ALL

SELECT T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node, 2
FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
WHERE T1.from_node = 'Jake''s Lift' AND T2.to_node = 'Maverick'

UNION ALL

SELECT T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node || ' -> ' || T3.to_node, 3
FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
JOIN mountain_network T3 ON T2.to_node = T3.from_node
WHERE T1.from_node = 'Jake''s Lift' AND T3.to_node = 'Maverick'

UNION ALL

SELECT T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node || ' -> ' || T3.to_node || ' -> ' || T4.to_node, 4
FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
JOIN mountain_network T3 ON T2.to_node = T3.from_node
JOIN mountain_network T4 ON T3.to_node = T4.from_node
WHERE T1.from_node = 'Jake''s Lift' AND T4.to_node = 'Maverick'

UNION ALL

SELECT T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node || ' -> ' || T3.to_node || ' -> ' || T4.to_node || ' -> ' || T5.to_node, 5
FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
JOIN mountain_network T3 ON T2.to_node = T3.from_node
JOIN mountain_network T4 ON T3.to_node = T4.from_node
JOIN mountain_network T5 ON T4.to_node = T5.from_node
WHERE T1.from_node = 'Jake''s Lift' AND T5.to_node = 'Maverick'

UNION ALL

SELECT T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node || ' -> ' || T3.to_node || ' -> ' || T4.to_node || ' -> ' || T5.to_node || ' -> ' || T6.to_node, 6
FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
JOIN mountain_network T3 ON T2.to_node = T3.from_node
JOIN mountain_network T4 ON T3.to_node = T4.from_node
JOIN mountain_network T5 ON T4.to_node = T5.from_node
JOIN mountain_network T6 ON T5.to_node = T6.from_node
WHERE T1.from_node = 'Jake''s Lift' AND T6.to_node = 'Maverick'


UNION ALL

SELECT T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node || ' -> ' || T3.to_node || ' -> ' || T4.to_node || ' -> ' || T5.to_node || ' -> ' || T6.to_node || ' -> ' || T7.to_node, 7
FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
JOIN mountain_network T3 ON T2.to_node = T3.from_node
JOIN mountain_network T4 ON T3.to_node = T4.from_node
JOIN mountain_network T5 ON T4.to_node = T5.from_node
JOIN mountain_network T6 ON T5.to_node = T6.from_node
JOIN mountain_network T7 ON T6.to_node = T7.from_node
WHERE T1.from_node = 'Jake''s Lift' AND T7.to_node = 'Maverick'

UNION ALL

SELECT T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node || ' -> ' || T3.to_node || ' -> ' || T4.to_node || ' -> ' || T5.to_node || ' -> ' || T6.to_node || ' -> ' || T7.to_node || ' -> ' || T8.to_node, 8
FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
JOIN mountain_network T3 ON T2.to_node = T3.from_node
JOIN mountain_network T4 ON T3.to_node = T4.from_node
JOIN mountain_network T5 ON T4.to_node = T5.from_node
JOIN mountain_network T6 ON T5.to_node = T6.from_node
JOIN mountain_network T7 ON T6.to_node = T7.from_node
JOIN mountain_network T8 ON T7.to_node = T8.from_node
WHERE T1.from_node = 'Jake''s Lift' AND T8.to_node = 'Maverick'

UNION ALL

SELECT T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node || ' -> ' || T3.to_node || ' -> ' || T4.to_node || ' -> ' || T5.to_node || ' -> ' || T6.to_node || ' -> ' || T7.to_node || ' -> ' || T8.to_node || ' -> ' || T9.to_node, 9
FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
JOIN mountain_network T3 ON T2.to_node = T3.from_node
JOIN mountain_network T4 ON T3.to_node = T4.from_node
JOIN mountain_network T5 ON T4.to_node = T5.from_node
JOIN mountain_network T6 ON T5.to_node = T6.from_node
JOIN mountain_network T7 ON T6.to_node = T7.from_node
JOIN mountain_network T8 ON T7.to_node = T8.from_node
JOIN mountain_network T9 ON T8.to_node = T9.from_node
WHERE T1.from_node = 'Jake''s Lift' AND T9.to_node = 'Maverick'

UNION ALL

SELECT T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node || ' -> ' || T3.to_node || ' -> ' || T4.to_node || ' -> ' || T5.to_node || ' -> ' || T6.to_node || ' -> ' || T7.to_node || ' -> ' || T8.to_node || ' -> ' || T9.to_node || ' -> ' || T10.to_node, 10
FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
JOIN mountain_network T3 ON T2.to_node = T3.from_node
JOIN mountain_network T4 ON T3.to_node = T4.from_node
JOIN mountain_network T5 ON T4.to_node = T5.from_node
JOIN mountain_network T6 ON T5.to_node = T6.from_node
JOIN mountain_network T7 ON T6.to_node = T7.from_node
JOIN mountain_network T8 ON T7.to_node = T8.from_node
JOIN mountain_network T9 ON T8.to_node = T9.from_node
JOIN mountain_network T10 ON T9.to_node = T10.from_node
WHERE T1.from_node = 'Jake''s Lift' AND T10.to_node = 'Maverick'

UNION ALL

SELECT T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node || ' -> ' || T3.to_node || ' -> ' || T4.to_node || ' -> ' || T5.to_node || ' -> ' || T6.to_node || ' -> ' || T7.to_node || ' -> ' || T8.to_node || ' -> ' || T9.to_node || ' -> ' || T10.to_node || ' -> ' || T11.to_node, 11
FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
JOIN mountain_network T3 ON T2.to_node = T3.from_node
JOIN mountain_network T4 ON T3.to_node = T4.from_node
JOIN mountain_network T5 ON T4.to_node = T5.from_node
JOIN mountain_network T6 ON T5.to_node = T6.from_node
JOIN mountain_network T7 ON T6.to_node = T7.from_node
JOIN mountain_network T8 ON T7.to_node = T8.from_node
JOIN mountain_network T9 ON T8.to_node = T9.from_node
JOIN mountain_network T10 ON T9.to_node = T10.from_node
JOIN mountain_network T11 ON T10.to_node = T11.from_node
WHERE T1.from_node = 'Jake''s Lift' AND T11.to_node = 'Maverick'

UNION ALL

SELECT T1.from_node || ' -> ' || T1.to_node || ' -> ' || T2.to_node || ' -> ' || T3.to_node || ' -> ' || T4.to_node || ' -> ' || T5.to_node || ' -> ' || T6.to_node || ' -> ' || T7.to_node || ' -> ' || T8.to_node || ' -> ' || T9.to_node || ' -> ' || T10.to_node || ' -> ' || T11.to_node || ' -> ' || T12.to_node, 12
FROM mountain_network T1
JOIN mountain_network T2 ON T1.to_node = T2.from_node
JOIN mountain_network T3 ON T2.to_node = T3.from_node
JOIN mountain_network T4 ON T3.to_node = T4.from_node
JOIN mountain_network T5 ON T4.to_node = T5.from_node
JOIN mountain_network T6 ON T5.to_node = T6.from_node
JOIN mountain_network T7 ON T6.to_node = T7.from_node
JOIN mountain_network T8 ON T7.to_node = T8.from_node
JOIN mountain_network T9 ON T8.to_node = T9.from_node
JOIN mountain_network T10 ON T9.to_node = T10.from_node
JOIN mountain_network T11 ON T10.to_node = T11.from_node
JOIN mountain_network T12 ON T11.to_node = T12.from_node
WHERE T1.from_node = 'Jake''s Lift' AND T12.to_node = 'Maverick';
</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>+--------------------------------------------------------------+-------------+
|                             path                             | connections |
+--------------------------------------------------------------+-------------+
| Jake's Lift -> Maverick                                      | 1           |
+--------------------------------------------------------------+-------------+
| Jake's Lift -> Wildwood Lift -> Brightside -> Moonrise -> Dr | 5           |
| aw -> Maverick                                               |             |
+--------------------------------------------------------------+-------------+
sqlite>
</code></pre></div><p>Ok, we get the result, but that looks like a terrifying query.</p>
<p>Can we do better?</p>
<p>I looked at the tutorial and we have something like <code>RECURSIVE CTE</code></p>
<p>Wow!</p>
<p>This is quite challenging to explain.</p>
<h3 id="recursive-cte">Recursive CTE</h3>
<p>We can create a recursive CTE that draws the path until we have not found the stop node that is, <code>Maverick</code> and the number of connections is not more than <code>12</code>.</p>
<p>So here's how it goes.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">WITH RECURSIVE ski_paths AS (
    SELECT
        from_node,
        to_node,
        CAST(from_node || ' -> ' || to_node AS TEXT) AS full_path,
        1 AS connections
    FROM mountain_network
    WHERE from_node = 'Jake''s Lift'

    UNION ALL

    SELECT
        mn.from_node,
        mn.to_node,
        sp.full_path || ' -> ' || mn.to_node,
        sp.connections + 1
    FROM ski_paths sp
    JOIN mountain_network mn ON sp.to_node = mn.from_node
    WHERE sp.connections < 12
      AND sp.to_node != 'Maverick'
)
SELECT full_path, connections
FROM ski_paths
WHERE to_node = 'Maverick'
ORDER BY connections ASC;
</code></pre><div class="output"></div></div><p>We first define the base case i.e. what to select first. We get the first row where we start, the <code>Jake's Lift</code> and from there on we create a recursive select statement by referencing the CTE within it.</p>
<p>The recursive bit is this one</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql"> SELECT
        mn.from_node,
        mn.to_node,
        sp.full_path || ' -> ' || mn.to_node,
        sp.connections + 1
    FROM ski_paths sp
    JOIN mountain_network mn ON sp.to_node = mn.from_node
    WHERE sp.connections < 12
      AND sp.to_node != 'Maverick'
</code></pre><div class="output"></div></div><p>We are referencing the CTE (table) within it as the recursive condition to select from the nodes where the end node or the <code>to_node</code> is not Maverick and connections haven't gone beyond <code>12</code>, we try to find the path.</p>
<p>This would give us all the nodes.</p>
<p>Let's see first, by checking the CTE as is.</p>
<div class="sql-playground"><div class="controls"><button class="run-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button><button class="edit-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg></button><button class="reset-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-refresh-cw"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64M3.51 15A9 9 0 0 0 18.36 18.36"></path></svg></button></div><pre><code class="language-sql">WITH RECURSIVE ski_paths AS (
    SELECT
        from_node,
        to_node,
        CAST(from_node || ' -> ' || to_node AS TEXT) AS full_path,
        1 AS connections
    FROM mountain_network
    WHERE from_node = 'Jake''s Lift'

    UNION ALL

    SELECT
        mn.from_node,
        mn.to_node,
        sp.full_path || ' -> ' || mn.to_node,
        sp.connections + 1
    FROM ski_paths sp
    JOIN mountain_network mn ON sp.to_node = mn.from_node
    WHERE sp.connections < 12
      AND sp.to_node != 'Maverick'
)
SELECT * from ski_paths;

</code></pre><div class="output"></div></div><div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> WITH RECURSIVE ski_paths AS (
    SELECT
        from_node,
        to_node,
        CAST(from_node || ' -> ' || to_node AS TEXT) AS full_path,
        1 AS connections
    FROM mountain_network
    WHERE from_node = 'Jake''s Lift'

    UNION ALL

    SELECT
        mn.from_node,
        mn.to_node,
        sp.full_path || ' -> ' || mn.to_node,
        sp.connections + 1
    FROM ski_paths sp
    JOIN mountain_network mn ON sp.to_node = mn.from_node
    WHERE sp.connections < 12
      AND sp.to_node != 'Maverick'
)
SELECT * from ski_paths;
+---------------+----------------+--------------------------------------------------------------+-------------+
|   from_node   |    to_node     |                          full_path                           | connections |
+---------------+----------------+--------------------------------------------------------------+-------------+
| Jake's Lift   | Wildwood Lift  | Jake's Lift -> Wildwood Lift                                 | 1           |
+---------------+----------------+--------------------------------------------------------------+-------------+
| Jake's Lift   | Maverick       | Jake's Lift -> Maverick                                      | 1           |
+---------------+----------------+--------------------------------------------------------------+-------------+
| Wildwood Lift | Brightside     | Jake's Lift -> Wildwood Lift -> Brightside                   | 2           |
+---------------+----------------+--------------------------------------------------------------+-------------+
| Wildwood Lift | Sidewinder     | Jake's Lift -> Wildwood Lift -> Sidewinder                   | 2           |
+---------------+----------------+--------------------------------------------------------------+-------------+
| Brightside    | Moonrise       | Jake's Lift -> Wildwood Lift -> Brightside -> Moonrise       | 3           |
+---------------+----------------+--------------------------------------------------------------+-------------+
| Moonrise      | Draw           | Jake's Lift -> Wildwood Lift -> Brightside -> Moonrise -> Dr | 4           |
|               |                | aw                                                           |             |
+---------------+----------------+--------------------------------------------------------------+-------------+
| Moonrise      | Lone Pine      | Jake's Lift -> Wildwood Lift -> Brightside -> Moonrise -> Lo | 4           |
|               |                | ne Pine                                                      |             |
+---------------+----------------+--------------------------------------------------------------+-------------+
| Draw          | Broadway       | Jake's Lift -> Wildwood Lift -> Brightside -> Moonrise -> Dr | 5           |
|               |                | aw -> Broadway                                               |             |
+---------------+----------------+--------------------------------------------------------------+-------------+
| Draw          | Maverick       | Jake's Lift -> Wildwood Lift -> Brightside -> Moonrise -> Dr | 5           |
|               |                | aw -> Maverick                                               |             |
+---------------+----------------+--------------------------------------------------------------+-------------+
| Broadway      | Outlaw Trail   | Jake's Lift -> Wildwood Lift -> Brightside -> Moonrise -> Dr | 6           |
|               |                | aw -> Broadway -> Outlaw Trail                               |             |
+---------------+----------------+--------------------------------------------------------------+-------------+
| Outlaw Trail  | Center Aisle   | Jake's Lift -> Wildwood Lift -> Brightside -> Moonrise -> Dr | 7           |
|               |                | aw -> Broadway -> Outlaw Trail -> Center Aisle               |             |
+---------------+----------------+--------------------------------------------------------------+-------------+
| Center Aisle  | Bandit         | Jake's Lift -> Wildwood Lift -> Brightside -> Moonrise -> Dr | 8           |
|               |                | aw -> Broadway -> Outlaw Trail -> Center Aisle -> Bandit     |             |
+---------------+----------------+--------------------------------------------------------------+-------------+
| Center Aisle  | Lower Stampede | Jake's Lift -> Wildwood Lift -> Brightside -> Moonrise -> Dr | 8           |
|               |                | aw -> Broadway -> Outlaw Trail -> Center Aisle -> Lower Stam |             |
|               |                | pede                                                         |             |
+---------------+----------------+--------------------------------------------------------------+-------------+
sqlite>
</code></pre></div><p>You can see we have got quite a lot of paths, this are all the paths that start from <code>Jake's Lift</code> and have less than <code>12</code> connections.</p>
<p>So, now we can simply filter with the <code>WHERE</code> clause in the case where the <code>to_node = 'Maverick'</code> and we would get the result.</p>
<div class="code-block"><div class="code-header"><span class="language-name"></span><button class="copy-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></button></div><pre><code>sqlite> WITH RECURSIVE ski_paths AS (
    SELECT
        from_node,
        to_node,
        CAST(from_node || ' -> ' || to_node AS TEXT) AS full_path,
        1 AS connections
    FROM mountain_network
    WHERE from_node = 'Jake''s Lift'

    UNION ALL

    SELECT
        mn.from_node,
        mn.to_node,
        sp.full_path || ' -> ' || mn.to_node,
        sp.connections + 1
    FROM ski_paths sp
    JOIN mountain_network mn ON sp.to_node = mn.from_node
    WHERE sp.connections < 12
      AND sp.to_node != 'Maverick'
)
SELECT full_path, connections
FROM ski_paths
WHERE to_node = 'Maverick'
ORDER BY connections ASC;
+--------------------------------------------------------------+-------------+
|                          full_path                           | connections |
+--------------------------------------------------------------+-------------+
| Jake's Lift -> Maverick                                      | 1           |
+--------------------------------------------------------------+-------------+
| Jake's Lift -> Wildwood Lift -> Brightside -> Moonrise -> Dr | 5           |
| aw -> Maverick                                               |             |
+--------------------------------------------------------------+-------------+
sqlite>
</code></pre></div><p>Ok, that gave the result correctly.</p>
<p>And this is it!</p>
<p>Sweet problem to learn about Recursive CTE!</p>
<p>Off to the final day of advent of SQL 2025!</p>

            </div>
        </article>
        
        
        

<nav class="post-navigation" aria-label="Post Navigation">
    <div class="nav-container">
        
        
        <a href="/sqlog/advent-of-sql-2025-day-13" class="nav-link nav-prev" title="Previous Post">
            <span class="nav-arrow"></span>
            <span class="nav-label">Previous</span>
            <span class="nav-title">Advent of SQL 2025 Day 13: XML Travel Manifests</span>
        </a>
        

        
        
        <a href="/sqlog/advent-of-sql-2025-day-15" class="nav-link nav-next" title="Next Post">
            <span class="nav-label">Next</span>
            <span class="nav-title">Advent of SQL 2025 Day 15: Confirmation Phrase Dispatches</span>
            <span class="nav-arrow"></span>
        </a>
        
    </div>
</nav>


        
        
        


<aside class="related-reading" aria-labelledby="related-reading-title">
    <h3 id="related-reading-title" class="related-title"> Related Reading</h3>
    <ul class="related-list">
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-15" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 15: Confirmation Phrase Dispatches</span>
                <span class="related-post-date">2025-12-28 20:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-13" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 13: XML Travel Manifests</span>
                <span class="related-post-date">2025-12-27 20:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-12" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 12: Archive Flight Records</span>
                <span class="related-post-date">2025-12-27 15:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-11" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 11: Behavior Score</span>
                <span class="related-post-date">2025-12-26 15:30 &#43;0530</span>
            </a>
        </li>
        
        
        
        <li class="related-item">
            <a href="/sqlog/advent-of-sql-2025-day-10" class="related-link">
                <span class="related-post-title">Advent of SQL 2025 Day 10: Misdelivered Presents</span>
                <span class="related-post-date">2025-12-25 15:30 &#43;0530</span>
            </a>
        </li>
        
        
    </ul>
</aside>


    </main>
    
    <div id="comments">
        <script src="https://giscus.app/client.js"
            data-repo="Mr-Destructive/meetgor.com"
            data-repo-id="R_kgDOHZ6V_g"
            data-category="Q&A"
            data-category-id="DIC_kwDOHZ6V_s4CRfn4"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="bottom"
            data-theme="dark_high_contrast"
            data-lang="en"
            crossorigin="anonymous"
            async>
        </script>
    </div>
    
    <footer class="site-footer" role="contentinfo">
  <div class="footer-content">
    <p>&copy; Meet Gor. All rights reserved.</p>
    <div class="social-links">
      <a href="/contact" aria-label="Connect with me">Connect with me</a>
    </div>
  </div>
</footer>
    
</body>
</html>
